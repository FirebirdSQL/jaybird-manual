<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="keywords" content="jaybird, firebird, jdbc, sql, database, java">
<meta name="author" content="Roman Rokytskyy, Mark Rotteveel">
<title>Jaybird JDBC Driver Java Programmer&#8217;s Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
em.since{font-size:smaller;}
em.since::before{content:"Since: ";font-weight:bold;}
em.until{font-size:smaller;}
em.until::before{content:"Removed in: ";font-weight:bold;}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Jaybird JDBC Driver Java Programmer&#8217;s Manual</h1>
<div class="details">
<span id="author" class="author">Roman Rokytskyy</span><br>
<span id="author2" class="author">Mark Rotteveel</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_this_manual">1.1. This manual</a></li>
<li><a href="#_history">1.2. History</a></li>
<li><a href="#_jaybird_architecture">1.3. Jaybird Architecture</a></li>
<li><a href="#distribution">1.4. Jaybird Distribution</a></li>
<li><a href="#_quality_assurance">1.5. Quality Assurance</a></li>
<li><a href="#_useful_resources">1.6. Useful resources</a></li>
<li><a href="#_contributing">1.7. Contributing</a></li>
</ul>
</li>
<li><a href="#user-manual">User Manual</a>
<ul class="sectlevel1">
<li><a href="#connection">2. Obtaining a connection</a>
<ul class="sectlevel2">
<li><a href="#connection-drivermanager">2.1. Obtaining connection java.sql.DriverManager</a></li>
<li><a href="#driver-types">2.2. Driver types</a></li>
<li><a href="#connection-pooling">2.3. Connection Pooling</a></li>
<li><a href="#data-source-implementation">2.4. The javax.sql.DataSource implementation</a></li>
<li><a href="#connection-pool-data-source-implementation">2.5. The javax.sql.ConnectionPoolDataSource implementation</a></li>
<li><a href="#xa-data-source-implementation">2.6. The javax.sql.XADataSource implementation</a></li>
</ul>
</li>
<li><a href="#exceptionhandling">3. Handling exceptions</a>
<ul class="sectlevel2">
<li><a href="#_working_with_exceptions">3.1. Working with exceptions</a></li>
<li><a href="#_warnings">3.2. Warnings</a></li>
<li><a href="#_java_sql_sqlexception_in_jaybird">3.3. java.sql.SQLException in Jaybird</a></li>
<li><a href="#_sql_states">3.4. SQL states</a></li>
<li><a href="#_useful_firebird_error_codes">3.5. Useful Firebird error codes</a></li>
</ul>
</li>
<li><a href="#statements">4. Executing statements</a>
<ul class="sectlevel2">
<li><a href="#_the_java_sql_statement_interface">4.1. The java.sql.Statement interface</a></li>
<li><a href="#_statement_behind_the_scenes">4.2. Statement behind the scenes</a></li>
<li><a href="#_the_java_sql_preparedstatement_interface">4.3. The java.sql.PreparedStatement interface</a></li>
<li><a href="#callable-statement">4.4. The java.sql.CallableStatement interface</a></li>
<li><a href="#_batch_updates">4.5. Batch Updates</a></li>
<li><a href="#_escape_syntax">4.6. Escape Syntax</a></li>
</ul>
</li>
<li><a href="#resultsets">5. Working with result sets</a>
<ul class="sectlevel2">
<li><a href="#_resultset_properties">5.1. ResultSet properties</a></li>
<li><a href="#_resultset_manipulation">5.2. ResultSet manipulation</a></li>
</ul>
</li>
<li><a href="#transactions">6. Using transactions</a>
<ul class="sectlevel2">
<li><a href="#_jdbc_transactions">6.1. JDBC transactions</a></li>
<li><a href="#_auto_commit_mode">6.2. Auto-commit mode</a></li>
<li><a href="#_read_only_transactions">6.3. Read-only Transactions</a></li>
<li><a href="#transactions-isolation-levels">6.4. Transaction Isolation Levels</a></li>
<li><a href="#transactions-savepoints">6.5. Savepoints</a></li>
<li><a href="#transactions-tpb">6.6. Transaction Parameter Buffer</a></li>
<li><a href="#transactions-table-reservation">6.7. Table Reservation</a></li>
</ul>
</li>
<li><a href="#services">7. Working with Services</a>
<ul class="sectlevel2">
<li><a href="#_servicemanager">7.1. ServiceManager</a></li>
<li><a href="#_backup_and_restore">7.2. Backup and restore</a></li>
<li><a href="#_user_management">7.3. User management</a></li>
<li><a href="#_database_maintenance">7.4. Database maintenance</a></li>
<li><a href="#_database_statistics">7.5. Database statistics</a></li>
</ul>
</li>
<li><a href="#events">8. Working with Events</a>
<ul class="sectlevel2">
<li><a href="#_database_events">8.1. Database events</a></li>
<li><a href="#_posting_events">8.2. Posting events</a></li>
<li><a href="#_subscribing_to_events">8.3. Subscribing to events</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#reference">Reference Manual</a>
<ul class="sectlevel1">
<li><a href="#ref-connection">9. Connection reference</a>
<ul class="sectlevel2">
<li><a href="#ref-wirecrypt">9.1. Wire encryption support</a></li>
<li><a href="#ref-dbcrypt">9.2. Database encryption support</a></li>
<li><a href="#ref-defaultholdable">9.3. Default holdable result sets</a></li>
<li><a href="#ref-firebirdautocommit">9.4. Firebird auto commit mode (experimental)</a></li>
<li><a href="#ref-processinfo">9.5. Process information</a></li>
</ul>
</li>
<li><a href="#ref-statement">10. Statement reference</a>
<ul class="sectlevel2">
<li><a href="#ref-generatedkeys">10.1. Generated keys retrieval</a></li>
</ul>
</li>
<li><a href="#ref-general">11. General</a>
<ul class="sectlevel2">
<li><a href="#ref-logging">11.1. Logging</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_appendices">Appendices</a>
<ul class="sectlevel1">
<li><a href="#connectionproperties">Appendix A: Extended connection properties</a>
<ul class="sectlevel2">
<li><a href="#connectionproperties-isolation-levels">A.1. Transaction isolation levels</a></li>
</ul>
</li>
<li><a href="#systemproperties">Appendix B: System properties</a>
<ul class="sectlevel2">
<li><a href="#systemproperties-logging">B.1. Logging</a></li>
<li><a href="#systemproperties-processinfo">B.2. Process information</a></li>
<li><a href="#systemproperties-charset">B.3. Character set defaults</a></li>
<li><a href="#systemproperties-other">B.4. Other properties</a></li>
<li><a href="#systemproperties-java">B.5. Useful Java system properties</a></li>
</ul>
</li>
<li><a href="#datatypeconversion">Appendix C: Data Type Conversion Table</a>
<ul class="sectlevel2">
<li><a href="#_mapping_between_jdbc_firebird_and_java_types">C.1. Mapping between JDBC, Firebird and Java Types</a></li>
<li><a href="#_data_type_conversions">C.2. Data Type Conversions</a></li>
</ul>
</li>
<li><a href="#poolproperties">Appendix D: Connection Pool Properties</a>
<ul class="sectlevel2">
<li><a href="#_standard_jdbc_properties">D.1. Standard JDBC Properties</a></li>
<li><a href="#_pool_properties">D.2. Pool Properties</a></li>
<li><a href="#_runtime_pool_properties">D.3. Runtime Pool Properties</a></li>
<li><a href="#_firebird_specific_properties">D.4. Firebird-specific Properties</a></li>
<li><a href="#_non_standard_parameters">D.5. Non-standard parameters</a></li>
</ul>
</li>
<li><a href="#characterencoding">Appendix E: Character Encodings</a>
<ul class="sectlevel2">
<li><a href="#_encodings_types">E.1. Encodings Types</a></li>
<li><a href="#_encodings_in_java">E.2. Encodings in Java</a></li>
<li><a href="#_available_encodings">E.3. Available Encodings</a></li>
</ul>
</li>
<li><a href="#jdbcescape">Appendix F: Supported JDBC Scalar Functions</a>
<ul class="sectlevel2">
<li><a href="#_numeric_functions">F.1. Numeric Functions</a></li>
<li><a href="#_string_functions">F.2. String Functions</a></li>
<li><a href="#_time_and_date_functions">F.3. Time and Date Functions</a></li>
<li><a href="#_system_functions">F.4. System Functions</a></li>
<li><a href="#_conversion_functions">F.5. Conversion Functions</a></li>
</ul>
</li>
<li><a href="#jaybirdversions">Appendix G: Jaybird versions</a>
<ul class="sectlevel2">
<li><a href="#jb3">G.1. Jaybird 3</a></li>
<li><a href="#jb22">G.2. Jaybird 2.2</a></li>
</ul>
</li>
<li><a href="#license">Appendix H: License</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is a snapshot version of the Jaybird manual. It may contain obvious (and not so obvious)
errors, or it may still miss information on more recent features. If you find any problems, don&#8217;t
hesitate to report them on <a href="https://github.com/FirebirdSQL/jaybird-manual/issues" class="bare" target="_blank" rel="noopener">https://github.com/FirebirdSQL/jaybird-manual/issues</a> or submit a pull
request with the fix.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jaybird is a JCA/JDBC driver suite to connect to the Firebird database
server.</p>
</div>
<div class="paragraph">
<p>This driver is based on both the JCA standard for application server
connections to enterprise information systems and the well-known JDBC
standard. The JCA standard specifies an architecture in which an
application server can cooperate with a driver so that the application
server manages transactions, security, and resource pooling, and the
driver supplies only the connection functionality.</p>
</div>
<div class="paragraph">
<p>Jaybird is a driver that provides both Type 4 (pure Java) and Type 2 (native binding) support.
The type 2 driver includes support for Firebird Embedded.</p>
</div>
<div class="sect2">
<h3 id="_this_manual"><a class="anchor" href="#_this_manual"></a>1.1. This manual</h3>
<div class="paragraph">
<p>This manual covers Jaybird 3 and may use Java 8 and Firebird 3 specific features, but most examples and information also apply to previous versions of Jaybird, Firebird and Java.</p>
</div>
<div class="paragraph">
<p>New or removed features are tagged with the version that introduced a feature (eg <em class="since">Jaybird 3</em>) or removed  feature (eg <em class="until">Jaybird 3</em>).
This tagging is only done for features introduced (or removed) in Jaybird 2.2 or later, or in Firebird 3 or later, and for features available in Java/JDBC versions 8/4.2 or later.</p>
</div>
<div class="paragraph">
<p>This manual may include documentation of features of Jaybird versions later than 3 to simplify manual maintenance and versioning.</p>
</div>
</div>
<div class="sect2">
<h3 id="_history"><a class="anchor" href="#_history"></a>1.2. History</h3>
<div class="paragraph">
<p>When Borland released an open-source version of the InterBase RDBMS, it included sources for a type 3 JDBC driver called InterClient.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>
However due to some inherent limitations of the InterBase (and later Firebird) client library, it was decided that the type 3 driver was a dead end.
Instead, the Firebird team decided to develop a pure Java implementation of the wire protocol.
This implementation became the basis for Jaybird, a pure Java driver for Firebird relational database.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jaybird_architecture"><a class="anchor" href="#_jaybird_architecture"></a>1.3. Jaybird Architecture</h3>
<div class="paragraph">
<p>The Jaybird driver consists of three layers, each of which is
responsible for its part of the functionality.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The GDS layer represents a Java translation of the Firebird API. It is
represented by a number of interfaces and classes from the
<code>org.firebirdsql.gds</code> package (and sub-packages).</p>
<div class="paragraph">
<p>This API is implemented by a number of plugins that provide the pure java, native,
local, and embedded implementations of the driver.</p>
</div>
</li>
<li>
<p>The JCA layer represents the heart of the driver. Here all connection
and transaction management happens. Additionally this layer adapts the
GDS API and proxies the calls to the GDS implementation.</p>
<div class="paragraph">
<p>The JCA layer is an implementation of the Java Connector Architecture specification.</p>
</div>
</li>
<li>
<p>The JDBC layer is an implementation of the JDBC specification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the Services API allows you to manage the database and the server
itself. The Manager component represents a JMX compatible implementation
that utilizes the Services API. Currently only calls to create and drop database
are available in the Manager component, other class provide features for database
backup/restore, user management, statistics gathering, etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="distribution"><a class="anchor" href="#distribution"></a>1.4. Jaybird Distribution</h3>
<div class="paragraph">
<p>Jaybird 3 supports Firebird 2.0 and higher.
See <a href="#jaybirdversions">Jaybird versions</a> for detailed information on supported Java and Firebird versions per Jaybird version.</p>
</div>
<div class="paragraph">
<p>The latest version of Jaybird can be downloaded from <a href="https://firebirdsql.org/en/jdbc-driver/" class="bare" target="_blank" rel="noopener">https://firebirdsql.org/en/jdbc-driver/</a></p>
</div>
<div class="sect3">
<h4 id="distribution-maven"><a class="anchor" href="#distribution-maven"></a>1.4.1. Maven</h4>
<div class="paragraph">
<p>Alternatively, you can use maven to automatically download Jaybird and its dependencies.</p>
</div>
<div class="paragraph">
<p>Jaybird 3 is available from Maven central:</p>
</div>
<div class="paragraph">
<p>Groupid: <code>org.firebirdsql.jdbc</code>,<br>
Artifactid: <code>jaybird-XXX</code> (where <code>XXX</code> is <code>jdk17</code> or <code>jdk18</code>).<br>
Version: <code>3.0.5</code></p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.firebirdsql.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;jaybird-jdk18&lt;/artifactId&gt;
  &lt;version&gt;3.0.5&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Maven definition of Jaybird depends on antlr-runtime by default.</p>
</div>
<div class="paragraph">
<p>If your application is deployed to a Java EE application server, you will need to
exclude the <code>javax.resource:connector-api</code> dependency, and add it as a provided
dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.firebirdsql.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;jaybird-jdk18&lt;/artifactId&gt;
  &lt;version&gt;3.0.5&lt;/version&gt;
  &lt;exclusions&gt;
    &lt;exclusion&gt;
      &lt;groupId&gt;javax.resource&lt;/groupId&gt;
      &lt;artifactId&gt;connector-api&lt;/artifactId&gt;
    &lt;/exclusion&gt;
  &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.resource&lt;/groupId&gt;
  &lt;artifactId&gt;connector-api&lt;/artifactId&gt;
  &lt;version&gt;1.5&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use Type 2 support (native, local or embedded), you need to
explicitly include JNA as a dependency, where the version (4.4.0) is already specified by
the Jaybird dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;net.java.dev.jna&lt;/groupId&gt;
  &lt;artifactId&gt;jna&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We plan to make native and embedded support a separate library in future
releases, and provide Firebird client libraries as Maven dependencies as well.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_quality_assurance"><a class="anchor" href="#_quality_assurance"></a>1.5. Quality Assurance</h3>
<div class="paragraph">
<p>The Jaybird team uses JUnit test cases to assure the quality of the released driver.
During development unit tests are extensively used.
Committing a code change to the source control is not allowed until it passes all existing unit tests.
Each reproducible bug usually gets its own test case.
This guarantees that a clean check out can be compiled and will not contain any previously discovered and fixed bugs.
Currently there are more than 3900 test cases covering most of the driver code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_useful_resources"><a class="anchor" href="#_useful_resources"></a>1.6. Useful resources</h3>
<div class="sect3">
<h4 id="_jdbc"><a class="anchor" href="#_jdbc"></a>1.6.1. JDBC</h4>
<div class="paragraph">
<p>For JDBC documentation, see <a href="http://www.oracle.com/technetwork/java/javase/jdbc/index.html" class="bare" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/jdbc/index.html</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_firebird"><a class="anchor" href="#_firebird"></a>1.6.2. Firebird</h4>
<div class="paragraph">
<p>General information about the Firebird database is available from the Firebird web site (<a href="https://www.firebirdsql.org/" class="bare" target="_blank" rel="noopener">https://www.firebirdsql.org/</a>).</p>
</div>
<div class="paragraph">
<p>For information about using SQL in Firebird, see the <a href="https://www.firebirdsql.org/file/documentation/reference_manuals/fblangref25-en/html/fblangref25.html" target="_blank" rel="noopener">Firebird 2.5 Language Reference</a> and other documents available from the <a href="https://www.firebirdsql.org/en/reference-manuals/" target="_blank" rel="noopener">Reference Manuals</a> section of the Firebird web site.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jaybird_support"><a class="anchor" href="#_jaybird_support"></a>1.6.3. Jaybird Support</h4>
<div class="paragraph">
<p>Support for Jaybird is available through the following channels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://groups.yahoo.com/group/Firebird-Java" target="_blank" rel="noopener">Firebird-Java group</a> and corresponding mailing
list <a href="mailto:firebird-java@yahoogroups.com">firebird-java@yahoogroups.com</a></p>
<div class="paragraph">
<p>You can subscribe to the mailing list by sending an email to <a href="mailto:firebird-java-subscribe@yahoogroups.com">firebird-java-subscribe@yahoogroups.com</a></p>
</div>
</li>
<li>
<p>On <a href="https://www.firebirdsql.org/file/documentation/drivers_documentation/java/faq.html" target="_blank" rel="noopener">Jaybird Frequently Asked Questions</a>.</p>
</li>
<li>
<p>On <a href="https://github.com/FirebirdSQL/jaybird/wiki/" target="_blank" rel="noopener">Jaybird wiki</a>.</p>
<div class="paragraph">
<p>This is a place where the community shares information about different aspects of Jaybird usage,
configuration examples for different applications/servers, tips and tricks, FAQ, etc.</p>
</div>
</li>
<li>
<p>On <a href="https://stackoverflow.com/" target="_blank" rel="noopener">Stack Overflow</a>, please tag your questions with
<strong>jaybird</strong> and <strong>firebird</strong></p>
<div class="paragraph">
<p>Please make sure to familiarize yourself with the rules and expectations of Stack Overflow before asking,
see <a href="https://stackoverflow.com/tour" target="_blank" rel="noopener">Stack Overflow Tour</a> and <a href="https://stackoverflow.com/help/asking" target="_blank" rel="noopener">Help Center: Asking</a></p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_contributing"><a class="anchor" href="#_contributing"></a>1.7. Contributing</h3>
<div class="paragraph">
<p>There are several ways you can contribute to Jaybird or Firebird in general:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Participate on the mailing lists (see <a href="https://www.firebirdsql.org/en/mailing-lists/" class="bare" target="_blank" rel="noopener">https://www.firebirdsql.org/en/mailing-lists/</a>)</p>
</li>
<li>
<p>Report bugs or submit patches on the tracker (see <a href="#intro-reporting-bugs">Reporting Bugs</a>)</p>
</li>
<li>
<p>Create pull requests on GitHub (<a href="https://github.com/FirebirdSQL/jaybird" class="bare" target="_blank" rel="noopener">https://github.com/FirebirdSQL/jaybird</a>)</p>
</li>
<li>
<p>Become a developer (for Jaybird contact us on firebird-java, for Firebird in general, use the
Firebird-devel mailing list)</p>
</li>
<li>
<p>Become a paying member or sponsor of the Firebird Foundation (see <a href="https://www.firebirdsql.org/en/firebird-foundation/" class="bare" target="_blank" rel="noopener">https://www.firebirdsql.org/en/firebird-foundation/</a>)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="intro-reporting-bugs"><a class="anchor" href="#intro-reporting-bugs"></a>1.7.1. Reporting Bugs</h4>
<div class="paragraph">
<p>The developers follow the <a href="mailto:firebird-java@yahoogroups.com">firebird-java@yahoogroups.com</a> list. Join the list and post information
about suspected bugs. List members may be able to help out to determine if it is an actual bug,
provide a workaround and get you going again, whereas bug fixes might take awhile.</p>
</div>
<div class="paragraph">
<p>You can report bugs in the Firebird bug tracker, project <a href="http://tracker.firebirdsql.org/browse/JDBC" target="_blank" rel="noopener">"Java Client (Jaybird)"</a></p>
</div>
<div class="paragraph">
<p>When reporting bugs, please provide a minimal, but complete reproduction, including databases and
source code to reproduce the problem. Patches to fix bugs are also appreciated. Make sure the patch is
against a recent master version of the code. You can also fork the jaybird repository and create pull
requests.</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="user-manual" class="sect0"><a class="anchor" href="#user-manual"></a>User Manual</h1>
<div class="sect1">
<h2 id="connection"><a class="anchor" href="#connection"></a>2. Obtaining a connection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jaybird is a regular JDBC driver and supports two primary ways to obtain connection: via
<code>java.sql.DriverManager</code> and via an implementation of the <code>javax.sql.DataSource</code> interface.</p>
</div>
<div class="sect2">
<h3 id="connection-drivermanager"><a class="anchor" href="#connection-drivermanager"></a>2.1. Obtaining connection java.sql.DriverManager</h3>
<div class="paragraph">
<p><code>java.sql.DriverManager</code> was the first connection factory in Java. It is based on the concept of the
JDBC URL, a string that uniquely identifies the database to connect. The driver
manager then checks which driver(s) - if any - can establish a connection.</p>
</div>
<div class="paragraph">
<p>There is also support to specify additional connection parameters, like user name and password.</p>
</div>
<div class="paragraph">
<p>A JDBC URL consists of three parts:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jdbc:firebirdsql://localhost:3050/c:/database/example.fdb</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jdbc</code><br>
JDBC protocol</p>
</li>
<li>
<p><code>firebirdsql</code><br>
JDBC subprotocol, identifies driver to use</p>
</li>
<li>
<p><code>//localhost:3050/c:/database/example.fdb</code></p>
<div class="paragraph">
<p>This is a database specific part, and identifies the database for the driver to connect, in
the case of Jaybird that is <code>//&lt;host&gt;:&lt;port&gt;/&lt;path to database&gt;</code></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first part, <code>jdbc:firebirdsql:</code> is required by JDBC and specifies the so called protocol and
subprotocol for the JDBC connection. In other words, the type of connection that the application
wants to obtain, in this example it is a connection to a Firebird database.</p>
</div>
<div class="paragraph">
<p>An example of obtaining a connection is shown below.</p>
</div>
<div class="listingblock">
<div class="title">Simple example to obtain a JDBC connection</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package hello;

import java.sql.*;

public class HelloServer {

  public static void main(String[] args) throws Exception {

    Class.forName("org.firebirdsql.jdbc.FBDriver"); <i class="conum" data-value="1"></i><b>(1)</b>

    Connection connection = DriverManager.getConnection(
        "jdbc:firebirdsql://localhost:3050/c:/db/employee.fdb",
        "SYSDBA", "masterkey"); <i class="conum" data-value="2"></i><b>(2)</b>

    // do something here
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first line of this code is important – it tells Java to load the Jaybird JDBC driver. As required
by the JDBC specification, at this point driver registers itself with <code>java.sql.DriverManager</code>.</p>
</div>
<div class="paragraph">
<p>Since Java 6 (JDBC 4), explicitly loading the driver using <code>Class.forName("org.firebirdsql.jdbc.FBDriver")</code>
is no longer necessary, except when the driver is not on the system class path. Examples where it
may be necessary to explicitly load the driver are web applications that include the driver in the
deployment. There, the driver is not on the system class path, so it will need to be loaded explicitly.</p>
</div>
<div class="paragraph">
<p>We will leave out usages of <code>Class.forName</code> in further examples, they will work because of automatic
driver loading.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Registering the JDBC driver</div>
<div class="paragraph">
<p>There are several ways to register JDBC driver:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>DriverManager</code> loads the drivers from the system class path. This happens automatically.</p>
</li>
<li>
<p>The application explicitly loads the driver&#8217;s class. This is only necessary if the automatic
loading (see previous item) is not available. This can be necessary because the driver <code>jar</code> is
loaded dynamically, through a different classloader, etc).</p>
<div class="paragraph">
<p>The JDBC specification requires that during class initialization the driver registers itself with
<code>DriverManager</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Class.forName("org.firebirdsql.jdbc.FBDriver");</pre>
</div>
</div>
</li>
<li>
<p>The JDBC driver is listed in the <code>jdbc.drivers</code> system property. For example in your
<code>~/.hotjava/properties</code> file you can specify following line: (<strong>TODO</strong>: is ~/.hotjava/properties  still valid?)</p>
<div class="literalblock">
<div class="content">
<pre>jdbc.drivers=foo.Driver:org.firebirdsql.jdbc.FBDriver</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively you can specify the value of this property during JVM startup:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java\
  -Djdbc.drivers=org.firebirdsql.jdbc.FBDriver\
  -classpath jaybird-full-{jaybird-full-version}.jar;C:/myproject/classes\
  my.company.SomeJavaExample</pre>
</div>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The second statement of the example tells the <code>java.sql.DriverManager</code>
to open a database connection to the Firebird server running on localhost,
and the path to the database is <code>c:/database/employee.fdb</code>.</p>
</div>
<div class="paragraph">
<p>The connection specification consists of the host name of the database server,
optionally you can specify a port (by default port 3050 is used).
The host name can be specified using either its DNS name (for example <code>fb-server.mycompany.com</code> or
just <code>fb-server</code>), or its IP address (for example <code>192.168.0.5</code>, or <code>[1080::8:800:200C:417A]</code> for
an IPv6 address).</p>
</div>
<div class="paragraph">
<p>After the server name and port, the alias or path to the database is specified. We suggest to specify
a database alias instead of the absolute database path. For more information about using aliases, see
the documentation of Firebird server.</p>
</div>
<div class="paragraph">
<p>The format of the path depends on the platform of the Firebird server.</p>
</div>
<div class="paragraph">
<p>On Windows, the path must include the drive letter and path, for example <code>c:/database/employee.fdb</code>, which points to the employee database that can be found in the <code>database</code> directory of drive <code>C:`</code>.
Java (and Firebird) supports either <code>/</code> or <code>\</code> (escaped as <code>\\</code>) as path separator on the Windows platform.
On Unix and Linux platform, you can use only <code>/</code> as the path separator.</p>
</div>
<div class="paragraph">
<p>On Unix platforms the path must include the root, as the path is otherwise interpreted relative to
a server-dependent folder. Having to include the root has the effect that a database in
<code>/var/firebird/employee.fdb</code> needs to use a double <code>//</code> after the host name (and port) in the
connection string: <code>jdbc:firebirdsql://localhost//var/firebird/employee.fdb</code></p>
</div>
<div class="paragraph">
<p>It is possible to specify a relative path, but as this depends on the server
configuration, this may be confusing or easily lead to errors. We suggest not to use relative paths,
and instead use an alias.</p>
</div>
<div class="sect3">
<h4 id="_specifying_extended_properties"><a class="anchor" href="#_specifying_extended_properties"></a>2.1.1. Specifying extended properties</h4>
<div class="paragraph">
<p>What if we want to specify additional connection parameters, for example a client encoding?
The JDBC API provides a method to specify additional connection properties:</p>
</div>
<div class="listingblock">
<div class="title">Obtaining JDBC connection with additional connection properties</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package hello;

import java.sql.*;
import java.util.*;

public class HelloServerWithEncoding {

  public static void main(String[] args) throws Exception {
    Properties props = new Properties();

    props.setProperty("user", "SYSDBA");
    props.setProperty("password", "masterkey");
    props.setProperty("encoding", "UTF8");

    try (Connection connection = DriverManager.getConnection(
            "jdbc:firebirdsql://localhost:3050/C:/db/employee.fdb",
            props)) {

        // do something here

    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>user</code> and <code>password</code> properties are defined in JDBC. All other property names, like <code>encoding</code>
here, are driver-specific.</p>
</div>
<div class="paragraph">
<p>Additional properties, for example the SQL role for the connection can be
added to the <code>props</code> object. The list of properties available in Jaybird
can be found in <a href="#connectionproperties">Extended connection properties</a>.</p>
</div>
<div class="paragraph">
<p>It is not always possible to use the above described method. Jaybird also provides a possibility to
specify extended properties in the JDBC URL.</p>
</div>
<div class="literalblock">
<div class="title">Extended JDBC URL format</div>
<div class="content">
<pre>jdbc:firebirdsql://host[:port]/&lt;path to db&gt;?&lt;properties&gt;
&lt;properties&gt; ::= &lt;property&gt;[{&amp; | ;}&lt;properties&gt;]
&lt;property&gt;   ::= &lt;name&gt;[=&lt;value&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>The example below shows the specification for extended JDBC properties in the URL.</p>
</div>
<div class="paragraph">
<p>In this case extended properties are passed together with the URL using
the HTTP-like parameter passing scheme: first comes the main part of the
URL, then <code>"?"</code>, then name-value pairs separated with <code>&amp;</code> or <code>;</code>. This example
is equivalent to the previous example.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Despite the URL-like syntax, Jaybird does not (yet) support URL encoding.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Specifying extended properties in the JDBC URL</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import java.sql.*;

...

Connection connection = DriverManager.getConnection(
    "jdbc:firebirdsql://localhost:3050/C:/db/employee.fdb?encoding=UTF8",
    "SYSDBA",
    "masterkey");</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="connection-datasource"><a class="anchor" href="#connection-datasource"></a>2.1.2. Obtaining a connection via javax.sql.DataSource</h4>
<div class="paragraph">
<p>The JDBC 2.0 specification introduced a mechanism to obtain database connections without
requiring the application to know any specifics of the underlying JDBC driver. The application is
only required to know the logical name to find an instance of the <code>javax.sql.DataSource</code> interface
using Java Naming and Directory Interface (JNDI). This is a common way to obtain connections in web
and application servers. Alternatively, the <code>DataSource</code> may be injected by CDI or Spring.</p>
</div>
<div class="paragraph">
<p>In order to obtain a connection via a <code>DataSource</code> object, you can use the code shown below. This code
assumes that you have correctly configured the JNDI properties. For more information about
configuring JNDI please refer to the documentation provided with your web or application server.</p>
</div>
<div class="listingblock">
<div class="title">Typical way to obtain JDBC connection via JNDI</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package hello;

import java.sql.*;
import javax.sql.*;
import javax.naming.*;

public class HelloServerJNDI {

  public static void main(String[] args) throws Exception {

    InitialContext ctx = new InitialContext();
    DataSource ds = (DataSource)ctx.lookup("jdbc/SomeDB");

    try (Connection connection = ds.getConnection()) {
      // do something here...
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Usually, the binding between the <code>DataSource</code> object and its JNDI name
happens in the configuration of your web or application server. However
under some circumstances (e.g. you are developing your own JNDI-enabled
application server/framework), you may have to do this yourself. You can use
this code snippet for this purpose:</p>
</div>
<div class="listingblock">
<div class="title">Programmatic way to instantiate javax.sql.DataSource implementation</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import javax.naming.*;
import org.firebirdsql.ds.*;
...
FBSimpleDataSource ds = new FBSimpleDataSource();

ds.setDatabase("//localhost:3050/C:/database/employee.fdb");
ds.setUser("SYSDBA");
ds.setPassword("masterkey");

InitialContext ctx = new InitialContext();

ctx.bind("jdbc/SomeDB", ds);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DataSource</code> implementation supports all connection properties available
to the <code>DriverManager</code> interface.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="driver-types"><a class="anchor" href="#driver-types"></a>2.2. Driver types</h3>
<div class="paragraph">
<p>As mentioned in the section <a href="#_jaybird_architecture">Jaybird Architecture</a>, Jaybird supports multiple
implementations of the GDS API. The default Jaybird distribution contains two main
categories of the implementations: the pure Java implementation of the
Firebird wire protocol, and a JNA proxy that can use a Firebird <code>fbclient</code> library.</p>
</div>
<div class="paragraph">
<p>The next sections provide a description of these types and their configuration
with the corresponding JDBC URLs that should be used to
obtain the connection of desired type. The type of the JDBC driver for
the <code>javax.sql.DataSource</code> is configured via a corresponding property.</p>
</div>
<div class="sect3">
<h4 id="driver-pure-java"><a class="anchor" href="#driver-pure-java"></a>2.2.1. PURE_JAVA type</h4>
<div class="paragraph">
<p>The <code>PURE_JAVA</code> type (JDBC Type 4) uses a pure Java implementation of the Firebird
wire protocol. This type is recommended for connecting to a remote
database server using TCP/IP sockets. No installation is required except
adding the JDBC driver to the class path. This type of driver provides
the best performance when connecting to a remote server.</p>
</div>
<div class="paragraph">
<p>In order to obtain a connection using the <code>PURE_JAVA</code> driver type you have
to use a JDBC URL as shown in <a href="#connection-drivermanager">Obtaining connection java.sql.DriverManager</a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jdbc:firebirdsql://host[:port]/&lt;path to database&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>When using <code>javax.sql.DataSource</code> implementation, you can specify either
<code>"PURE_JAVA"</code> or <code>"TYPE4"</code> driver type, however this type is used by
default.</p>
</div>
</div>
<div class="sect3">
<h4 id="driver-native"><a class="anchor" href="#driver-native"></a>2.2.2. NATIVE and LOCAL types</h4>
<div class="paragraph">
<p>The <code>NATIVE</code> and <code>LOCAL</code> types (JDBC Type 2) use a JNA proxy to access the Firebird
client library and requires installation of the Firebird client. The
<code>NATIVE</code> driver type is used to access the remote database server, the
<code>LOCAL</code> type accesses the database server running on the same host by
means of IPC (Inter-Process Communication). Performance of <code>NATIVE</code> driver is approximately 10% lower
compared to the <code>PURE_JAVA</code> driver, but <code>LOCAL</code> type has up to 30% higher
performance compared to the <code>PURE_JAVA</code> driver when connecting the server
on the same host. This is mostly due to the fact that TCP/IP stack is
not involved in this mode.</p>
</div>
<div class="paragraph">
<p>To create a connection using the <code>NATIVE</code> JDBC driver to
connect to a remote server you have to use the following JDBC URL with
the native subprotocol:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jdbc:firebirdsql:native:host[/port]:&lt;path to database&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>When connecting to a local database server using the <code>LOCAL</code> driver, you
should use following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jdbc:firebirdsql:local:&lt;absolute path to database&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In addition to Jaybird, this requires a native Firebird client library, and JNA 4.4.0
needs to be on the classpath.</p>
</div>
<div class="sect4">
<h5 id="driver-native-windows"><a class="anchor" href="#driver-native-windows"></a>Windows</h5>
<div class="paragraph">
<p>On Windows, you need to make sure that <code>fbclient.dll</code> is located on the
<code>PATH</code> environment variable. Alternatively you can specify the directory
containing this DLL in the <code>jna.library.path</code> system property.</p>
</div>
<div class="paragraph">
<p>For example, if you put a copy of <code>fbclient.dll</code> in the current directory you have to use
the following command to start Java:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -cp &lt;relevant claspath&gt; -Djna.library.path=. com.mycompany.MyClass</pre>
</div>
</div>
<div class="paragraph">
<p>If your Java install is 32 bit, you need a 32 bit <code>fbclient.dll</code>, for 64 bit Java, a 64 bit <code>fbclient.dll</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="driver-native-linux"><a class="anchor" href="#driver-native-linux"></a>Linux</h5>
<div class="paragraph">
<p>On Linux, you need to make sure that <code>libfbclient.so</code> is available through
the <code>LD_PATH</code> environment variable.</p>
</div>
<div class="paragraph">
<p>Usually shared libraries are stored in the <code>/usr/lib/</code> directory; however you will need
root permissions to install the library there. Some distributions will only have,
for example, <code>libfbclient.so.2.5</code>. In that case you may need to add a symlink from <code>libfbclient.so</code>
to the client on your system.</p>
</div>
<div class="paragraph">
<p>Alternatively you can specify the directory containing the library in the <code>jna.library.path</code>
Java system property. See the Windows example above for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="driver-native-limitations"><a class="anchor" href="#driver-native-limitations"></a>Limitations</h5>
<div class="paragraph">
<p><strong>TODO</strong> Section might be outdated</p>
</div>
<div class="paragraph">
<p>Firebird client library is not thread-safe when connecting to a local
database server using IPC. Jaybird provides the necessary
synchronization in Java code using a static object instance. However,
this static object instance is local to the classloader that has loaded
the Jaybird classes.</p>
</div>
<div class="paragraph">
<p>In order to guarantee correct synchronization , the Jaybird driver must
be loaded by the top-most classloader. For example, when using the Type
2 JDBC driver with a web or application server, you have to add the
Jaybird classes to the main classpath (for example, to the <code>lib/</code>
directory of your web or application server), but <strong>not</strong> to the web or
Jave EE application, e.g. the <code>WEB-INF/lib</code> directory.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="driver-embedded"><a class="anchor" href="#driver-embedded"></a>2.2.3. EMBEDDED type</h4>
<div class="paragraph">
<p>The Embedded server JDBC driver is a Type 2 JDBC driver that, rather
than using the Firebird client library, loads the Firebird embedded server
library instead. This is the highest performance type of JDBC driver for
accessing local databases, as the Java code accesses the database file
directly.</p>
</div>
<div class="paragraph">
<p>In order to obtain a connection via DriverManager you have to use
following URL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jdbc:firebirdsql:embedded:&lt;path to database&gt;

jdbc:firebirdsql:embedded:host[/port]:&lt;path to database&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>When host and, optionally, port is specified, embedded server acts as
client library (i.e. you get the same Type 2 behavior as you would get
with using "native").</p>
</div>
<div class="paragraph">
<p>This driver tries to load <code>fbembed.dll/libfbembed.so</code> and <code>fbclient.dll/libfbclient.so</code>,
the last - of course - only works if that fbclient provides Firebird embedded.</p>
</div>
<div class="paragraph">
<p>See also the <a href="#driver-native">NATIVE and LOCAL types</a> section.</p>
</div>
<div class="paragraph">
<p>When using Firebird 3 embedded, you will need to make sure the necessary plugins like
<code>engine12.dll/libengine12.so</code> are accessible to the client library, consult the
Firebird 3 documentation for more information. For an example, see the article
<a href="https://www.lawinegevaar.nl/firebird/jaybird_embedded_example.html" target="_blank" rel="noopener">Jaybird with Firebird embedded example</a></p>
</div>
<div class="sect4">
<h5 id="driver-embedded-limitations"><a class="anchor" href="#driver-embedded-limitations"></a>Limitations</h5>
<div class="paragraph">
<p><strong>TODO</strong> Section might be outdated</p>
</div>
<div class="paragraph">
<p>The Firebird embedded server for Linux is not thread safe. Jaybird
provides the needed synchronization in Java code, similar to the one
described for the Type 2 JDBC driver. This implies the same restrictions
on the classloader that will load the Jaybird classes.</p>
</div>
<div class="paragraph">
<p>The Firebird embedded server for Windows opens databases in exclusive
mode. This means that this particular database is accessible only to one
Java virtual machine. <em>There is no exclusive mode on the POSIX platform.
When the same database file is accessed by multiple JVM instances,
database will be corrupted!</em></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="driver-ooremote"><a class="anchor" href="#driver-ooremote"></a>2.2.4. OOREMOTE type</h4>
<div class="paragraph">
<p>The <code>OOREMOTE</code> type is a JDBC Type 4 specifically for use with OpenOffice.org and LibreOffice. It
addresses some differences in interpretation of the JDBC specification, and provides alternative
metadata in certain cases to allow OpenOffice.org and LibreOffice to function correctly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This only describes connecting to Firebird using Jaybird from OpenOffice.org/LibreOffice,
it is not about the Firebird embedded use that has been introduced in recent LibreOffice versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to obtain a connection you have to use following URL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jdbc:firebirdsql:oo://host[:port]/&lt;path to database&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>All other notes for <a href="#driver-pure-java">PURE_JAVA type</a> apply.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connection-pooling"><a class="anchor" href="#connection-pooling"></a>2.3. Connection Pooling</h3>
<div class="paragraph">
<p>Each time a connection is opened via <code>DriverManager</code>, a new physical
connection to server is opened. It is closed when the connection is
closed. In order to avoid the overhead of creating connections, you can use
a connection pool implementation to maintain a cache of open physical
connections that can be reused between user sessions.</p>
</div>
<div class="paragraph">
<p>Since version 3.0, Jaybird no longer provides a connection pool. If you need
a <code>javax.sql.DataSource</code> implementation that provides a connection pool, either use the
connection pool support of your application server, or consider using <a href="https://brettwooldridge.github.io/HikariCP/" target="_blank" rel="noopener">HikariCP</a>,
<a href="http://commons.apache.org/proper/commons-dbcp/" target="_blank" rel="noopener">DBCP</a>, or <a href="http://www.mchange.com/projects/c3p0/" target="_blank" rel="noopener">c3p0</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="data-source-implementation"><a class="anchor" href="#data-source-implementation"></a>2.4. The javax.sql.DataSource implementation</h3>
<div class="paragraph">
<p>Connection pool implementations, whether provided by a Java EE application server or
a third-party library, are exposed as an implementation of the <code>javax.sql.DataSource</code> interface.</p>
</div>
<div class="paragraph">
<p>The most important method exposed by this interface is the <code>getConnection()</code> method, which will
return a connection based on the configuration of the data source. For a 'basic' (non-pooling) data
source this will create a new, physical, connection. For a connection pool, this will create a logical
connection that wraps a physical connection from the pool.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The 'user' of a connection should not care whether the connection is pooled or not, the
connection should behave the same from the perspective of the user, and the user should use the
connection in the same way. This should allow for swapping between a non-pooling and pooling
data source in an application without any changes to the code using the data source.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the application is done with the connection, it should call <code>close()</code> on the connection.
A connection from a non-pooling data source will be closed. For a logical connection from a
connection pool, <code>close()</code> will invalidate the logical connection (which will make it
behave like a closed connection), and return the underlying physical connection to the
connection pool, where it will be either kept for re-use, or maybe closed.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Use a connection for the shortest scope (and time) necessary for correct behaviour. Get a connection,
and close it as soon as you&#8217;re done. When using a connection pool, this has the added benefit that just
a few connections can serve the needs of the application.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="connection-pool-data-source-implementation"><a class="anchor" href="#connection-pool-data-source-implementation"></a>2.5. The javax.sql.ConnectionPoolDataSource implementation</h3>
<div class="paragraph">
<p>The <code>javax.sql.ConnectionPoolDataSource</code> interface represents a factory that creates
<code>PooledConnection</code> objects for use by a connection pool. For example, application servers
support the use of a <code>ConnectionPoolDataSource</code> to populate their connection pool.</p>
</div>
<div class="paragraph">
<p>A <code>PooledConnection</code> instance represents a physical connection to a database and is a source
of logical connections that a connection pool can hand out to the application. Closing this
logical connection returns the physical connection back into the pool.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Contrary to its name, a <code>ConnectionPoolDataSource</code> is not a connection pool!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Jaybird provides <code>org.firebirdsql.ds.FBConnectionPoolDataSource</code> as an implementation of the
<code>javax.sql.ConnectionPoolDataSource</code> interface.</p>
</div>
<div class="paragraph">
<p><strong>TODO</strong> Add more info</p>
</div>
</div>
<div class="sect2">
<h3 id="xa-data-source-implementation"><a class="anchor" href="#xa-data-source-implementation"></a>2.6. The javax.sql.XADataSource implementation</h3>
<div class="paragraph">
<p>The JDBC 2.0 specification introduced the <code>javax.sql.XADataSource</code> interface
that should be used to access connections that can participate in
distributed transactions with JTA-compatible transaction coordinator.
This gives applications possibility to use two-phase commit to
synchronize multiple resource managers.</p>
</div>
<div class="paragraph">
<p>Just like <code>javax.sql.ConnectionPoolDataSource</code>, applications normally don&#8217;t access
an <code>XADataSource</code> implementation directly, instead it is used as a factory of connections for
an XA-enabled data source. To the application this is usually exposed as a <code>javax.sql.DataSource</code>.</p>
</div>
<div class="paragraph">
<p>Jaybird provides <code>org.firebirdsql.ds.FBXADataSource</code> as an implementation of
the <code>javax.sql.XADataSource</code> interface.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exceptionhandling"><a class="anchor" href="#exceptionhandling"></a>3. Handling exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Exception handling is probably the most important aspect that
directly affects the stability of the application. Correct handling of
the error cases guarantees correct functioning of the client code as
well as the database server.</p>
</div>
<div class="paragraph">
<p>All methods of the interfaces defined in the JDBC specification throw instances of
<code>java.sql.SQLException</code> to notify about error conditions that happen
during request processing. The <code>SQLException</code> is a checked exception,
which forces Java programmers to either handle it with the try/catch
clause or redeclare it in the method signature.</p>
</div>
<div class="sect2">
<h3 id="_working_with_exceptions"><a class="anchor" href="#_working_with_exceptions"></a>3.1. Working with exceptions</h3>
<div class="paragraph">
<p>Exception handling becomes even more important if we consider that
this topic is either ignored or presented in incorrect form in most
JDBC tutorials. The <a href="https://docs.oracle.com/javase/tutorial/jdbc/index.html">official JDBC tutorial from Oracle</a>
briefly mentions that exceptions should be handled by using try/catch blocks
only at the end of the course, but neither reasons for doing this nor the
best practices are presented.</p>
</div>
<div class="paragraph">
<p>There are good reasons to think about exception handling in your
applications before you start coding. First of all, it is very hard to
change the exception handling pattern in existing code. The changes
will affect all layers above the place where the changes in exception
handling are made and the new application must be thoroughly tested
after the change.</p>
</div>
<div class="paragraph">
<p>Another reason was already mentioned on the beginning of this chapter:
instances of <code>java.sql.SQLException</code> are the only way for the RDBMS
server to notify about the error condition that happened during request
processing. By checking the error code which is sent with the exception
application can try to recover from the error.</p>
</div>
<div class="paragraph">
<p>And last but not least, there is resource management. When an
exception happens in the method, the execution flow of Java code differs
from the normal flow, and only correctly coded application will ensure
that all allocated resources will be released. The resources in our case
are JDBC connections, statements, prepared statements and callable
statements, result sets, etc. All these objects not only take
memory in the Java Virtual Machine of the application, but also
consume memory on the server, which, worst case, can lead to
an unintended Denial-of-Service attack, as the database server can
no longer service requests.</p>
</div>
<div class="paragraph">
<p>A good exception handling strategy requires you do distinguish three
kinds of error conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>errors that the database access layer can detect and correctly handle; for
example, the application might decide to re-execute the business
transaction if the database server returned a deadlock error;</p>
</li>
<li>
<p>errors that database access layer can detect, but is unable to handle;
usually those are all database errors that do not have special handling
routines;</p>
</li>
<li>
<p>errors that database access layer cannot detect without additional
code unrelated to the functionality of this layer; basically, all
runtime exceptions fall into this category.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handling strategy then consists of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>processing the selected error codes for cases described above;</p>
</li>
<li>
<p>converting the generic <code>SQLException</code> into a generic business error in the
application (this can be throwing some generic exception defined in the
application, but can also be an entry in the application event log and
short message that asks to retry the operation later);</p>
</li>
<li>
<p>some emergency tactics, since the error that happened (e.g.
<code>NullPointerException</code> or <code>OutOfMemoryError</code>) was not considered while the
application was created, thus possibly leaving it in an unknown state;
further operation should be considered dangerous and the corresponding
execution branch has to be halted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The problem of resource management can be solved if resource allocation and deallocation
happens in the same code block and is protected with a try-with-resources block.
The code to recover from error conditions should use try/catch
blocks. Example of such error and resource handling code is presented
below.</p>
</div>
<div class="listingblock">
<div class="title">Typical resource allocation and error handling patterns</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">String updateString = "update COFFEES " +
    "set SALES = ? where COF_NAME like ?";

try (PreparedStatement updateSales = con.prepareStatement(updateString)) {
  int [] salesForWeek = {175, 150, 60, 155, 90};
  String [] coffees = {"Colombian", "French_Roast",
      "Espresso", "Colombian_Decaf",
      "French_Roast_Decaf"};

  int len = coffees.length;

  for(int i = 0; i &lt; len; i++) {
    updateSales.setInt(1, salesForWeek[i]);
    updateSales.setString(2, coffees[i]);

    try {
      updateSales.executeUpdate();
    } catch(SQLException ex) {
      if (ex.getErrorCode() == ...) {
        // do something
      } else {
        throw new BusinessDBException(ex);
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The nested try/catch block shows you an example of handling a deadlock
error if it happens (first scenario according to our classification),
otherwise the exception is converted and passed to the upper layers
(second scenario). As you see, there is no special treatment to the
third scenario.</p>
</div>
<div class="paragraph">
<p>A possible bug in the JDBC driver could have generated runtime exception
in the <code>PreparedStatement.executeUpdate()</code> method, which would lead to
the statement handle leakage if the try-with-resource block had not been used to do the
resource cleanup. As a rule of thumb, always declare and allocate resources
in a try-with-resources block: the resource will be automatically closed/freed
at the end of the block, even if exceptions occur.</p>
</div>
<div class="paragraph">
<p>Such coding practice might look weird, because on first sight the
whole purpose of using the <code>PreparedStatement</code> is neglected: the statement
is prepared, used only once and then deallocated. However, when this
practice is combined with connection and statement pooling, it
brings enormous advantage to the application code. The code becomes much
more manageable – resource allocations and deallocations happen in the
same method and the software developer does not need to remember the places where
the same prepared statement might be used – a statement pool will either
reuse the statement or it will prepare a new one, if it detects that all
pooled prepared statements are currently in use. As a side effect,
the application will always use the minimum number of statements handles,
which in turn reduces the used resources on the database side.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Jaybird currently provides no statement pooling itself, availability will depend on the
connection pool library used. Consult the documentation of your connection pool
to see if - and how - it provides statement pooling.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_warnings"><a class="anchor" href="#_warnings"></a>3.2. Warnings</h3>
<div class="paragraph">
<p>Some errors returned by Firebird are treated as warnings.
They are converted into instances of <code>java.sql.SQLWarning</code> class in the
JDBC layer. These exceptions are not thrown from the driver methods, but
added to a connection instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Currently no warning is added to <code>Statement</code> or <code>ResultSet</code> objects.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each next warning is appended to the tail of the warning chain. In order
to read the warning chain, use the code presented below.</p>
</div>
<div class="listingblock">
<div class="title">Example how to work with warnings</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import java.sql.*;
....
SQLWarning warning = connection.getWarnings();
while (warning != null) {
  .... // do something with the warning
  warning = warning.getNextWarning();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="title">Alternative example how to work with warnings</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import java.sql.*;
....
for (Throwable throwable : connection.getWarnings()) {
  if (throwable instanceof SQLWarning) {
    SQLWarning warning = (SQLWarning) throwable;
    .... // do something with the warning
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This second example will iterate over the first warning, all its causes (if any), and then on
to other warnings (if any), and so on.</p>
</div>
<div class="paragraph">
<p>In order to clear existing warning, call <code>Connection.clearWarnings()</code> method.</p>
</div>
</div>
<div class="sect2">
<h3 id="_java_sql_sqlexception_in_jaybird"><a class="anchor" href="#_java_sql_sqlexception_in_jaybird"></a>3.3. java.sql.SQLException in Jaybird</h3>
<div class="paragraph">
<p><strong>TODO</strong> Information in section is outdated</p>
</div>
<div class="paragraph">
<p>An <code>SQLException</code> is a special exception that is thrown by the JDBC
connectivity component in case of an error. Each instance of this
exception is required to carry the vendor error code (if applicable) and
a SQL state according to the X/Open SQLstate or SQL:2003 specifications. Firebird
and Jaybird use SQL:2003 SQL state codes.<sup class="footnote" id="_footnote_sqlstate">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
<div class="paragraph">
<p>When multiple SQL errors happened, they are joined into a chain. Usually
the most recent exception is thrown to the application, the exceptions
that happened before can be obtained via <code>SQLException.getNextException()</code> method.
Alternatively, <code>SQLException.iterator()</code> can be used to walk over all exceptions in
the chain and their causes.</p>
</div>
<div class="paragraph">
<p>The JDBC specification provides an exception hierarchy that allows an application to
react on the error situations using regular exception handling rather than checking
the error code. Error codes may still be necessary for handling specific error cases.</p>
</div>
<div class="paragraph">
<p>The JDBC 4.3 specification defines the following exception hierarchy:<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.sql.SQLException</code> - root of all JDBC exceptions</p>
<div class="ulist">
<ul>
<li>
<p><code>java.sql.BatchUpdateException</code> - thrown when batch of the
statements did not execute successfully; contains the result of batch
execution.</p>
</li>
<li>
<p><code>java.sql.SQLClientInfoException</code> - thrown when client info properties
could not be set.</p>
</li>
<li>
<p><code>java.sql.SQLNonTransientException</code> - thrown when retrying the same action without fixing the
underlying cause would fail.</p>
<div class="ulist">
<ul>
<li>
<p><code>java.sql.SQLDataException</code> - thrown for data-related errors,
for example conversion errors, too long values. (SQLstate class <code>22</code>)</p>
</li>
<li>
<p><code>java.sql.SQLFeatureNotSupportedException</code> - thrown to indicate that an optional
JDBC feature is not supported by the driver or the data source (Firebird).  (SQLstate class <code>0A</code>)</p>
</li>
<li>
<p><code>java.sql.SQLIntegrityConstraintViolationException</code> - thrown for constraint
violations. (SQLstate class <code>23</code>)</p>
</li>
<li>
<p><code>java.sql.SQLInvalidAuthorizationSpecException</code> - thrown for authorization
failures. (SQLstate class <code>28</code>)</p>
</li>
<li>
<p><code>java.sql.NonTransientConnectionException</code> - thrown for connection operations
that will not succeed on retry without fixing the underlying cause. (SQLstate class <code>08</code>)</p>
</li>
<li>
<p><code>java.sql.SQLSyntaxErrorException</code> - thrown for syntax errors. (SQLstate class <code>42</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.sql.SQLRecoverableException</code> - thrown when an action might be retried
by taking recovery actions and restarting the transaction.</p>
</li>
<li>
<p><code>java.sql.SQLTransientException</code> - thrown when the action might succeed if it is
retried without further recovery steps.</p>
<div class="ulist">
<ul>
<li>
<p><code>java.sql.SQLTimeoutException</code> - thrown when the <code>queryTimeout</code> or
<code>loginTimeout</code> has expired.</p>
</li>
<li>
<p><code>java.sql.SQLTransactionRollbackException</code> - thrown when the statement was
automatically rolled back because of deadlock or other transaction serialization failures. (SQLstate class <code>40</code>)</p>
</li>
<li>
<p><code>java.sql.SQLTransientConnectionException</code> - thrown for connection operations
that might succeed on retry without any changes. (SQLstate class <code>08</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.sql.SQLWarning</code> should only be used to signal warnings, it should never be thrown
by a JDBC driver.</p>
<div class="ulist">
<ul>
<li>
<p><code>java.sql.DataTruncation</code> - thrown when a data truncation
error happens, can also be used as a warning.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unfortunately Jaybird 3.0 does not yet fully use this exception hierarchy, we are
working to address this with the next versions of Jaybird.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each of three layers in Jaybird use exceptions most appropriate to the
specific layer. <strong>TODO</strong> List needs revision</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.firebirdsql.gds.GDSException</code> is an exception that directly
corresponding to the error returned by the database engine. Instances of
this class are thrown by the GDS implementations. Upper layers either
convert these exceptions into the ones appropriate to that layer or
catch them if driver can handle the error condition.</p>
</li>
<li>
<p>Subclasses of <code>javax.resource.ResourceException</code> are thrown by the JCA
layer when an error happens in the JCA-related code. Upper layer
converts this exception into a subclass of <code>java.sql.SQLException</code>. If
the <code>ResourceException</code> was caused by the <code>GDSException</code>, latter is
extracted during conversion preserving the error code. If
<code>ResourceException</code> was caused by an error condition not related to an
error returned by the database engine, error code of the <code>SQLException</code>
remains 0.</p>
</li>
<li>
<p>Subclasses of <code>javax.transaction.XAException</code> are thrown when an XA
protocol error happens in JCA layer. Similar to the previous case,
<code>XAException</code> can wrap the <code>GDSException</code>, which are extracted during
exception conversion to preserve the error code.</p>
</li>
<li>
<p>Subclasses of <code>java.sql.SQLException</code> are thrown by the JDBC layer.
Jaybird has a few subclasses that might be interesting to the
application:</p>
<div class="ulist">
<ul>
<li>
<p><code>org.firebirdsql.jdbc.FBDriverConsistencyCheckException</code> – this
exception is thrown when driver detects an internal inconsistent state.
SQL state is <code>HY000</code>.</p>
</li>
<li>
<p><code>org.firebirdsql.jdbc.FBDriverNotCapableException</code> – this exception
is thrown when an unsupported method is called. SQL state is <code>0A000</code>.</p>
</li>
<li>
<p><code>org.firebirdsql.jdbc.FBSQLParseException</code> – this exception is thrown
when incorrect escaped syntax is detected. SQL state is <code>42000</code>.</p>
</li>
<li>
<p><code>org.firebirdsql.jdbc.field.TypeConversionException</code> – this exception
is thrown when the driver is asked to perform a type conversion that is
not defined in the JDBC specification. For a table of allowed type
conversions see <a href="#datatypeconversion">Data Type Conversion Table</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sql_states"><a class="anchor" href="#_sql_states"></a>3.4. SQL states</h3>
<div class="paragraph">
<p>Jaybird supports the SQLstate values from the SQL:2003 standard,<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>
however only few states nicely map into the Firebird error codes.</p>
</div>
<div class="paragraph">
<p>Applications can use the SQLstate codes in the error handling routines
which should handle errors that are returned from different databases.
But since there is little agreement between RDBMS vendors, this method
can be used only for very coarse error distinction.</p>
</div>
</div>
<div class="sect2">
<h3 id="_useful_firebird_error_codes"><a class="anchor" href="#_useful_firebird_error_codes"></a>3.5. Useful Firebird error codes</h3>
<div class="paragraph">
<p>Contrary to the SQLstates, the Firebird native error codes are
extremely useful to determine the type of an error that happened.</p>
</div>
<div class="paragraph">
<p>Here you can find a short list of error codes, symbolic names of a
corresponding constant in a <code>org.firebirdsql.gds.ISCConstants</code> class,
the error message and short explanation of an error.</p>
</div>
<div class="paragraph">
<p><strong>TODO</strong> Needs revising now Jaybird tries to pull the most important error code to the top</p>
</div>
<div class="sect3">
<h4 id="_ddl_errors"><a class="anchor" href="#_ddl_errors"></a>3.5.1. DDL Errors</h4>
<div class="paragraph">
<p>DDL errors happen during execution of DDL requests, and two primary error codes
are used in Firebird while executing the DDL operations. There are few
other rare cases not mentioned here, but the corresponding error
messages contain enough information to understand the reason of an
error.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544351L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_no_meta_update</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"unsuccessful metadata update"</code></p>
</div>
<div class="paragraph">
<p>This error is returned when the requested DDL operation cannot be completed, for
example the application tries to define a primary key that will exceed the
maximum allowed key size.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544510L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_lock_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In combination with <code>isc_obj_in_use</code>
(335544453L), this means that the DDL command tries to modify an object that
is used in some other place, usually in another transaction. The
complete error message will contain the name of the locked object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544569L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_dsql_error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the third error code is either
<code>isc_dsql_datatype_err</code> or <code>isc_dsql_command_err</code>, then additional error
codes and arguments specify the reason why the operation has failed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_lock_errors"><a class="anchor" href="#_lock_errors"></a>3.5.2. Lock Errors</h4>
<div class="paragraph">
<p>Lock errors are reported by Firebird primarily when the application tries to
modify a record which is already modified by a concurrent transaction.
Depending on the transaction parameters such error can be reported
either right after detection or after waiting some defined timeout
hoping that concurrent transaction will either commit or rollback and
eventually release the resource. More information on transaction locking
modes can be found in section <a href="#transactions">Using transactions</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544345L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_lock_conflict</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"lock conflict on no wait transaction"</code></p>
</div>
<div class="paragraph">
<p>This error is returned when a "no wait" transaction needs to acquire a lock
but finds another concurrent transaction holding that lock.</p>
</div>
<div class="paragraph">
<p>Instead of waiting the predefined timeout hoping that concurrent
transaction will either commit or rollback, an error is returned to
notify an application about the situation.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544510L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_lock_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"lock time-out on wait transaction"</code></p>
</div>
<div class="paragraph">
<p>Similar to the <code>isc_lock_conflict</code>, but this error is returned when the lock timeout that
was specified for the current transaction expired while waiting for a lock.</p>
</div>
<div class="paragraph">
<p>Another source of this error are DDL operations that try to obtain a
lock on a database object that is currently used in some other place.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544336L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_deadlock</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"deadlock"</code></p>
</div>
<div class="paragraph">
<p>Two transactions experience a deadlock when each of them has a lock on a
resource on which the other is trying to obtain a lock.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_referential_integrity_errors"><a class="anchor" href="#_referential_integrity_errors"></a>3.5.3. Referential Integrity Errors</h4>
<div class="paragraph">
<p>Referential integrity constraints ensure that the database remains in a
consistent state after the DML operation and/or whole transaction is
completed. Three primary error codes are returned when the defined
constraints are violated. The error messages are self-explanatory.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544665L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_unique_key_violation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>violation of PRIMARY or UNIQUE KEY constraint "{0}" on table "{1}"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544558L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_check_constraint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Operation violates CHECK constraint {0} on view or table {1}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544466L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_foreign_key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>violation of FOREIGN KEY constraint "{0}" on table "{1}"</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dsql_errors"><a class="anchor" href="#_dsql_errors"></a>3.5.4. DSQL Errors</h4>
<div class="paragraph">
<p>This group contains secondary codes for the primary error code
<code>isc_dsql_error</code> (<code>335544569L</code>), that has a message
<code>"Dynamic SQL Error"</code>.</p>
</div>
<div class="paragraph">
<p>In most situations, Jaybird 3 and higher will put this secondary error code in the
<code>SQLException</code> instead of <code>isc_dsql_error</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544573L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_dsql_datatype_err</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"Data type unknown"</code></p>
</div>
<div class="paragraph">
<p>Usually this error is reported during DDL operation when the specified
data type is either unknown or cannot be used in the specified
statement. However it can also happen in DML operation, e.g. when an
<code>ORDER BY</code> clause contains unknown collation, or if a parameter is used
in a <code>SELECT</code> clause without explicit cast.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544570L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_dsql_command_err</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"Invalid command"</code></p>
</div>
<div class="paragraph">
<p>Error happens either during parsing the specified SQL request or by
handling the DDL command.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_other_errors"><a class="anchor" href="#_other_errors"></a>3.5.5. Other Errors</h4>
<div class="paragraph">
<p>This table contains other errors that might be interesting to the
application developer, however they do not fall into any of the previous
categories.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544321L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_arith_except</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"arithmetic exception, numeric overflow, or string truncation"</code></p>
</div>
<div class="paragraph">
<p>Happens at runtime when an arithmetic exception happens, like division
by zero or the numeric overflow (e.g. number does not fit the 64 bits
limit).</p>
</div>
<div class="paragraph">
<p>Another source of this error are string operations, like string
concatenation producing a too long string, impossibility to transliterate
characters between character sets, etc.</p>
</div>
<div class="paragraph">
<p>Future versions of Firebird will provide a secondary code to distinguish
the exact reason of an error.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544348L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_no_cur_rec</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"no current record for fetch operation"</code></p>
</div>
<div class="paragraph">
<p>Happens when the application asks Firebird to fetch a record, but no record
is available for fetching.</p>
</div>
<div class="paragraph">
<p>Java applications should never get this error, since checks in the JDBC
driver should prevent the application from executing a fetch operation on the server
side.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544374L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_stream_eof</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"attempt to fetch past the last record in a record stream"</code></p>
</div>
<div class="paragraph">
<p>Application tries to execute fetch operation after all records have
already been fetched.</p>
</div>
<div class="paragraph">
<p>Similar to the previous error, Java applications should not get this
error due to the checks that happen before issuing the fetch request to
the server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544517L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_except</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>"exception {0}"</code></p>
</div>
<div class="paragraph">
<p>An custom exception has been raised on the server. Java application can
examine the underlying GDSException to extract the exception message.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">335544721L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isc_network_error</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Unable to complete network request to host "{0}"</code></p>
</div>
<div class="paragraph">
<p>This error is thrown when Jaybird cannot establish a connection
to the database server due to a network issues, e.g. host name is
specified incorrectly, Firebird has not been started on the remote host,
firewall configuration prevents client from establishing the connection,
etc.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="statements"><a class="anchor" href="#statements"></a>4. Executing statements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After obtaining a connection, the next thing to do is to execute an SQL
statement. The JDBC specification distinguishes three kinds of statements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Regular statements to execute fixed SQL requests,</p>
</li>
<li>
<p>prepared statements to execute SQL code with parameters,</p>
</li>
<li>
<p>and callable statements to execute stored procedures.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_the_java_sql_statement_interface"><a class="anchor" href="#_the_java_sql_statement_interface"></a>4.1. The java.sql.Statement interface</h3>
<div class="paragraph">
<p>The <code>java.sql.Statement</code> interface is the simplest interface to execute
SQL statements. It distinguishes three types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>statements that return results, or, in other words, queries;</p>
</li>
<li>
<p>statements that change the state of the database but return no results;</p>
</li>
<li>
<p><code>INSERT</code> statements (or other statements with similar behaviour) that return the values of the
columns which were generated by the database engine while inserting the record.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s check one of the typical usages shown below. In general the usage
pattern of the statement consists of three steps</p>
</div>
<div class="listingblock">
<div class="title">Typical way to execute query to get information about the user</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement(); <i class="conum" data-value="1"></i><b>(1)</b>
     ResultSet rs = stmt.executeQuery(
         "SELECT firstName, lastName FROM users" +
         " WHERE userId = 5") <i class="conum" data-value="2"></i><b>(2)</b>
){
  if (rs.next()) {
    String firstName = rs.getString(1);
    String lastName = rs.getString(2);
  }
} <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a <code>Statement</code> object by calling the
<code>createStatement()</code> method of the <code>Connection</code> object.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use the Statement object by calling its methods, in our
case we execute a simple query
<code>SELECT firstName, lastName FROM users WHERE userId = 5</code>. Processing of the query result will be discussed in details in <a href="#resultsets">Working with result sets</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Close the result set and statement to release all allocated resources. In
our example this is done using the try-with-resources block. With try-with-resources.
Java takes care of closing resources in the right order, even if exceptions occur, or
if a resource was not allocated (say, if <code>executeQuery</code> throws an exception).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As the connection object is the factory for the statement objects, this
puts a constraint on the object lifetime: statements are bound to the
connection; when the connection is closed, all statements that were
created by that connection become invalid and the resources allocated by
them are released. However, despite that these resources are
released when the connection closes, it is strongly recommended to use the try-with-resources
block, to guarantee that resources are released as soon as possible
because of reasons that will be discussed later.</p>
</div>
<div class="paragraph">
<p>A statement can be executed using the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Statement.executeQuery(String)</code> – executes a SELECT statement and
returns a result set. If the specified statement does not produce a result set,
an <code>SQLException</code> is thrown after statement execution.</p>
</li>
<li>
<p><code>Statement.executeUpdate(String)</code> – executes INSERT, UPDATE, DELETE or
DDL<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup> statements and returns the
number of updated rows. If the specified statement is a query, an
<code>SQLException</code> is thrown.</p>
</li>
<li>
<p><code>Statement.execute(String)</code> – executes a statement and returns <code>true</code>
when the statement returned a result set, otherwise an update was
executed and <code>false</code> is returned. You can use <code>Statement.getResultSet()</code>
method to get the result of the executed query or you can use
<code>Statement.getUpdateCount()</code> when you have executed update statement.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These <code>execute</code> methods have several variants for additional features covered
later (<strong>TODO</strong> check if already covered).</p>
</div>
<div class="paragraph">
<p>A statement is closed by calling the <code>Statement.close()</code> method, or by using
a try-with-resources which calls <code>close()</code> behind the scenes. After
a close, the statement object is invalid and cannot be used any more.</p>
</div>
<div class="paragraph">
<p>It is allowed to use the same statement object to execute different types of
queries one after other. The code below contains a short example
which first performs a select to find the ID of the user
'Joe Doe', and if the record is found, it enables his account.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The concatenation of values into a query string as done in this example is not a good practice as it
can leave your code vulnerable to SQL injection.</p>
</div>
<div class="paragraph">
<p>In this specific case it is safe to do as the values are integers. In general: don&#8217;t do this, use a
prepared statement instead.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Using the same statement object multiple times to enable user account</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement();
     ResultSet rs = stmt.executeQuery(
         "SELECT userId FROM users " +
         "WHERE lastName = 'Doe' AND firstName = 'Joe'")) {
  if (rs.next()) {
    int userId = rs.getInt(1);

    int rowsUpdated = stmt.executeUpdate(
        "UPDATE accounts SET accountEnabled = 1 " +
        "WHERE userId = " + userId);

    if (rowsUpdated == 0)
      rowsUpdated = stmt.executeUpdate(
          "INSERT INTO accounts (userId, enabled) " +
          "VALUES (" + userId + ", 1)");

    if (rowsUpdated != 1)
      throw new SomeException(
          "User was not updated correctly.");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The way the code is constructed is quite tricky because of the result
set lifetime constraints that are defined by the JDBC specification, please
read the chapter <a href="#resultsets">Working with result sets</a> for more details.</p>
</div>
<div class="paragraph">
<p>However, here it is done intentionally to emphasize that a single
object is used to execute <code>SELECT</code> and <code>UPDATE</code>/<code>INSERT</code> statements. It also
shows how to check whether the executed statement modified expected
number of rows – the application first tries to update the account and only
if no rows were updated, it inserts new record into the <code>accounts</code>
table.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This example of 'try update, then insert' approach can be better handled
using <a href="https://www.firebirdsql.org/file/documentation/reference_manuals/fblangref25-en/html/fblangref25-dml-merge.html" target="_blank" rel="noopener"><code>MERGE</code></a>
or <a href="https://www.firebirdsql.org/file/documentation/reference_manuals/fblangref25-en/html/fblangref25-dml-update-or-insert.html" target="_blank" rel="noopener"><code>UPDATE OR INSERT</code></a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an application needs to execute DDL statements, it is recommended to
use the <code>Statement.execute(String)</code> method, as in this case the amount of
modified records makes little sense. The next example shows the
creation of database tables using this method.</p>
</div>
<div class="listingblock">
<div class="title">Example of creating database tables</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement()) {
  stmt.execute("CREATE TABLE customer(" +
      "customerId INTEGER NOT NULL PRIMARY KEY, " +
      "firstName VARCHAR(20) NOT NULL, " +
      "lastName VARCHAR(40) NOT NULL)");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned earlier, the <code>Statement.execute(String)</code> method can
also be used to execute statements of an unknown type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement()) {
  boolean hasResultSet = stmt.execute(sql);
  if (hasResultSet) {
    ResultSet rs = stmt.getResultSet();
    ...
  } else {
    int updateCount = stmt.getUpdateCount();
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is worth mentioning, that according to the JDBC specification
<code>getResultSet()</code> and <code>getUpdateCount()</code> methods can be only called once
per result, and in case of using Firebird, that means once per executed
statement, since Firebird does not support multiple results from a
single statement. Calling the methods the second time will cause an
exception.</p>
</div>
</div>
<div class="sect2">
<h3 id="_statement_behind_the_scenes"><a class="anchor" href="#_statement_behind_the_scenes"></a>4.2. Statement behind the scenes</h3>
<div class="paragraph">
<p>The previous examples requires us to discuss the statement object
dynamics, its life cycle and how it affects other subsystems in details.</p>
</div>
<div class="sect3">
<h4 id="_statement_dynamics"><a class="anchor" href="#_statement_dynamics"></a>4.2.1. Statement dynamics</h4>
<div class="paragraph">
<p>When a Java application executes a statement, a lot more operations
happen behind the scenes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A new statement object is allocated on the server. Firebird returns
a 32-bit identifier of the allocated object, a statement
handle, that must be used in next operations.</p>
</li>
<li>
<p>An SQL statement is compiled into an executable form and is
associated with the specified statement handle.</p>
</li>
<li>
<p>Jaybird asks the server to describe the statement and Firebird returns
information about the statement type and possible statement input
parameters (we will discuss this with prepared statements) and output
parameters, namely the result set columns.</p>
</li>
<li>
<p>If no parameters are required for the statement, Jaybird tells
Firebird to execute statement passing the statement handle into
corresponding method.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After this Jaybird has to make a decision depending on the operation
that was called.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>Statement.execute()</code> was used, Jaybird only checks the
statement type to decide whether it should return true, telling the
application that there is a result set for this operation, or false, if
statement did not return any result set.</p>
</li>
<li>
<p>If <code>Statement.executeUpdate()</code> was called, Jaybird asks Firebird
to give the information about the number of affected rows. This method
can be called only if the statement type tells that no result set can be
returned by the statement.</p>
<div class="paragraph">
<p>When called for queries, an exception
is thrown despite the fact that the statement was successfully executed
on the server.</p>
</div>
</li>
<li>
<p>If <code>Statement.executeQuery()</code> was called and the statement type
indicates that a result set can be returned, Jaybird constructs a <code>ResultSet</code>
object and returns it to the application. No additional checks, like
whether the result set contains rows, are performed, as it is the
responsibility of the <code>ResultSet</code> object.</p>
<div class="paragraph">
<p>If this method is used for statements that do not return result set, an exception is thrown despite
the fact that the statement was successfully executed on the server.</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The described behaviour may change in the future by throwing the exception
<strong>before</strong> executing the statement.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an application does not need to know how many rows were modified,
it should use the <code>execute()</code> method instead of <code>executeUpdate()</code>.
This saves an additional call to the server to get the number of modified
rows which can increase the performance in the situations where
network latency is comparable with the statement execution times.</p>
</div>
<div class="paragraph">
<p>The <code>execute()</code> method is also the only method that can be used when the
application does not know what kind of statement is being executed (for
example, an application that allows the user to enter SQL statements to
execute).</p>
</div>
<div class="paragraph">
<p>After using the statement object, an application should close it. Two
different possibilities exist: to close the result set object
associated with the statement handle and to close the statement completely.</p>
</div>
<div class="paragraph">
<p>If, for example, we want to reuse the statement object for another
query, it is not necessary to completely release the allocated
structures. Jaybird is required only to compile a new statement before
using it, in other words we can skip step 1. This saves us one
round-trip to the server over the network, which might improve the
application performance.</p>
</div>
<div class="paragraph">
<p>If we close the statement completely, the allocated statement handle is
no longer usable. Jaybird could allocate a new statement handle, however
the JDBC specification does not allow use of a <code>Statement</code> object after
<code>close()</code> method has been called.</p>
</div>
</div>
<div class="sect3">
<h4 id="_statement_lifetime_and_ddl"><a class="anchor" href="#_statement_lifetime_and_ddl"></a>4.2.2. Statement lifetime and DDL</h4>
<div class="paragraph">
<p>Step 2 in the previous section is probably the most important, and
usually, most expensive part of the statement execution life cycle.</p>
</div>
<div class="paragraph">
<p>When Firebird server receives the "prepare
statement" call, it parses the SQL statement and converts it into the
executable form: BLR. BLR, or Binary Language Representation, contains
low-level commands to traverse the database tables, conditions that are used
to filter records, defines the order in which records are accessed, indices
that are used to improve the performance, etc.</p>
</div>
<div class="paragraph">
<p>When a statement is prepared, it holds the references to all database object
definitions that are used during that statement execution. This
mechanism preserves the database schema consistency, it saves the
statement objects from "surprises" like accessing a database table
that has been removed by another application.</p>
</div>
<div class="paragraph">
<p>However, holding a reference on the database objects has one very
unpleasant effect: it is not possible to upgrade the database schema,
if there are active connections to the database with open statements
referencing the objects being upgraded. In other words, if two
application are running and one is trying to modify the table, view,
procedure or trigger definition while another one is accessing those
objects, the first application will receive an error 335544453 "object
is in use".</p>
</div>
<div class="paragraph">
<p>Therefore it is strongly recommended to close the statement as soon as
it is no longer needed. This invalidates the BLR and release all
references to the database objects, making them available for the
modification.</p>
</div>
<div class="paragraph">
<p>Special care should be taken when the statement pooling is used. In that case statements are not
released even if the <code>close()</code> method is called. The only possibility to close the pooled
statements is to close the pooled connections. Please check the
documentation of your connection pool for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_java_sql_preparedstatement_interface"><a class="anchor" href="#_the_java_sql_preparedstatement_interface"></a>4.3. The java.sql.PreparedStatement interface</h3>
<div class="paragraph">
<p>As we have seen, Jaybird already performs internal optimization when it
comes to multiple statement execution – it can reuse the allocated
statement handle in subsequent calls. However this improvement is very
small and sometimes can even be neglible compared to the time
needed to compile the SQL statement into the BLR form.</p>
</div>
<div class="paragraph">
<p>The <code>PreparedStatement</code> interface addresses such inefficiencies. An object
that implements this interface represents a precompiled statement that
can be executed multiple times. If we use the execution flow described
in the "<a href="#_statement_dynamics">Statement dynamics</a>" section, it allows us
to go directly to the step 4 for repeated executions.</p>
</div>
<div class="paragraph">
<p>However, executing the same statement with the same values makes little
sense, unless we want to fill the table with the same data, which
usually is not the case. Therefore, JDBC provides support for
parametrized statements – SQL statements where literals are replaced
with question marks (<code>?</code>), so called positional parameters. The application then assigns values to
the parameters before executing the statement.</p>
</div>
<div class="paragraph">
<p>Our first example in this chapter can be rewritten as shown below. At first glance the code becomes
more complicated without any visible advantage.</p>
</div>
<div class="listingblock">
<div class="title">Example for user account update rewritten using prepared statements</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (PreparedStatement stmt1 = connection.prepareStatement(
         "SELECT userId FROM users WHERE " +
         "lastName = ? AND firstName = ?")) {
  stmt1.setString(1, "Doe");
  stmt1.setString(2, "Joe");
  try (ResultSet rs = stmt1.executeQuery()) {

    if (rs.next()) {
      int userId = rs.getInt(1);

      try (PreparedStatement stmt2 =
               connection.prepareStatement(
                   "UPDATE accounts SET accountEnabled = 1 " +
                   "WHERE userId = ?" )) {
        stmt2.setInt(1, userId);

        int rowsUpdated = stmt2.executeUpdate();

        if (rowsUpdated == 0) {
          try (PreparedStatement stmt3 =
                   connection.prepareStatement(
                       "INSERT INTO accounts " +
                       "(userId, enabled) VALUES (?, 1)")) {
            stmt3.setInt(1, userId);
            rowsUpdated = stmt3.executeUpdate();
          }
        }
        if (rowsUpdated != 1)
          throw new SomeException(
              "User was not updated correctly.");
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>First, instead of using just one statement object we have to use three
– one per statement.</p>
</li>
<li>
<p>Second, before executing the statement we have to set parameters
first. As is shown in the example, parameters are referenced by
their position. The <code>PreparedStatement</code> interface provides setter
methods for all primitive types in Java as well as for some widely used
SQL data types (BLOBs, CLOBs, etc.). The <code>NULL</code> value is set by calling
the <code>PreparedStatement.setNull(int)</code> method.</p>
</li>
<li>
<p>Third, we are now forced to use four nested try-with-resources blocks,
which makes code less readable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So, where&#8217;s the advantage? First of all, prepared statements parameters protect against SQL
injection as the values are sent separately from the statement itself. It is not possible to change
the meaning of a statement due to incorrect string concatenation, so data leaks or other problems
cause by SQL injection can be avoided. Second of all, the driver handles conversion of Java object
types to the correct format for the target datatype in Firebird: you don&#8217;t need to convert a Java
value to the correct string literal format for Firebirds SQL dialect.</p>
</div>
<div class="paragraph">
<p>And to address some of the identified problems, we can redesign our application
to prepare those statements before calling that code (for example in a
constructor) and close them when application is shut down. In this case
the code is even more compact (see the next example). Unfortunately the
application is now responsible for prepared statement management. When
a connection is closed, the prepared statement object will be invalidated,
but the application will not be notified. Also, if the
application uses similar statements in different parts of the
application, the refactoring might affect many classes, possibly
destabilizing the code. So, the refactoring on this example is not
something we want to do.</p>
</div>
<div class="listingblock">
<div class="title">Rewritten example to let application manage prepared statements</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">// prepared statement management
PreparedStatement queryStmt =
    connection.prepareStatement(queryStr);
PreparedStatement updateStmt =
    connection.prepareStatement(updateStr);
PreparedStatement insertStmt =
    connection.prepareStatement(insertStr);

......................

// query management
queryStmt.clearParameters();
queryStmt.setString(1, "Doe");
queryStmt.setString(2, "Joe");
try (ResultSet rs = queryStmt.executeQuery()) {
  if (rs.next()) {
    int userId = rs.getInt(1);

    updateStmt.clearParameters();
    updateStmt.setInt(1, userId);
    int rowsUpdated = updateStmt.executeUpdate();

    if (rowsUpdated == 0) {
      insertStmt.clearParameters();
      insertStmt.setInt(1, userId);
      rowsUpdated = insertStmt.executeUpdate();
    }

    if (rowsUpdated != 1)
      throw new SomeException(
          "User was not updated correctly.");
  }
}
......................

// prepared statement cleanup
insertStmt.close();
updateStmt.close();
queryStmt.close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The answer to the advantage question is hidden in the
<code>prepareStatement(String)</code> call. Since the same statement can be used
for different parameter values, the connection object could have a possibility to
perform prepared statement caching. A JDBC driver can ignore the request
to close the prepared statement, save it internally and reuse it each
time application asks to prepare an SQL statement that is known to the
connection.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Jaybird currently does not perform statement caching
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="callable-statement"><a class="anchor" href="#callable-statement"></a>4.4. The java.sql.CallableStatement interface</h3>
<div class="paragraph">
<p>The <code>CallableStatement</code> interface extends <code>PreparedStatement</code> with
methods for executing and retrieving results from stored procedures. It
was introduced in JDBC specification in order to unify access to the
stored procedures across the database system. The main difference to
<code>PreparedStatement</code> is that the procedure call is specified using the
portable escaped syntax:<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></p>
</div>
<div class="literalblock">
<div class="title">Unified escaped syntax for stored procedure execution</div>
<div class="content">
<pre>procedure call ::= {[?=]call &lt;procedure-name&gt;(&lt;params&gt;)}
params ::= &lt;param&gt; [, &lt;param&gt; ...]</pre>
</div>
</div>
<div class="paragraph">
<p>Each stored procedure is allowed to take zero or more input parameters,
similar to the <code>PreparedStatement</code> interface. After being executed,
a procedure can either return data in the output parameters or it can
return a result set that can be traversed. Though the interface is
generic enough to support database engines that can return both and
have multiple result sets. These features are of no interest to Jaybird
users, since Firebird does not support them.</p>
</div>
<div class="paragraph">
<p>The IN and OUT parameters are specified in one statement. The syntax
above does not allow to specify the type of the parameter, therefore
additional facilities are needed to tell the driver which parameter is
will contain output values, the rest are considered to be IN parameters.</p>
</div>
<div class="sect3">
<h4 id="_firebird_stored_procedures"><a class="anchor" href="#_firebird_stored_procedures"></a>4.4.1. Firebird stored procedures</h4>
<div class="paragraph">
<p>Firebird stored procedures represent a piece of code written in the PSQL
language that allows SQL statement execution at the native speed of the
engine and provides capabilities for a limited execution flow control.
The PSQL language is not general purpose language therefore its
capabilities are limited when it comes to interaction with other
systems.</p>
</div>
<div class="paragraph">
<p>Firebird stored procedures can be classified as follow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Procedures that do not return any results. These are stored procedures
that do not contain the <code>RETURNS</code> keyword in their header.</p>
</li>
<li>
<p>Procedures that return only a single row of results. These are stored
procedures that contain the <code>RETURNS</code> keyword in their header, but do not
contain the <code>SUSPEND</code> keyword in their procedure body. These procedures
can be viewed as functions that return multiple values. These
procedures are executed by using the <code>EXECUTE PROCEDURE</code> statement.</p>
</li>
<li>
<p>Procedures that return a result set, also called "selectable stored
procedures". These are stored procedures that contain the <code>RETURNS</code>
keyword in their header and the <code>SUSPEND</code> keyword in their procedure body,
usually within a loop. Selectable procedures are executed using the
<code>"SELECT * FROM myProcedure(&#8230;&#8203;)"</code> SQL statement. It is also allowed to
use the <code>EXECUTE PROCEDURE</code> statement, however that might produce strange
results, since for selectable procedures is is equivalent to executing a
<code>SELECT</code> statement, but doing only one fetch after the select. If
the procedure implementation relies on the fact that all rows that it
returns must be fetched, the logic will be broken.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Consider the following stored procedure that returns factorial of the
specified number.</p>
</div>
<div class="listingblock">
<div class="title">Source code for the procedure that multiplies two integers</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">CREATE PROCEDURE factorial(
  max_value INTEGER
) RETURNS (
  factorial INTEGER
) AS
  DECLARE VARIABLE temp INTEGER;
  DECLARE VARIABLE counter INTEGER;
BEGIN
  counter = 0;
  temp = 1;
  WHILE (counter &lt;= max_value) DO BEGIN
    IF (counter = 0) THEN
      temp = 1;
    ELSE
      temp = temp * row_num;
    counter = counter + 1;
  END
END</code></pre>
</div>
</div>
<div class="paragraph">
<p>This procedure can be executed using the EXECUTE PROCEDURE call. When it
is done in isql, the output looks as follow</p>
</div>
<div class="literalblock">
<div class="title">Output of the EXECUTE PROCEDURE call in isql</div>
<div class="content">
<pre>SQL&gt; EXECUTE PROCEDURE factorial(5);

   FACTORIAL
============
         120</pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s modify this procedure to return each intermediate result to the client.</p>
</div>
<div class="listingblock">
<div class="title">Modified procedure that returns each intermediate result</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">CREATE PROCEDURE factorial(
  max_value INTEGER
) RETURNS (
  row_num INTEGER,
  factorial INTEGER
) AS
  DECLARE VARIABLE temp INTEGER;
  DECLARE VARIABLE counter INTEGER;
BEGIN
  counter = 0;
  temp = 1;
  WHILE (counter &lt;= max_value) DO BEGIN
    IF (row_num = 0) THEN
      temp = 1;
    ELSE
      temp = temp * row_num;
    factorial = temp;
    row_num = counter;
    counter = counter + 1;
    SUSPEND;
  END
END</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you create this procedure using the isql command line tool and then
issue the <code>"SELECT * FROM test_selectable(5)"</code> statement, the output
will be like this:</p>
</div>
<div class="literalblock">
<div class="title">Output of the modified procedure</div>
<div class="content">
<pre>SQL&gt; SELECT * FROM factorial(5);

     ROW_NUM    FACTORIAL
============ ============
           0            1
           1            1
           2            2
           3            6
           4           24
           5          120</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_callablestatement"><a class="anchor" href="#_using_the_callablestatement"></a>4.4.2. Using the CallableStatement</h4>
<div class="paragraph">
<p>Let&#8217;s see how the procedures defined above can be accessed from Java.</p>
</div>
<div class="paragraph">
<p>First, we can execute this procedure from the first example in the
previous section using the EXECUTE PROCEDURE statement and
<code>PreparedStatement</code>, however this approach requires some more code for
result set handling.</p>
</div>
<div class="listingblock">
<div class="title">Example of using the PreparedStatement to call executable procedure</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (PreparedStatement stmt = connection.prepareStatement(
         "EXECUTE PROCEDURE factorial(?)")) {

  stmt.setInt(1, 2);

  try (ResultSet rs = stmt.executeQuery()) {
    rs.next(); // move cursor to the first row

    int result = rs.getInt(1);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the standard for calling stored procedures in JDBC is to use the
<code>CallableStatement</code>. The call can be specified using the
escaped syntax, but native Firebird <code>EXECUTE PROCEDURE</code> syntax is also
supported.</p>
</div>
<div class="listingblock">
<div class="title">Accessing the executable procedure via CallableStatement</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (CallableStatement stmt = connection.prepareCall(
         "{call factorial(?,?)}")) {

  stmt.setInt(1, 2);
  stmt.registerOutParameter(2, Types.INTEGER);

  stmt.execute();

  int result = stmt.getInt(2);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note the difference in the number of parameters used in the
examples. The first example contained only IN parameter on position 1
and the OUT parameter was returned in the <code>ResultSet</code> on the first
position, so it was accessed via index 1.</p>
</div>
<div class="paragraph">
<p>The latter example additionally contains the OUT parameter in the call.
We have used the <code>CallableStatement.registerOutParameter</code> method to tell
the driver that the second parameter in our call is an OUT parameter of
type INTEGER. Parameters that were not marked as OUT are considered by
Jaybird as IN parameters. Finally the <code>"EXECUTE PROCEDURE factorial(?)"</code>
SQL statement is prepared and executed. After executing the procedure
call we get the result from the appropriate getter method.</p>
</div>
<div class="paragraph">
<p>It is worth mentioning that the stored procedure call preparation
happens in the <code>CallableStatement.execute</code> method, and not in the
<code>prepareCall</code> method of the <code>Connection</code> object. Reason for this
deviation from the specification is that Firebird does not
allow to prepare a procedure without specifying parameters and set them
only after the statement is prepared. It seems that this part of the
JDBC specification is modelled after the Oracle RDBMS and a workaround
for this issue had to be delivered. Another side effect of this issue
is, that it is allowed to intermix input and output parameters, for
example in the "IN, OUT, IN, OUT, OUT, IN" order. Not that it makes much
sense to do this, but it might help in some cases when porting
applications from another database server.</p>
</div>
<div class="paragraph">
<p>It is also allowed to use a procedure call parameter both as an input
and output parameter. It is recommended to use this only when porting
applications from the database servers that allow INOUT parameter types,
such as Oracle.</p>
</div>
<div class="paragraph">
<p>The actual stored procedure call using the <code>CallableStatement</code> is
equivalent to the call using the prepared statement as shown in
the first example. There is no measurable performance differences when
using the callable statement interface.</p>
</div>
<div class="paragraph">
<p>The JDBC specification allows another syntax for the stored procedure calls:</p>
</div>
<div class="listingblock">
<div class="title">Calling stored procedure using different syntax</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (CallableStatement stmt = connection.prepareCall(
         "{?= call factorial(?}")) {

  stmt.registerOutParameter(1, Types.INTEGER);
  stmt.setInt(2, 2);

  stmt.execute();

  int result = stmt.getInt(1);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, that input parameter now has index 2, and not 1 as
in the previous example. This syntax seems to be more intuitive, as it
looks like a function call. It is possible to use this syntax for
stored procedures that return more than one parameter by combining code
from the second and the last examples.</p>
</div>
<div class="paragraph">
<p>Firebird stored procedures can also return result sets. This is achieved
by using the SUSPEND keyword inside the procedure body. This keyword
returns the current values of the output parameters as a single row to
the client.</p>
</div>
<div class="paragraph">
<p>The following example is more complex and shows a stored procedure that
computes a set of factorial of the numbers up to the specified number of
rows.</p>
</div>
<div class="paragraph">
<p>The SELECT SQL statement is the natural way of accessing the selectable
procedures in Firebird. You "select" from such procedures using the
<code>Statement</code> or <code>PreparedStatement</code> objects.</p>
</div>
<div class="paragraph">
<p>With minor issues it is also possible to access selectable stored
procedures through the <code>CallableStatement</code> interface. The escaped call
must include all IN and OUT parameters. After the call is prepared,
parameters are set the same way. However, the application must explicitly
tell the driver that selectable procedure is used and access to the
result set is desired. This is done by calling a Jaybird-specific method
as shown in the example below. When this is not done, the application has
access only to the first row of the result set. <strong>TODO</strong> Outdated?</p>
</div>
<div class="paragraph">
<p>The getter methods from the <code>CallableStatement</code> interface will provide
you access only to the first row of the result set. In order to get
access to the complete result set you have to either call the
<code>executeQuery</code> method or the <code>execute</code> method followed by <code>getResultSet</code>
method.</p>
</div>
<div class="listingblock">
<div class="title">Example of using selectable stored procedure via escaped syntax</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import java.sql.*;
import org.firebirdsql.jdbc.*;
...
try (CallableStatement stmt = connection.prepareCall(
         "{call factorial(?, ?, ?)}")) {

  FirebirdCallableStatement fbStmt =
      (FirebirdCallableStatement)stmt;
  fbStmt.setSelectableProcedure(true);

  stmt.setInt(1, 5);
  stmt.registerOutParameter(2, Types.INTEGER); // first OUT
  stmt.registerOutParameter(3, Types.INTEGER); // second OUT

  try (ResultSet rs = stmt.executeQuery()) {

    while(rs.next()) {
      int firstCol = rs.getInt(1);             // first OUT
      int secondCol = rs.getInt(2);            // second OUT
      int anotherSecondCol = stmt.getInt(3);   // second OUT
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that OUT parameter positions differ when they are accessed through
the <code>ResultSet</code> interface (the <code>firstCol</code> and <code>secondCol</code> variables in
our example). They are numbered in the order of their appearance in the
procedure call starting with 1.</p>
</div>
<div class="paragraph">
<p>When OUT parameter is accessed through the <code>CallableStatement</code> interface
(the <code>anotherSecondCol</code> parameter in our example), the registered
position should be used. In this case the result set can be used for
navigation only.</p>
</div>
</div>
<div class="sect3">
<h4 id="_describing_output_and_input_parameters"><a class="anchor" href="#_describing_output_and_input_parameters"></a>4.4.3. Describing Output and Input Parameters</h4>
<div class="paragraph">
<p>The <code>PreparedStatement.getMetaData</code> method is used to obtain description
of the columns that will be returned by the prepared SELECT statement.
The method returns an instance of <code>java.sql.ResultSetMetaData</code> interface
that among other descriptions provides the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>column type, name of the type, its scale and precision if relevant;</p>
</li>
<li>
<p>column name, its label and the display size;</p>
</li>
<li>
<p>name of the table, to which this column belongs;</p>
</li>
<li>
<p>information whether the column is read-only or writable, whether it
contains signed numbers, whether it can contains NULL values, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, the JDBC 3.0 specification introduced the interface
<code>java.sql.ParameterMetaData</code> that provides similar information for the
input parameters of both <code>PreparedStatement</code> and <code>CallableStatement</code>
objects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Due to the implementation specifics of the escaped syntax support
for callable statements, it is not allowed to call
<code>getParameterMetaData</code> before all OUT parameters are registered.
Otherwise the driver will try to prepare a procedure with an incorrect
number of parameters and the database server will generate an error.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_updates"><a class="anchor" href="#_batch_updates"></a>4.5. Batch Updates</h3>
<div class="paragraph">
<p>Batch updates are intended to group multiple update operations to be
submitted to a database server to be processed at once. Firebird does
not provide support for such functionality<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup>,
but Jaybird emulates it by issuing separate update commands.</p>
</div>
<div class="sect3">
<h4 id="_batch_updates_with_java_sql_statement_interface"><a class="anchor" href="#_batch_updates_with_java_sql_statement_interface"></a>4.5.1. Batch Updates with java.sql.Statement interface</h4>
<div class="paragraph">
<p>The <code>Statement</code> interface defines three methods for batch updates:
<code>addBatch</code>, <code>executeBatch</code> and <code>clearBatch</code>. It is allowed to add
arbitrary INSERT/UPDATE/DELETE or DDL statement to the batch group.
Adding a statement that returns result set is an error.</p>
</div>
<div class="listingblock">
<div class="title">Example of batch updates using Statement object</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement()) {

  stmt.addBatch("UPDATE products " +
      "SET amount = amount – 1 WHERE id = 1");
  stmt.addBatch("INSERT INTO orders(id, amount) VALUES(1, 1)");

  int[] updateCounts = stmt.executeBatch();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JDBC specification recommends to turn the auto-commit mode off to
guarantee standard behavior for all databases. The specification
explicitly states that behavior in auto-commit case is implementation
defined.</p>
</div>
<div class="paragraph">
<p>In auto-commit mode, Jaybird executes a batch in a single transaction, i.e. the
"all-or-nothing" principle. A new transaction is started before the
batch execution and is committed if there were no exceptions during batch
execution, or is rolled back if at least one batch command generated an
error.</p>
</div>
<div class="paragraph">
<p>The <code>Statement.executeBatch</code> method submits the job to the database
server. In case of successful execution of the complete batch, it
returns an array of integers containing update counts for each of the
commands. Possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0 or positive value – an update count for the corresponding update/DDL
statement.</p>
</li>
<li>
<p><code>Statement.SUCCESS_NO_INFO</code> – driver does not have any information
about the update count, but it knows that statement was executed
successfully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>Statement.executeBatch</code> method closes the current result set if one
is open. After successful execution the batch is cleared. Calling
<code>execute</code>, <code>executeUpdate</code> and <code>executeQuery</code> before the batch is
executed does not have any effect on the currently added batch
statements.</p>
</div>
<div class="paragraph">
<p>If at least one statement from the batch fails, a
<code>java.sql.BatchUpdateException</code> is thrown. Jaybird will stop executing
statements from batch after the first error. In auto-commit mode it will
also rollback the transaction. An application can obtain update counts
for the already executed statements using <code>getUpdateCounts</code> method of
the <code>BatchUpdateException</code> class. The returned array will always contain
fewer entries than there were statements in the batch, as it will only
report the update counts of succesfully executed statements.</p>
</div>
</div>
<div class="sect3">
<h4 id="_batch_updates_with_java_sql_preparedstatement_and_java_sql_callablestatement"><a class="anchor" href="#_batch_updates_with_java_sql_preparedstatement_and_java_sql_callablestatement"></a>4.5.2. Batch Updates with java.sql.PreparedStatement and java.sql.CallableStatement</h4>
<div class="paragraph">
<p>Using batch updates with a prepared statement is conceptually similar to
the <code>java.sql.Statement</code> approach. The main difference is that only one
statement can be used, but with different sets of parameter values.</p>
</div>
<div class="listingblock">
<div class="title">Example of batch updates with PreparedStatement</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (PreparedStatement stmt = connection.prepareStatement(
         "INSERT INTO products(id, name) VALUES(?, ?)")) {

  stmt.setInt(1, 1);
  stmt.setString(2, "apple");
  stmt.addBatch();

  stmt.setInt(1, 2);
  stmt.setString(2, "orange");
  stmt.addBatch();

  int[] updateCounts = stmt.executeBatch();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example of batch updates with CallableStatement</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (CallableStatement stmt = connection.prepareCall(
         "{call add_product(?, ?)")) {

  stmt.setInt(1, 1);
  stmt.setString(2, "apple");
  stmt.addBatch();

  stmt.setInt(1, 2);
  stmt.setString(2, "orange");
  stmt.addBatch();

  int[] updateCounts = stmt.executeBatch();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_escape_syntax"><a class="anchor" href="#_escape_syntax"></a>4.6. Escape Syntax</h3>
<div class="paragraph">
<p>The escape syntax was introduced as a portable JDBC-specific syntax to
represent parts of the SQL language that are (or were) usually implemented
differently by database vendors. The escaped syntax is also used to
define features that might not be implemented by the database server,
but can have an appropriate implementation in the driver.</p>
</div>
<div class="paragraph">
<p>The JDBC specification defines escaped syntax for the following</p>
</div>
<div class="ulist">
<ul>
<li>
<p>scalar functions</p>
</li>
<li>
<p>date and time literals</p>
</li>
<li>
<p>outer joins</p>
</li>
<li>
<p>calling stored procedures</p>
</li>
<li>
<p>escape characters for LIKE clauses</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_scalar_functions"><a class="anchor" href="#_scalar_functions"></a>4.6.1. Scalar Functions</h4>
<div class="paragraph">
<p>Escaped syntax for the scalar function call is defined as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{fn &lt;function-name&gt; (argument list)}</pre>
</div>
</div>
<div class="paragraph">
<p>For example <code>{fn concat('Firebird', 'Java')}</code> concatenates these two
words into <code>'FirebirdJava'</code> literal.
"<a href="#jdbcescape">Supported JDBC Scalar Functions</a>" provides a list of supported scalar functions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_date_and_time_literals"><a class="anchor" href="#_date_and_time_literals"></a>4.6.2. Date and Time Literals</h4>
<div class="paragraph">
<p>It is possible to include date and time literals in SQL statements. In
order to guarantee that each database will interpret the literal
identically, the JDBC specification provides following syntax to specify
them:</p>
</div>
<div class="paragraph">
<p>Date literal escaped syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{d 'yyyy-mm-dd'}</pre>
</div>
</div>
<div class="paragraph">
<p>Time literal escaped syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{t 'hh:mm:ss'}</pre>
</div>
</div>
<div class="paragraph">
<p>Timestamp literal syntax (fractional seconds part <code>'.f&#8230;&#8203;'</code> can be
omitted):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{ts 'yyyy-mm-dd hh:mm:ss.f...'}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_outer_joins"><a class="anchor" href="#_outer_joins"></a>4.6.3. Outer Joins</h4>
<div class="paragraph">
<p>Due to the various approaches to specify outer joins (for instance, the
Oracle "(+)" syntax), the JDBC specification provides the following
syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{oj &lt;outer join&gt;}</pre>
</div>
</div>
<div class="paragraph">
<p>where the outer join is specified as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;outer join&gt; ::=
    &lt;table name&gt; {LEFT|RIGHT|FULL} OUTER JOIN
    {&lt;table name&gt; | &lt;outer join&gt;} ON &gt;search condition&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>An example SQL statement would look like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SELECT * FROM {oj tableA a
    LEFT OUTER JOIN tableB b ON a.id = b.id}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_stored_procedures"><a class="anchor" href="#_stored_procedures"></a>4.6.4. Stored Procedures</h4>
<div class="paragraph">
<p>The escaped syntax for stored procedures is described in details in the
the section <a href="#callable-statement">The java.sql.CallableStatement interface</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_like_escaped_characters"><a class="anchor" href="#_like_escaped_characters"></a>4.6.5. LIKE Escaped Characters</h4>
<div class="paragraph">
<p>The percent sign (%) and underscore (_) characters are wild cards in
LIKE clause of the SQL statement. In order to interpret them literally
they must be preceded by the backslash character (\) that is called the
escape character. The escaped syntax for this case identifies which
character is used as an escape character:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{escape '&lt;escape character&gt;'}</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resultsets"><a class="anchor" href="#resultsets"></a>5. Working with result sets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a SELECT statement is executed, the results of the query
are returned through the implementation of the <code>java.sql.ResultSet</code>
interface.</p>
</div>
<div class="sect2">
<h3 id="_resultset_properties"><a class="anchor" href="#_resultset_properties"></a>5.1. ResultSet properties</h3>
<div class="sect3">
<h4 id="resultsets-types"><a class="anchor" href="#resultsets-types"></a>5.1.1. ResultSet Types</h4>
<div class="paragraph">
<p>The JDBC specification defines three types of result sets</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TYPE_FORWARD_ONLY</code> – the result set is not scrollable, cursor can
only move forward. When the <code>TRANSACTION_READ_COMMITTED</code> isolation level
is used, the result set will return all rows that are satisfying the
search condition at the moment of fetch (which will be every <em>fetch size</em> calls to
<code>ResultSet.next()</code>). In other
cases result set will return only rows that were visible at the moment
of the transaction start.</p>
</li>
<li>
<p><code>TYPE_SCROLL_INSENSITIVE</code> – the result set is scrollable, the cursor
can move back and forth, can be positioned on the specified row. Only
rows satisfying the condition at the time of query execution are
visible.</p>
</li>
<li>
<p><code>TYPE_SCROLL_SENSITIVE</code>, is not supported by Firebird and Jaybird.
Jaybird allows an application to ask for this type of result set, however
in compliance with the JDBC specification, the type is "downgraded" to the
<code>TYPE_SCROLL_INSENSITIVE</code> and a corresponding warning is added to the connection
object.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Due to a missing support of scrollable cursors in Firebird, this
support (<code>TYPE_SCROLL_INSENSITIVE</code> result set type) is implemented by
fetching the complete result set to the client. Scrolling happens in the
memory on the client. This can have adverse effect on the system memory
usage and performance when the result set is large.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="resultsets-concurrency"><a class="anchor" href="#resultsets-concurrency"></a>5.1.2. ResultSet Concurrency</h4>
<div class="paragraph">
<p>Result set concurrency specifies whether the result set object can be
updated directly or a separate SQL request should be used to update the
row. Result sets that allow direct modification using the
<code>ResultSet.updateXXX</code> methods are usually used in GUI applications which
allow in-place editing of the underlying result set.</p>
</div>
<div class="paragraph">
<p>The result set concurrency is specified during statement creation
and cannot be changed later. Jaybird supports two types of result set
concurrency:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONCUR_READ_ONLY</code> is available for all types of result sets. It tells
the driver that direct update of the result set is not possible and all
<code>ResultSet.updateXXX</code> methods should throw an exception.</p>
</li>
<li>
<p><code>CONCUR_UPDATABLE</code> is supported only under certain conditions that are
needed for the driver to correctly construct a DML request that will
modify exactly one row. These conditions are:</p>
<div class="ulist">
<ul>
<li>
<p>the SELECT statement that generated the result set references only
one table;</p>
</li>
<li>
<p>all columns that are not referenced by the SELECT statement allow
<code>NULL</code> values, otherwise it won&#8217;t be possible to insert new rows;</p>
</li>
<li>
<p>the SELECT statement does not contain the <code>DISTINCT</code> predicate, aggregate
functions, joined tables, or stored procedures;</p>
</li>
<li>
<p>the SELECT statement references all columns of the tables primary
key definition or the <code>RDB$DB_KEY</code> column.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="resultsets-holdability"><a class="anchor" href="#resultsets-holdability"></a>5.1.3. ResultSet Holdability</h4>
<div class="paragraph">
<p>Result set holdability informs the driver whether result sets should be kept
open across commits. <code>ResultSet.HOLD_CURSORS_OVER_COMMIT</code> tells the
driver to keep the result set object open, while
<code>ResultSet.CLOSE_CURSORS_AT_COMMIT</code> tells driver to close them on
commit.</p>
</div>
<div class="paragraph">
<p>When an application calls <code>Connection.commit()</code>, the Firebird server closes
all open result sets. It is not possible to tell the server to keep a
result set open over commit unless "commit retaining" mode is used. This
mode is global for the complete connection and is not suitable for
holdability control on a statement level. Use of "commit retaining" mode is believed
to have an undesired side-effect for read-write transactions as it
inhibits garbage collection. Because of these reasons "commit
retaining" is not used in Jaybird during normal execution. Applications
are able to commit the transaction keeping the result sets open by
executing a <code>"COMMIT RETAIN"</code> SQL statement.</p>
</div>
<div class="paragraph">
<p>To support holdable result sets, Jaybird will upgrade the result set to
<code>TYPE_SCROLL_INSENSITIVE</code> to cache all rows locally, even if you asked for a <code>TYPE_FORWARD_ONLY</code>
result set. See also <a href="#resultsets-types">ResultSet Types</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resultset_manipulation"><a class="anchor" href="#_resultset_manipulation"></a>5.2. ResultSet manipulation</h3>
<div class="paragraph">
<p><code>ResultSet</code> objects are created when either
<code>Statement.executeQuery(String)</code> or <code>Statement.getResultSet()</code> methods
are called, or when obtaining the generated keys from <code>Statement.getGeneratedKeys()</code>. <code>Statement.getResultSet()</code> is
used in combination with
<code>Statement.execute(String)</code> and can be called only once per
result set (see the following two examples).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The current implementation does not allow to call <code>getResultSet()</code>
method after using the <code>executeQuery(String)</code> method of the <code>Statement</code>
class. The JDBC specification is unclear on this topic and JDBC
drivers of different vendors treat it differently.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Using Statement.executeQuery(String) method</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement();
     ResultSet rs = stmt.executeQuery("SELECT * FROM myTable")) {
  // process result set
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Using Statement.getResultSet() method</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement stmt = connection.createStatement()) {
  boolean hasResultSet = stmt.execute("SELECT * FROM myTable");
  if (hasResultSet) {
    try (ResultSet rs = stmt.getResultSet()) {
      // process result set
    }
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_accessing_the_values_in_the_result_set"><a class="anchor" href="#_accessing_the_values_in_the_result_set"></a>5.2.1. Accessing the values in the result set</h4>
<div class="paragraph">
<p>Depending on the type of the result set, it is possible to move the cursor either forward only
(<a href="#using-forward-only">next example</a>) or using absolute and relative positioning
(<a href="#using-scrollable-updatable">second example below</a>).</p>
</div>
<div class="paragraph">
<p>Values of the result set are obtained by calling the corresponding
getter method depending on the type of column. For example the
<code>ResultSet.getInt(1)</code> method returns the value of the first column as an
<code>int</code> value. If value of the column is not integer, Jaybird tries to
convert it according to the "Data Type Conversion Table" specified in
<a href="#datatypeconversion">Data Type Conversion Table</a>. If conversion is not possible, an exception is thrown.</p>
</div>
<div class="paragraph">
<p>There are two possibilities to obtain data from the result set columns:
by column label or by column position. Position of the first column is 1.
Names supplied to getter methods are case-insensitive. The search first
happens in the column aliases, and if no match found, driver checks the
original column names. If there is more then one column matching the
specified name (even if the original names were quoted), the first match
is taken. <strong>TODO: Behavior changed with Jaybird 2.2, verify and update</strong></p>
</div>
<div class="paragraph">
<p>When getters for primitive types are used and original value in the
result set is <code>NULL</code>, driver returns a default value for that type. For
example <code>getInt()</code> method will return 0. In order to know whether the
value is really 0 or NULL, you have to call <code>ResultSet.wasNull()</code>
method <strong>after</strong> calling the <em>get</em> method.</p>
</div>
<div class="paragraph">
<p>Getters that return object values (<code>getString</code>, <code>getDate</code>, <code>getObject</code>,
etc.) will return a <code>null</code> value for columns containing
<code>NULL</code>. Calling <code>wasNull</code> after object <em>get</em> methods is possible but unnecessary.</p>
</div>
<div id="using-forward-only" class="listingblock">
<div class="title">Example of using forward-only result sets</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (Statement forwardStatement = connection.createStatement();
     ResultSet rs = forwardStatement.executeQuery(
         "SELECT id, name, price FROM myTable")) {

  while(rs.next()) {
    int id = rs.getInt(1);
    String name = rs.getString("name");
    double price = rs.getDouble(3);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_updating_records_in_the_result_set"><a class="anchor" href="#_updating_records_in_the_result_set"></a>5.2.2. Updating records in the result set</h4>
<div class="paragraph">
<p>Scrollable cursors are especially useful when result of some query is
displayed by the application which also allows the user to directly edit
the data and post the changes to the database.</p>
</div>
<div id="using-scrollable-updatable" class="listingblock">
<div class="title">Example of using scrollable and updatable result sets</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Statement scrollStatement = connection.createStatement(
    ResultSet.TYPE_SCROLL_INSENSITIVE,
    ResultSet.CONCUR_UPDATABLE);

ResultSet rs = scrollStatement.executeQuery(
    "SELECT id, name, price FROM myTable");

rs.absolute(1);                  // move to the first row
rs.updateString(2, anotherName); // update the name
rs.updateRow();                  // post changes to the db

rs.moveToInsertRow();
rs.updateInt(1, newId);
rs.updateString(2, newName);
rs.updateDouble(3, newPrice);
rs.insertRow();
rs.moveToCurrentRow();

rs.relative(-2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code example above shows how to update first row, insert new one and
after that move two records backwards.</p>
</div>
<div class="paragraph">
<p>An application can also update the current row using so called
"positioned updates" on named cursors. This technique can be used only
with forward-only cursors, since application can update only the row to
which the server-side cursor points to. In case of scrollable cursors
the complete result set is fetched to the client and then the
server-side cursor is closed. <a href="#using-positioned-updates">The example below</a> shows how to use
positioned updates.</p>
</div>
<div class="paragraph">
<p>First, the application has to specify the name of the cursor and the list of the columns that will
be updated before the query is executed. This name is later used in the <code>UPDATE</code> statement as
shown in the example.</p>
</div>
<div id="using-positioned-updates" class="listingblock">
<div class="title">Example of using the positioned updates</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">connections.setAutoCommit(false);
try (Statement selectStmt = connection.createStatement();
     Statement updateStmt = connection.createStatement()) {
  selectStmt.setCursorName("someCursor");

  try (ResultSet rs = selectStmt.executeQuery(
           "SELECT id, name, price FROM myTable " +
           "FOR UPDATE OF myColumn")) {

    while(rs.next()) {
      ...
      if (someCondition) {
        updateStmt.executeUpdate("UPDATE myTable " +
            "SET myColumn = myColumn + 1 " +
            "WHERE CURRENT OF " + rs.getCursorName());
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_closing_the_result_set"><a class="anchor" href="#_closing_the_result_set"></a>5.2.3. Closing the result set</h4>
<div class="paragraph">
<p>A result set is closed by calling the <code>ResultSet.close()</code> method. This
releases the associated server resources and makes the <code>ResultSet</code>
object available for garbage collection. It is strongly recommended to
explicitly close result sets in auto-commit mode or
<code>ResultSet.TYPE_SCROLL_INSENSITIVE</code> result sets, because this releases
memory used for the cached data. Whenever possible, use try-with-resources.</p>
</div>
<div class="paragraph">
<p>The result set object is also closed automatically, when the statement
that created it is closed or re-executed. In auto-commit mode, the
result set is closed automatically if any statement is executed on the
same connection.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="transactions"><a class="anchor" href="#transactions"></a>6. Using transactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transactions are used to group SQL statements into a single block that
satisfies so called ACID properties: atomicity, consistency, isolation
and durability. In other words, all statements executed within
transaction will either succeed and their results will be permanently
stored in the database or the effect of the statement execution will be
undone.</p>
</div>
<div class="sect2">
<h3 id="_jdbc_transactions"><a class="anchor" href="#_jdbc_transactions"></a>6.1. JDBC transactions</h3>
<div class="paragraph">
<p>Firebird supports multiple concurrent transactions over the same
database connection. This allows applications that work via the native
Firebird API to save the number of network connections, which in turn
saves the resources on the server<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>This model however cannot be applied to each database engine in the
world and the designers of the JDBC API have chosen a model where each
database connection has one and only one active transaction associated
with it. Also, unlike the Firebird model, where transactions require
explicit start, JDBC specification requires the driver to start
transaction automatically as soon as a transactional context is needed.</p>
</div>
<div class="paragraph">
<p>The following code shows a very simple example of using transactions in
JDBC where a hypothetical intruder that increases salary of each
employee twice and uses explicit transaction control in JDBC. It also
tries to hide his own identity and if the operations succeed, he commits
the transaction, otherwise he rolls the changes back.</p>
</div>
<div class="listingblock">
<div class="title">Example of explicit transaction control</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Connection connection = ...

connection.setAutoCommit(false); <i class="conum" data-value="1"></i><b>(1)</b>

Statement stmt = connection.createStament();
try {
  stmt.executeUpdate("UPDATE employee " +
      " SET salary = salary * 2"); <i class="conum" data-value="2"></i><b>(2)</b>

  // ... do some more changes to database
  // to hide the identity of the person
  // that messed up the salary information
  // by deleting the audit trails logs, etc.

  stmt.executeUpdate("DELETE FROM audit_trails");

  connection.commit(); <i class="conum" data-value="3"></i><b>(3)</b>
} catch(SQLException ex) {
  connection.rollback(); <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to use transactions, the application first switches the auto-commit mode off
(see below for more information), then creates a <code>java.sql.Statement</code>
object, executes an UPDATE statement. Please note, that there is no
explicit transaction start, a new transaction will be started right before
executing the statement (step 2).</p>
</div>
<div class="paragraph">
<p>If we work with a database where not only referential integrity is preserved,
but also reasonable security rules are encoded in the triggers, it will
raise an error preventing cleaning the audit trails information. In this
case the intruder chooses to undo all the changes he made, so that nobody
notices anything. But if no security rules are implemented, he commits
the transaction.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Firebird PSQL has an <code>IN AUTONOMOUS TRANSACTION</code> block that can be used to prevent such abuse
and prevent audit-records from being wiped out by a transaction rollback.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a connection uses explicit transaction control, each transaction must
be finished by calling the <code>commit()</code> or <code>rollback()</code> methods of the
<code>Connection</code> object before the connection is closed. If a transaction
was not finished, but the <code>close</code> method is called, the active
transaction is rolled back automatically. This also happens when the
transaction was not finished, the connection was not closed explicitly
and that <code>Connection</code> object became eligible for garbage collection. In
this case, the <code>close()</code> method is implicitly invoked by the class
finalizer, which in turn rolls the transaction back.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Given the non-deterministic delay of garbage collection, make sure to explicitly end
the transaction and close the connection. Do not rely on the garbage collector for this.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_auto_commit_mode"><a class="anchor" href="#_auto_commit_mode"></a>6.2. Auto-commit mode</h3>
<div class="paragraph">
<p>Each newly created connection by default has the auto-commit property
enabled. In other words, the duration of the transaction is limited by
the duration of statement execution, or more formally –
the transaction is ended when the statement is completed. The point when
statement execution is considered complete, is defined in the
specification as:</p>
</div>
<div class="ulist">
<div class="title">Rules when the statement is completed in auto-commit mode</div>
<ul>
<li>
<p>For insert, update, delete and DDL statements, the statement is
complete as soon as it has finished executing.</p>
</li>
<li>
<p>For select statements, statement is complete when the associated
result set is closed. The result set is closed as soon as one of the
following occurs:</p>
<div class="ulist">
<ul>
<li>
<p>all of the rows have been retrieved</p>
</li>
<li>
<p>the associated Statement object is re-executed</p>
</li>
<li>
<p>another Statement object is executed on the same connection</p>
</li>
</ul>
</div>
</li>
<li>
<p>For CallableStatement objects, the statement is complete, when all of
the associated result sets have been closed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If there is an ongoing transaction and the value of the auto-commit
property is changed, the current transaction is committed.</p>
</div>
<div class="paragraph">
<p>Note, when a connection is obtained via <code>javax.sql.DataSource</code> object
and container managed transactions are used (for example, the
application is executing inside an EJB container), it is an error to
call <code>setAutoCommit</code> method.</p>
</div>
<div class="paragraph">
<p>Special care should be taken when using multiple statements in
auto-commit mode. The JDBC 2.0 specification did not fully define the rules
for the statement completion as it did not define the behavior
of multiple <code>ResultSet</code> objects created using the same connection object
in auto-commit mode.</p>
</div>
<div class="paragraph">
<p>Since Firebird does not allow the result set to remain open after the
transaction ends, Jaybird 1.5.x and below cached the complete result set
in memory when the SELECT statements were executed and corresponding
transaction was committed. This had an adverse effect on allocated memory
when the result set is big, especially when it contains BLOB fields. The
JDBC 3.0 specification addressed this unclear situation (see above) and
Jaybird 2.1 was improved to correctly handle them. It also allowed to
improve the memory footprint – the driver no longer caches
non-scrollable and non-holdable result sets in memory.</p>
</div>
<div class="paragraph">
<p>However, some Java applications that do not conform the current JDBC
specification might no longer work with Jaybird 2.1 and above unless
additional steps are taken.</p>
</div>
<div class="paragraph">
<p>The piece of code below works perfectly with explicit transaction
control. However, it won&#8217;t work correctly with auto-commit with a driver - like Jaybird - that
complies with the JDBC 3.0 specification, when the <code>selectStmt</code> and <code>updateStmt</code>
object are created by the same connection object (step 1). When the
UPDATE is executed in step 3, the result set produced by the SELECT
statement must be closed before the execution. When the Java application
tries to fetch the next record by calling the <code>rs.next()</code> method, it
will receive an <code>SQLException</code> with a message <em>"The result set is
closed"</em>.</p>
</div>
<div class="paragraph">
<p>The only correct solution to this situation is to fix the application by
either using explicit transaction control, or by using two connection
objects, one for SELECT statement and one for UPDATE statement.</p>
</div>
<div class="listingblock">
<div class="title">Non-compliant usage of nested statements in auto-commit mode</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Statement selectStmt = connection.createStatement(); <i class="conum" data-value="1"></i><b>(1)</b>
Statement updateStmt = connection.createStatement();

ResultSet rs = selectStmt.executeQuery(
    "SELECT * FROM myTable");

while(rs.next()) { <i class="conum" data-value="2"></i><b>(2)</b>
  int id = rs.getInt(1);
  String name = rs.getString(2);

  updateStmt.executeUpdate("UPDATE anotherTable SET " +
      " name = '" + name + "' WHERE id = " + id); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately, not all applications can be changed either because there is no source code available or, simply, because any change in the code requires complete release testing of the software.
To address this, Jaybird 2.1 introduced the connection parameter <code>defaultHoldable</code> which makes result sets holdable by default.
The holdable result sets will be fully cached in memory, but won&#8217;t be closed automatically when transaction ends.<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup>
This property also affects the default holdability of result sets when auto-commit is disabled.</p>
</div>
<div class="paragraph">
<p>See <a href="#ref-defaultholdable">Default holdable result sets</a> for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_read_only_transactions"><a class="anchor" href="#_read_only_transactions"></a>6.3. Read-only Transactions</h3>
<div class="paragraph">
<p>A transaction can be declared read-only to reduce the possibility of
lock conflicts. In general, this makes little sense for Firebird,
because of its multi-generational architecture, where readers do not
block writers and vice versa. However, in some cases it can be useful.</p>
</div>
<div class="paragraph">
<p>It is not allowed to connect with a read-write transaction to a database
located on a read-only media, for example, a CD-ROM. The reason is that,
in order to guarantee consistency of the read-write transactions,
Firebird has to increase the transaction identifier when transaction
ends, and to store the new value on the so-called Transaction Inventory
Page even if no changes were made in that transaction. This requirement
can be relaxed if transaction is declared read-only and the engine
ensures that no data can be modified.</p>
</div>
<div class="paragraph">
<p>Another reason is that long running read-write transactions inhibit the
process of collecting garbage, i.e. a process of identifying previous
versions of the database records that are no longer needed and releasing
the occupied space for the new versions. Without garbage collection the
database size will grow very fast and the speed of the database
operations will decrease, because the database engine will have to check
all available record versions to determine the appropriate one.</p>
</div>
<div class="paragraph">
<p>Therefore, if you are sure that application won&#8217;t modify the database in
the transaction, use the <code>setReadOnly</code> method of the
<code>java.sql.Connection</code> object to tell the server that the transaction is
read-only.</p>
</div>
</div>
<div class="sect2">
<h3 id="transactions-isolation-levels"><a class="anchor" href="#transactions-isolation-levels"></a>6.4. Transaction Isolation Levels</h3>
<div class="paragraph">
<p>The ANSI/ISO SQL standard defines four such levels, each next one weaker
than the previous. These isolation levels are also used in the JDBC
specification:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. JDBC transaction isolation levels and their characteristics</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC isolation level</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRANSACTION_SERIALIZABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactions with this isolation level
prohibit phantom reads, the situation when one transaction reads all
rows satisfying the WHERE condition, another transaction inserts a row
satisfying that condition, and first transaction re-executes the
statement.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRANSACTION_REPEATABLE_READ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This isolation level prevents
non-repeatable reads, a situation when a row is read in one transaction,
then modified in another transaction, and later re-read in the first
transaction. In this case different values had been read within the same
transaction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRANSACTION_READ_COMMITTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactions with this isolation level can
see only committed records. However, it does not prevent so-called
non-repeatable reads and phantom reads.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRANSACTION_READ_UNCOMMITTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The weakest isolation level, or better to
say level with no isolation. Such transactions can see the not yet
committed changes to the data in the database from the concurrently
running transactions.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Firebird, however, defines other isolation levels: <code>read_committed</code>,
<code>concurrency</code> and <code>consistency</code>. Only the <code>read_committed</code> isolation
level can be mapped to the same level defined by the ANSI/ISO SQL
standard. Dirty reads are prevented, non-repeatable reads as well as
phantom reads can occur.</p>
</div>
<div class="paragraph">
<p>The <code>concurrency</code> isolation level is stronger than repeatable read
isolation defined in ANSI/SQL standard and satisfies the requirements of
a serializable isolation level, however, unlike RDBMSes with locking
concurrency control, it guarantees better performance.</p>
</div>
<div class="paragraph">
<p>And finally Firebird provides a <code>consistency</code> isolation level which in
combination with table reservation feature guarantees the deadlock-free
execution of transactions. A transaction will be prevented from starting
if there is already another one with the overlapping sets of the
reserved tables. This isolation level guarantees truly serial history of
transaction execution.</p>
</div>
<div class="paragraph">
<p>In order to satisfy the JDBC specification Jaybird provides a following
default mapping of the JDBC transaction isolation levels into Firebird
isolation levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TRANSACTION_READ_COMMITTED is mapped to <code>read_committed</code> isolation
level in Firebird – any changes made inside a transaction are not
visible outside a transaction until the transaction is committed. A
transaction in read-committed mode sees all committed changes made by
other transactions even if that happened after start of the current
transaction.</p>
</li>
<li>
<p>TRANSACTION_REPEATABLE_READ is mapped to <code>concurrency</code> isolation level
in Firebird – any changes made inside this transaction are not visible
outside a transaction until the transaction is committed. A transaction
in repeatable-read sees only those changes that were committed before
the transaction started. Any committed change in another transaction
that happened after the start of this transaction is not visible in this
transaction.</p>
</li>
<li>
<p>TRANSACTION_SERIALIZABLE is mapped into <code>consistency</code> isolation level
in Firebird – any modification to a table happens in serial way: all
transactions wait until the current modification is done. This mode can
be considered as a traditional pessimistic locking scheme, but the lock
is placed on the whole table. See section "<a href="#transactions-table-reservation">Table Reservation</a>" for more information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default mapping is specified in the <code>isc_tpb_mapping.properties</code> file that
can be found in the Jaybird archive and can be overridden via the
connection properties</p>
</div>
<div class="ulist">
<ul>
<li>
<p>via the <code>tpbMapping</code> property that specifies the path to the
<code>PropertiesResourceBundle</code> with the new mapping of the isolation level;</p>
</li>
<li>
<p>via the direct specification of the JDBC transaction isolation level.
The following code contains an example of such operation, the values in
the mapping are described in section "<a href="#transactions-tpb">Transaction Parameter Buffer</a>".</p>
</li>
<li>
<p>via the data source configuration.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Overriding the default isolation level mapping</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Properties props = new Properties();
props.setProperty("user", "SYSDBA");
props.setProperty("password", "masterkey");
props.setProperty("TRANSACTION_READ_COMMITTED",
    "isc_tpb_read_committed,isc_no_rec_version," +
    "isc_tpb_write,isc_tpb_nowait");

Connection connection = DriverManager.getConnection(
    "jdbc:firebirdsql://localhost:3050/c:/example.fdb",
    props);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The overridden mapping is used for all transactions started within the
database connection. If the default mapping is overridden via the
data source configuration, it will be used for all connections
created by the data source.</p>
</div>
</div>
<div class="sect2">
<h3 id="transactions-savepoints"><a class="anchor" href="#transactions-savepoints"></a>6.5. Savepoints</h3>
<div class="paragraph">
<p>Savepoints provide finer-grained control over transactions by providing
intermediate steps within a larger transaction. Once a savepoint has
been set, transaction can be rollback to that point without affecting
preceding work.</p>
</div>
<div class="paragraph">
<p>In order to set a savepoint, use the following code:</p>
</div>
<div class="listingblock">
<div class="title">Example of using savepoints</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Connection connection = ...;
connection.setAutoCommit(false);

Statement stmt = connection.createStatement();

stmt.executeUpdate(
    "INSERT INTO myTable(id, name) VALUES (1, 'John')");

Savepoint savePoint1 =
    connection.setSavepoint("savepoint_1");

stmt.executeUpdate(
    "UPDATE myTable SET name = 'Ann' WHERE id = 1");
...

connection.rollback(savePoint1);

// at this point changes done by second update are undone</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, rolling back to the savepoint automatically releases and
invalidates any savepoints that were created after the released
savepoint.</p>
</div>
<div class="paragraph">
<p>If the savepoint is no longer needed, you can use the
<code>Connection.releaseSavepoint</code> method to release system resources. After
releasing a savepoint it is no longer possible to rollback the current
transaction to that savepoint. Attempts to call the <code>rollback(Savepoint)</code> method
will result in an <code>SQLException</code>. Savepoints that have been created
within a transaction are automatically released when that transaction is
committed or rolled back.</p>
</div>
</div>
<div class="sect2">
<h3 id="transactions-tpb"><a class="anchor" href="#transactions-tpb"></a>6.6. Transaction Parameter Buffer</h3>
<div class="paragraph">
<p>The behavior of Firebird transactions is internally controlled by
the Transaction Parameter Buffer (TPB), which specifies different
transaction properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the transaction isolation level;</p>
</li>
<li>
<p>the transaction&#8217;s read-only or read-write mode;</p>
</li>
<li>
<p>the lock conflict resolution mode – wait or no wait;</p>
</li>
<li>
<p>the lock wait timeout;</p>
</li>
<li>
<p>and, finally, the table reservations – their names and reservation
modes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The TPB is automatically generated depending on the transaction
isolation level specified for the <code>java.sql.Connection</code> object.
Usually there is no need to manipulate the TPB directly. Additionally,
if the connection is set to read-only mode, this is reflected in the TPB
by appropriate constant. However, the lock resolution mode as well as
table reservations cannot be specified by using the standard JDBC
interfaces. For the cases where this is needed, Jaybird provides an
extension of the JDBC standard.</p>
</div>
<div class="listingblock">
<div class="title">Example of specifying custom TPB</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">FirebirdConnection fbConnection =
    (FirebirdConnection)connection;

TransactionParameterBuffer tpb =
    fbConnection.createTransactionParameterBuffer();

tpb.addArgument(TransactionParameterBuffer.READ_COMMITTED);
tpb.addArgument(TransactionParameterBuffer.REC_VERSION);
tpb.addArgument(TransactionParameterBuffer.WRITE);
tpb.addArgument(TransactionParameterBuffer.WAIT);
tpb.addArgument(TransactionParameterBuffer.LOCK_TIMEOUT, 15);

fbConnection.setTransactionParameters(tpb);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above presents an example of populating the TPB with custom
parameters.</p>
</div>
<div class="sect3">
<h4 id="_isolation_level"><a class="anchor" href="#_isolation_level"></a>6.6.1. Isolation level</h4>
<div class="paragraph">
<p>Firebird supports three isolation
levels: <code>read_committed</code>, <code>concurrency</code> and <code>consistency</code> which are
represented by appropriate constants in the
<code>TransactionParameterBuffer</code> class. The isolation level specifies the
way the database engine processes the record versions on read
operations. The <code>concurrency</code> isolation level is also often called
SNAPSHOT and the <code>consistency</code> - SNAPSHOT TABLE STABILITY isolation
levels.</p>
</div>
<div class="paragraph">
<p>In <code>consistency</code> and <code>concurrency</code> modes Firebird database engine loads
the different versions of the same record from disk and checks the
"timestamps" of each version and compares it with the "timestamp" of the
current transaction. The record version with the highest timestamp that
is however lower or equal to the timestamp of the current transaction is
returned to the application. This effectively returns the version of the
record that was when the current transaction started and guarantees that
neither non-repeatable reads nor phantom reads can ever occur.</p>
</div>
<div class="paragraph">
<p>In <code>read_committed</code> mode, the Firebird database engine accesses the
record version with the highest timestamp for which the corresponding
transaction is marked as committed. This prevents engine from reading
the record versions which were modified in concurrent transactions
that are not yet committed or were rolled back for whatever reasons.
However, such mode allows non-repeatable reads as well as phantom reads
if the concurrent transaction that modified records or inserted new ones
had been committed.</p>
</div>
<div class="paragraph">
<p>The <code>read_committed</code> isolation mode requires another constant that
specifies the behavior of the transaction when it sees a record version
with a timestamp that belongs to a currently running transaction
which is not yet committed.</p>
</div>
<div class="paragraph">
<p>Most applications require the <code>TransactionParameterBuffer.REC_VERSION</code> mode, which is shown in the
code above. In this mode database engine fetches the latest committed
version as described before.</p>
</div>
<div class="paragraph">
<p>The <code>TransactionParameterBuffer.NO_REC_VERSION</code> constant tells database
engine to report a lock conflict when an uncommitted record version is
seen while fetching data from the database. The outcome of the operation
is then controlled by the lock resolution mode (see section
<a href="#transactions-lock-resolution">Lock resolution mode</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="transactions-read-only"><a class="anchor" href="#transactions-read-only"></a>6.6.2. Read-only transactions</h4>
<div class="paragraph">
<p>The read-only or read-write transaction mode is controlled by two
constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TranscationParameterBuffer.READ</code> and</p>
</li>
<li>
<p><code>TransactionParameterBuffer.WRITE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the read-write mode (constant <code>WRITE</code>) is specified, the database engine stores the
"timestamp" of the new transaction in the database even when no modification will
be made in the transaction. The "timestamp" affects the garbage
collection process, since the database engine cannot release records
that were modified in transactions with higher "timestamps" even
when these record versions are no longer needed (in other words, when
there are already newer versions of the records). Thus, long-running
read-write transaction inhibits the garbage collection even when no
modifications are done in it.</p>
</div>
<div class="paragraph">
<p>Therefore, it is recommended to set the read-only mode for the
transaction when it is used for read operations.</p>
</div>
</div>
<div class="sect3">
<h4 id="transactions-lock-resolution"><a class="anchor" href="#transactions-lock-resolution"></a>6.6.3. Lock resolution mode</h4>
<div class="paragraph">
<p>Relational database systems that use pessimistic locking for concurrency
control lock the records regardless of the operation type, read or
write. When an application tries to read a record from the database,
the database engine tries to obtain a "read lock" to that record. If the
operation succeeds and the application later tries to update the record, the
lock is upgraded to a "write lock". And finally, if the resource is
already locked for write, concurrent transactions cannot lock it for
reading, since the system cannot allow the transaction to make a
decision based on data that might be rolled back later. This approach
significantly decreases concurrency. However, databases systems that
employ a record versioning mechanism do not have such restrictions
because each transaction "sees" its own version of the record – the only
possible conflict happens when two concurrent transactions try to obtain
"write lock" for the same database record.</p>
</div>
<div class="paragraph">
<p>Firebird belongs to the latter, and on <code>read_committed</code> and
<code>concurrency</code> isolation levels it behaves appropriately – there are no
lock conflicts between readers and writers, and only writers competing
for the same resource raise a lock conflict. However, on the
<code>consistency</code> isolation level Firebird emulates the behavior of
systems with pessimistic locking – read operations will conflict with
write operations. Even more, the locks are obtained for whole tables (see
"<a href="#transactions-table-reservation">Table Reservation</a>" for details).</p>
</div>
<div class="paragraph">
<p>The following table summarizes the above for Firebird 2.0. It shows that
read-committed or repeatable read transactions conflict only when they
simultaneously update the same rows. In contrast, a <code>consistency</code>
transaction conflicts with any transaction running in read-write mode,
e.g. as soon as a <code>consistency</code> transaction gets write access to a
table, other read-write transactions are not allowed to make changes in
that tables.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Lock conflicts within one table depending on the isolation level</caption>
<colgroup>
<col style="width: 34%;">
<col style="width: 18%;">
<col style="width: 18%;">
<col style="width: 15%;">
<col style="width: 15%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read-commited, Concurrency read-write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read-commited, Concurrency
read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consistency, read-write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consistency, read-only</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read-committed, Concurrency read-write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">some updates may conflict</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read-committed, Concurrency read-only</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consistency read-write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consistency read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="transactions-table-reservation"><a class="anchor" href="#transactions-table-reservation"></a>6.7. Table Reservation</h3>
<div class="paragraph">
<p>Table reservation allows you to specify the database tables and the
corresponding access modes at the beginning of the transaction. When the
transaction is started, the engine tries to obtain the requested locks for
the specified tables and proceeds only when all of them were
successfully obtained. Such behavior allows to create a deadlock-free
execution history<sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The table reservation is specified via a TPB and includes the table to
lock, the lock mode (read or write) and lock type (shared, protected and
exclusive).</p>
</div>
<div class="listingblock">
<div class="title">Example of using table reservation facility in Firebird</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Connection connection = ...
TransactionParameterBuffer tpb =
    connection.createTransactionParameterBuffer(); <i class="conum" data-value="1"></i><b>(1)</b>

tpb.addArgument(TransactionParameterBuffer.CONSISTENCY); <i class="conum" data-value="2"></i><b>(2)</b>
tpb.addArgument(TransactionParameterBuffer.WRITE);
tpb.addArgument(TransactionParameterBuffer.NOWAIT);

tpb.addArgument(TransactionParameterBuffer.LOCK_WRITE,
    "TEST_LOCK");
tpb.addArgument(TransactionParameterBuffer.PROTECTED);

connection.setTransactionParameters(tpb); <i class="conum" data-value="3"></i><b>(3)</b>

// next transaction will lock TEST_LOCK table for writing
// in protected mode</code></pre>
</div>
</div>
<div class="paragraph">
<p>This shows an example of reserving the TEST_LOCK table for writing in a
protected mode. The code does the following:</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a new instance of <code>TransactionParameterBuffer</code> class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Populate the TPB. The first three statements were
described in "<a href="#transactions-tpb">Transaction Parameter Buffer</a>". The fourth call specifies that the application wants
to obtain a lock on the table <code>TEST_LOCK</code> for writing. The fifth call
specifies the type of the lock to obtain, in our case the protected lock.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the new TPB to be used for the next transaction.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The lock mode to the table specified in the TPB can be either</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TransactionParameterBuffer.LOCK_READ</code> for read-only access to the
table;</p>
</li>
<li>
<p>or <code>TransactionParameterBuffer.LOCK_WRITE</code> for read-write access to
the table.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The lock type can be either</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TransactionParameterBuffer.SHARED</code> for shared access to the table;</p>
</li>
<li>
<p>or, <code>TransactionParameterBuffer.PROTECTED</code> for protected access to the
table;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>TransactionParameterBuffer.EXCLUSIVE</code> mode was introduced in later
versions of Firebird, however it behaves like <code>PROTECTED</code> mode for all
read-write transactions.</p>
</div>
<div class="paragraph">
<p>The lock conflict table depends on the isolation level of the
transactions and has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LOCK_WRITE</code> mode always conflicts with another <code>LOCK_WRITE</code> mode
regardless of the lock type and transaction isolation mode;</p>
</li>
<li>
<p><code>LOCK_WRITE</code> always conflicts with another <code>LOCK_READ</code> mode if both
transactions have <code>consistency</code> isolation, but has no conflict with
shared-read locks if the other transaction has either <code>concurrency</code> or
<code>read_committed</code> isolation level;</p>
</li>
<li>
<p><code>LOCK_READ</code> mode never conflicts with <code>LOCK_READ</code> mode.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="services"><a class="anchor" href="#services"></a>7. Working with Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to normal database connections, Firebird features
server-wide connections. These are used to perform various
administrative tasks in Firebird, e.g. database backup, maintenance,
statistics. The set of API calls to perform such tasks are known under
the name "Services API". Additionally, client applications can use the
Services API to get some limited information about the server
environment and configuration.</p>
</div>
<div class="paragraph">
<p>The actual execution of the Services API calls can be viewed as a tasks
triggered from the client application to be executed on server. The
parameters passed in the calls are internally used to construct the
string similar to the one that is passed to command-line tools. Later
this string is passed into entry routine of the gbak, gfix, gsec or
gstat utility. The output of the utility, which in normal case is
printed to standard out, is in this case transmitted over the network to
the client application.</p>
</div>
<div class="paragraph">
<p>Jaybird attempts to hide the complexity of the original API by
providing a set of interfaces and their implementations to perform the
administrative tasks regardless of the usage mode (i.e. remote server
and embedded engine, wire protocol and access via native client
library).</p>
</div>
<div class="paragraph">
<p>This chapter describes the available Java API for the administrative
tasks. All classes and interfaces described below are defined in the
<code>org.firebirdsql.management</code> package. Each management class works as a
standalone object and does not require an open connection to the server.</p>
</div>
<div class="sect2">
<h3 id="_servicemanager"><a class="anchor" href="#_servicemanager"></a>7.1. ServiceManager</h3>
<div class="paragraph">
<p>The <code>ServiceManager</code> interface and the <code>FBServiceManager</code> class are
defined as the common superclasses providing setters and getters for
common properties as well as some common routines. The following
properties can be specified:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name or the IP address of the host to which we make the Service API request. <em>Required</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port to which we make the request, 3050 by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to the database.
The meaning of the property depends on the service being invoked and will be described in each of chapters below.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the user on behalf of which which all Service API calls will be executed. <em>Required</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password corresponding to the specified user. <em>Required.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.OutputStream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stream into which the output of the remote service will be written to. <em>Optional</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The last parameter requires some explanation. The calls to all
Services API routines are asynchronous. The client application can start
the call, but there are no other means to find out whether execution of
the service call is finished or not except reading the output of the
service call – EOF in this case means that execution is finished.</p>
</div>
<div class="paragraph">
<p>The <code>FBServiceManager</code> converts the asynchronous calls into synchronous
by constantly polling the service output stream. If the <code>logger</code> property is
specified the received data is copied into the specified
<code>OutputStream</code>, otherwise it is simply ignored and the EOF-marker is
being watched.</p>
</div>
<div class="paragraph">
<p>This behavior can be changed by overriding the appropriate method in the
<code>FBServiceManager</code> class and/or subclasses. The only requirement is to
detach from the service manager when it is no longer needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_backup_and_restore"><a class="anchor" href="#_backup_and_restore"></a>7.2. Backup and restore</h3>
<div class="paragraph">
<p>The backup and restore routines are defined in the <code>BackupManager</code>
interface and are implemented in the <code>FBBackupManager</code> class.
Additionally to the setters and getters described in the previous
section the following methods are used to specify the backup and restore
paths and properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For backup operation it specifies the path to the database to backup.</p>
<p class="tableblock">For restore operation it specifies the path to the database into which the backup file will be restored.
In case when multi-file database should be created, use <code>addRestorePath(String, int)</code> method instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backupPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to the backup file.
For backup operation specifies the path and the file name of the newly created backup file.
If multi-file backup files are to be created, use <code>addBackupPath(String, int)</code> method instead.
For restore operations specifies path to the single backup file.
If database should be restored from multi-file backup, please use the <code>addBackupPath(String)</code> method instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>restorePageBufferCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of pages that will be cached of this particular database.
Should be used only for restore operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>restorePageSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the database page.
Should be used only for restore operation.
Valid values depend on the Firebird version, but should be one of the 1024, 2048, 4096 or 8192.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>restoreReadOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to <code>true</code> if the database should be restored in read-only mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>restoreReplace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set to <code>true</code> if restore should replace the existing database with the one from backup.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is easy to drop an existing database if the backup can&#8217;t be restored, as the existing database is first deleted and only after that the restore process starts.
To avoid such situation it is recommended to restore a database into some dummy file first and then use file system commands to replace the existing database with the newly created one.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>verbose</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Be verbose when writing to the log.</p>
<p class="tableblock">The service called on the server will produce lots of output that will be written to the output stream specified in logger property.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition to the properties, the following methods are used to configure
the paths to backup and database files when multi-file backup or restore
operations are used.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addBackupPath(String)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add a path to a backup file from a multi-file backup.
Should be used for restore operation only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addBackupPath(String, int)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add a path to the multi-file backup.
The second parameter specifies the maximum size of the particular file in bytes.
Should be used for backup operation only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addRestorePath(String, int)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add a path for the multi-file database.
The second parameter specifies the maximum size of the database file in pages (in other words, the maximum size in bytes can be obtained by multiplying this value by <code>restorePageSize</code> parameter)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clearBackupPaths()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clear all the specified backup paths.
This method also clears the path specified in <code>backupPath</code> property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clearRestorePaths()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clear all the specified restore paths.
This method also clears the path specified in the database property.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All paths specified are paths specifications on the remote server. This has the following
implications:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>it is not possible to backup to the local or network drive unless it is mounted on the remote
server;</p>
</li>
<li>
<p>it is not possible to restore from the local or network drive unless it is mounted on the remote
server.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After specifying all the needed properties, the application developer can use
<code>backupDatabase()</code>, <code>backupMetadata()</code> and <code>restoreDatabase()</code> methods
to perform the backup and restore tasks. These methods will block until
the operation is finished. If the <code>logger</code> property was set, the output
of the service will be written into the specified output stream,
otherwise it will be ignored.<sup class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup></p>
</div>
<div class="listingblock">
<div class="title">Example of backup and restore process</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">// backup the database
BackupManager backupManager = new FBBackupManager();

backupManager.setHost("localhost");
backupManager.setPort(3050);
backupManager.setUser("SYSDBA");
backupManager.setPassword("masterkey");
backupManager.setLogger(System.out);
backupManager.setVerbose(true);

backupManager.setDatabase("C:/database/employee.fdb");
backupManager.setBackupPath("C:/database/employee.fbk");

backupManager.backupDatabase();
...
// and restore it back
BackupManager restoreManager = new FBBackupManager();

restoreManager.setHost("localhost");
restoreManager.setPort(3050);
restoreManager.setUser("SYSDBA");
restoreManager.setPassword("masterkey");
restoreManager.setLogger(System.out);
restoreManager.setVerbose(true);

restoreManager.setRestoreReplace(true); // attention!!!

restoreManager.setDatabase("C:/database/employee.fdb");
restoreManager.setBackupPath("C:/database/employee.fbk");

backupManager.restoreDatabase();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods <code>backupDatabase(int)</code> and <code>restoreDatabase(int)</code> provide a
possibility to specify additional backup and restore options that cannot
be specified via the properties of this class. The parameter value is
bitwise combination of the following constants:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Constant</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_CONVERT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backup external files as tables.</p>
<p class="tableblock">By default external tables are not backed up, only references to the external files with data are stored in the backup file.
When this option is used, the backup will store the external table as if they were regular tables.
After restore the tables will remain regular tables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_EXPAND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No data compression.</p>
<p class="tableblock">The gbak utility uses RLE compression for the strings in backup file.
Using this option tells it to write strings in their full length, possibly fully consisting of empty characters, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_IGNORE_CHECKSUMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignore checksums.</p>
<p class="tableblock">The backup utility can&#8217;t backup a database with page checksum errors.
Such database is considered corrupted and the completeness and correctness of the backup cannot be guaranteed.
However in some cases such errors can be ignored, e.g. when the index page is corrupted.
In such case the data in the database are ok and the error disappears when the database is restored and index is recreated.</p>
<p class="tableblock">Use this option only when checksum errors are detected and can&#8217;t be corrected without full backup/restore cycle.
Ensure that the restored database contains correct data afterwards.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_IGNORE_LIMBO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignore in-limbo transactions.</p>
<p class="tableblock">The backup utility can&#8217;t backup database with in-limbo transactions.
When such situation appears, backup has to wait until the decision about the outcome of the in-limbo transaction.
After a wait timeout, an exception is thrown and backup is aborted.
This option allows to workaround this situation – the gbak looks for the most recent committed version of the record and writes it into the backup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_METADATA_ONLY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backup metadata only.</p>
<p class="tableblock">When this option is specified, the backup utility creates a backup of only the metadata information
(e.g. table an/or view structure, stored procedures, etc.), but no data are backed up.
This allows restoring a clean database from the backup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_NO_GARBAGE_COLLECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not collect garbage during backup.</p>
<p class="tableblock">The backup process reads all records in the tables one by one.
When cooperative garbage collection is enabled<sup class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnotedef_11" title="View footnote.">11</a>]</sup> the transaction that accesses the latest version of the record is also responsible for marking the previous versions as garbage.
This process is time consuming and might be switched off when creating backup, where
the most recent version will be read.</p>
<p class="tableblock">Later, operator can restore the database from the backup.
In databases with many backversions of the records, the backup-restore cycle can be
faster than traditional garbage collection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_NON_TRANSPORTABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use non-transportable backup format.</p>
<p class="tableblock">By default gbak creates so-called transportable backup where it does not make difference whether it is later restored on the platform with big or little endianess.
By using this option a non-transportable format will be used which allows restoring the database only on the same architecture.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BACKUP_OLD_DESCRIPTIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Save old style metadata descriptions.</p>
<p class="tableblock">Actually no real information exist for this option, by default it is switched off.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTORE_DEACTIVATE_INDEX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deactivate indexes during restore.</p>
<p class="tableblock">By default indexes are created at the beginning of the restore process and they are updated with
each record being restored from the backup file. On a big tables it is more efficient first to
store data in the database and to update the index afterwards. When this option is specified, the
indexes will be restored in the inactive state. The downside of this option is that the database
administrator is required to activate indexes afterwards, it won&#8217;t happen automatically.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTORE_NO_SHADOW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not restore shadow database.</p>
<p class="tableblock">If the shadow database is configured, an absolute path to the shadow is stored in the backup file.
If such backup file is restored on a different system where the path does not exist (e.g. moving
a database from Windows to Linux or otherwise), the restore will fail. Using this option allows to
overcome such situations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTORE_NO_VALIDITY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not restore validity constraints.</p>
<p class="tableblock">This option is usually needed when the validity constraints (e.g. NOT NULL constraints) were added after the data were already in the database but the database contains records that do not satisfy such constraints<sup class="footnote">[<a id="_footnoteref_12" class="footnote" href="#_footnotedef_12" title="View footnote.">12</a>]</sup>.</p>
<p class="tableblock">When this option is specified, the validity constraints won&#8217;t be restored. This allows to recover
the data and perform cleanup tasks. The application and/or database administrators are responsible
for restoring the validity constrains afterwards.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTORE_ONE_AT_A_TIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commit after completing restore of each table.</p>
<p class="tableblock">By default all data is restored in one transaction. If for some reason a complete restore is not
possible, using this option will allow to restore at least some of the data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTORE_USE_ALL_SPACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not reserve 20% on each page for the future versions, useful for read-only databases.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example of using these options:</p>
</div>
<div class="listingblock">
<div class="title">Example of using extended options for restore</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">BackupManager restoreManager = new FBBackupManager();

restoreManager.setHost("localhost");
restoreManager.setPort(3050);
restoreManager.setUser("SYSDBA");
restoreManager.setPassword("masterkey");
restoreManager.setLogger(System.out);
restoreManager.setVerbose(true);

restoreManager.setRestoreReplace(true); // attention!!!

restoreManager.setDatabase("C:/database/employee.fdb");
restoreManager.setBackupPath("C:/database/employee.fbk");

// restore database with no indexes,
// validity constraints and shadow database
backupManager.restoreDatabase(
    BackupManager.RESTORE_DEACTIVATE_INDEX |
    BackupManager.RESTORE_NO_VALIDITY |
    BackupManager.RESTORE_NO_SHADOW |
    BackupManager.RESTORE_ONE_AT_A_TIME);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_management"><a class="anchor" href="#_user_management"></a>7.3. User management</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Starting with Firebird 3, user management through the Services API has been
deprecated. You should use the SQL DDL statements for user management instead.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The next service available is the user management. The routines are
defined in the <code>UserManager</code> interface and are implemented in the
<code>FBUserManager</code> class. Additionally, there is an <code>User</code> interface
providing getters and setters for properties of a user account on the
server and corresponding implementation in the <code>FBUser</code> class.<sup class="footnote">[<a id="_footnoteref_13" class="footnote" href="#_footnotedef_13" title="View footnote.">13</a>]</sup> The available properties of the <code>FBUser</code> class
are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique name of the user on the Firebird server. Required.
Maximum length is 31 byte.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponding password.
Getter return value only if the password had been set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>firstName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First name of the user. Optional.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>middleName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Middle name of the user. Optional.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lastName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last name of the user. Optional.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the user on Unix. Optional.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groupId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the group on Unix. Optional.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The management class, <code>FBUserManager</code> has following methods to
manipulate the user accounts on the server:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getUsers():Map</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method delivers a map containing user names as keys and instances of <code>FBUser</code> class as values containing all users that are registered on the server.
The instances of <code>FBUser</code> class do not contain passwords, the corresponding property is <code>null</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addUser(User)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register the user account on the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateUser(User)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update the user account on the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deleteUser(User)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete the user account on the server.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example of using the <code>FBUserManager</code> class:</p>
</div>
<div class="listingblock">
<div class="title">Example of FBUserManager class usage</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">UserManager userManager = new FBUserManager();

userManager.setHost("localhost");
userManager.setPort(3050);
userManager.setUser("SYSDBA");
userManager.setPassword("masterkey");

User user = new FBUser();
user.setUserName("TESTUSER123");
user.setPassword("test123");
user.setFirstName("John");
user.setMiddleName("W.");
user.setLastName("Doe");

userManager.add(user);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_database_maintenance"><a class="anchor" href="#_database_maintenance"></a>7.4. Database maintenance</h3>
<div class="paragraph">
<p>Database maintenance is something that everybody would prefer to
avoid, and, contrary to the backup/restore and user management
procedures, there is little automation that can be done here. Usually the
maintenance tasks are performed on the server by the database
administrator, but some routines are needed to perform the automated
database upgrade or perform periodic checks of the database validity.</p>
</div>
<div class="paragraph">
<p>This chapter describes the methods declared in the <code>MaintenanceManager</code>
interface and its implementation, the <code>FBMaintenanceManager</code> class.</p>
</div>
<div class="sect3">
<h4 id="_database_shutdown_and_restart"><a class="anchor" href="#_database_shutdown_and_restart"></a>7.4.1. Database shutdown and restart</h4>
<div class="paragraph">
<p>One of the most often used maintenance operations is database shutdown
and/or bringing it back online. When the database was shutdown only the
user that initiated the shutdown, either SYSDBA or the database owner, can
connect to the database and perform other tasks, e.g. metadata
modification or database validation and repair.</p>
</div>
<div class="paragraph">
<p>The database shutdown is performed by <code>shutdownDatabase(int, int)</code>
method. The first parameter is the shutdown mode, the second – maximum
allowed time for operation.</p>
</div>
<div class="paragraph">
<p>There are three shutdown modes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Shutdown mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHUTDOWN_ATTACH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The shutdown process is initiated and it is not possible to obtain a new connection to the database, but the currently open connections are fully functional.</p>
<p class="tableblock">When after the maximum allowed time for operation there are still open connections to the database, the shutdown process is aborted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHUTDOWN_TRANSACTIONAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The shutdown process is started and it is not possible to start new transactions or open new connections to the database.
The transactions that were running at the time of shutdown initiation are fully functional.</p>
<p class="tableblock">When after the maximum allowed time for operation there are still running transactions, the shutdown process is aborted.</p>
<p class="tableblock">If no running transactions are found, the currently open connections are allowed to disconnect.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHUTDOWN_FORCE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The shutdown process is started and will be completed before or when the maximum allowed time for operation is reached.
New connections and transactions are not prohibited during the wait.</p>
<p class="tableblock">After that any running transaction won&#8217;t be able to commit.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>After database shutdown, the owner of the database or SYSDBA can
connect to it and perform maintenance tasks, e.g. migration to the new
data model<sup class="footnote">[<a id="_footnoteref_14" class="footnote" href="#_footnotedef_14" title="View footnote.">14</a>]</sup>, validation of the
database, changing the database file configuration.</p>
</div>
<div class="paragraph">
<p>To bring the database back online use the <code>bringDatabaseOnline()</code> method.</p>
</div>
</div>
<div class="sect3">
<h4 id="_shadow_configuration"><a class="anchor" href="#_shadow_configuration"></a>7.4.2. Shadow configuration</h4>
<div class="paragraph">
<p>A database shadow is an in-sync copy of the database that is usually
stored on a different hard disk, possibly on a remote
computer<sup class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnotedef_15" title="View footnote.">15</a>]</sup>, which can be used as a primary database if the main
database server crashes. Shadows can be defined using <code>CREATE SHADOW</code>
SQL command and are characterized by a <em>mode</em> parameter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in the AUTO mode database continues operating even if shadow becomes
unavailable (disk or file system failure, remote node is not accessible,
etc.)</p>
</li>
<li>
<p>in the MANUAL mode all database operations are halted until the
problem is fixed. Usually it means that DBA has to kill the unavailable
shadow and define a new one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>MaintenanceManager</code> provides a <code>killUnavailableShadows()</code> method to
kill the unavailable shadows. This is equivalent to the <code>gfix -kill</code>
command.</p>
</div>
<div class="paragraph">
<p>Additionally, if the main database becomes unavailable, the DBA can decide
to switch to the shadow database. In this case the shadow must be
activated before use. To activate the shadow use the
<code>activateShadowFile()</code> method. Please note, that in this case the
<code>database</code> property of the <code>MaintenanceManager</code> must point to the shadow
file which must be located on the local file system of the server to
which the management class is connected.</p>
</div>
</div>
<div class="sect3">
<h4 id="_database_validation_and_repair"><a class="anchor" href="#_database_validation_and_repair"></a>7.4.3. Database validation and repair</h4>
<div class="paragraph">
<p>The Firebird server does its best to keep the database file in a
consistent form. In particular this is achieved by a special algorithm
called <em>careful writes</em> which guarantees that the server writes data on
disk in such a manner that despite events like a server crash the database file
always remains in a consistent state. Unfortunately, it is still possible
that under certain conditions, e.g. crash of the file system or hardware
failure, the database file might become corrupted. Firebird server can
detect such cases including</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Orphan pages. These are the database pages that were allocated for
subsequent write, but due to a crash were not used. Such pages have to
be marked as unused to return storage space back to the application;</p>
</li>
<li>
<p>Corrupted pages. These are the database pages that were caused by the
operating system or hardware failures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>MaintenanceManager</code> class provides a <code>validateDatabase()</code> method to
perform simple health check of the database, and releasing the orphan
pages if needed. It also reports presence of the checksum errors. The
output of the routine is written to the output stream configured in the
<code>logger</code> property.</p>
</div>
<div class="paragraph">
<p>The <code>validateDatabase(int)</code> method can be used to customize the
validation process:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Validation mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VALIDATE_READ_ONLY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform read-only validation.
In this case the database file won&#8217;t be repaired, only the presence of the database file errors will be reported.</p>
<p class="tableblock">Can be used for periodical health-check of the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VALIDATE_FULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do a full check on record and pages structures, releasing unassigned record fragments.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VALIDATE_IGNORE_CHECKSUM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignore checksums during repair operations.</p>
<p class="tableblock">The checksum error means that the database page was overwritten in a random order and the data stored on it are corrupted.
When this option is specified, the validation process will succeed even if checksum errors are present.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In order to repair the corrupted database use the <code>markCorruptRecords()</code>
method which marks the corrupted records as unavailable. This method is
equivalent to <code>gfix -mend</code> command. After this operation database can be
backed up and restored to a different place.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The presence of the checksum errors and subsequent use of
<code>markCorruptedRecords()</code> method will mark all corrupted data as unused
space. You have to perform a careful check after backup/restore cycle to
assess the damage.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_limbo_transactions"><a class="anchor" href="#_limbo_transactions"></a>7.4.4. Limbo transactions</h4>
<div class="paragraph">
<p>Limbo transactions are transactions that were prepared for commit
but were never committed. This can happen when, for example, the database
was accessed by JTA-enabled applications from Java<sup class="footnote">[<a id="_footnoteref_16" class="footnote" href="#_footnotedef_16" title="View footnote.">16</a>]</sup>. The in-limbo transactions affect the normal database
operation, since the records that were modified in that transactions are
not available – Firebird does not know whether the new version will be
committed or rolled back and blocks access to them. Also in-limbo
transactions prevents garbage collection, since the garbage collector
does not know whether it can discard the record versions of the in-limbo
transaction.</p>
</div>
<div class="paragraph">
<p>Jaybird contains functionality to allow the JTA-enabled
transaction coordinator to recover the in-limbo transactions and either
commit them or perform a rollback. For the cases when this is not
possible <code>MaintenanceManager</code> provides the following methods to perform this
in interactive mode:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>listLimboTransactions()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method lists IDs of all in-limbo transactions to the output stream specified in logger property.</p>
<p class="tableblock">The application has to either parse the output to commit or rollback the transactions in some
automated fashion or it should present the output to the user and let him/her make a decision.
Alternatively, use one of the following two methods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>limboTransactionsAsList()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a <code>List&lt;Long&gt;</code> of the IDs of all in-limbo transactions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getLimboTransactions()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of <code>long</code> with the IDs of all in-limbo transactions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>commitTransaction(long)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commit the transaction with the specified ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rollbackTransaction(long)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rollback the transaction with the specified ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_sweeping_the_database"><a class="anchor" href="#_sweeping_the_database"></a>7.4.5. Sweeping the database</h4>
<div class="paragraph">
<p>The in-limbo transactions are not the only kind of transactions that
prevent garbage collection. Another type are transactions are those that
were finished by "rollback" and the changes made in such transactions
were not automatically undone by the internal savepoint mechanism,
e.g. when there were a lot of changes made in the transaction (e.g.
10,000 records and more). Such transactions are marked as "rollback"
transactions on Transaction Inventory Page and this prevents advancing the
so-called Oldest Interesting Transaction (OIT) – ID of the oldest
transaction which created record versions that are relevant to any of
the currently running transactions. On each access to the records,
Firebird has to check all the record versions between the current
transaction and the OIT, which leads to performance degradation on large
databases. In order to solve the issue Firebird periodically starts a
database sweeping process, that traverses all database records, removes
the changes made by the rolled back transactions and moves forward the
OIT.<sup class="footnote">[<a id="_footnoteref_17" class="footnote" href="#_footnotedef_17" title="View footnote.">17</a>]</sup></p>
</div>
<div class="paragraph">
<p>The sweep process is controlled by a threshold parameter – a difference
between the Next Transaction and OIT, by default it equal to 20,000.
While this value is ok for the average database, a DBA can decide to
increase or decrease the number to fit the database usage scenario.
Alternatively, a DBA can trigger the sweep process manually regardless of
the current difference between Next Transaction and OIT.</p>
</div>
<div class="paragraph">
<p>The <code>MaintenanceManager</code> provides following methods to help with
database sweeping:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setSweepThreshold(int)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the threshold between Next Transaction and OIT that will trigger the automatic sweep process.
Default value is 20,000.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sweepDatabase()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform the sweep regardless of the current difference between Next Transaction and OIT.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_other_database_properties"><a class="anchor" href="#_other_database_properties"></a>7.4.6. Other database properties</h4>
<div class="paragraph">
<p>There are a few other properties of the database that can be set via
<code>MaintenanceManager</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setDatabaseAccessMode(int)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Change the access mode of the database.
Possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ACCESS_MODE_READ_ONLY</code> to make database read-only;</p>
</li>
<li>
<p><code>ACCESS_MODE_READ_WRITE</code> to allow writes into the database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note, only read-only databases can be placed on read-only media, the read-write databases will need to be able to write even if only accessed with read-only transactions.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setDatabaseDialect(int)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change the database SQL dialect.
The allowed values can be either 1 or 3.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setDefaultCacheBuffer(int)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change the number of database pages to cache.</p>
<p class="tableblock">This setting applies to this specific database, overriding the system-wide configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setForcedWrites(boolean)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change the forced writes setting for the database.</p>
<p class="tableblock">When forced writes are switched off, the database engine does not enforce flushing pending changes
to disk and they are kept in OS cache. Tthe same page is changed again later, the write happens in
memory, which in many cases increases the performance. However, in case of OS or hardware crashes
the database will be corrupted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setPageFill(int)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set the page fill factor.</p>
</div>
<div class="paragraph">
<p>Firebird leaves 20% of free space on each database page for future record versions.
It is possible to tell Firebird not to reserve the space, this makes sense for read-only databases,
since more data fit the page, which increases performance.</p>
</div>
<div class="paragraph">
<p>Possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PAGE_FILL_FULL</code> – do not reserve additional space for future versions;</p>
</li>
<li>
<p><code>PAGE_FILL_RESERVE</code> – reserve the free space for future record versions.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_database_statistics"><a class="anchor" href="#_database_statistics"></a>7.5. Database statistics</h3>
<div class="paragraph">
<p>And last but not least is the <code>StatisticsManager</code> interface and
corresponding implementation in the <code>FBStatisticsManager</code> class, which
allow to obtain statistical information for the database, like page
size, values of OIT and Next transactions, database dialect, database
page allocation and its distribution.</p>
</div>
<div class="paragraph">
<p>The following methods provide the functionality equivalent to the
<code>gstat</code> command line tool, the output of the commands is written to the
output stream specified in the <code>logger</code> property. It is the
responsibility of the application to correctly parse the text output if
needed.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getDatabaseStatistics()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get complete statistics about the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getDatabaseStatistics(int)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the statistical information for the specified options.</p>
</div>
<div class="paragraph">
<p>Possible values are (bit mask, can be combined):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DATA_TABLE_STATISTICS</code></p>
</li>
<li>
<p><code>SYSTEM_TABLE_STATISTICS</code></p>
</li>
<li>
<p><code>INDEX_STATISTICS</code></p>
</li>
<li>
<p><code>RECORD_VERSION_STATISTICS</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getHeaderPage()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get information from the header page (e.g. page size, OIT, OAT and Next transaction values, etc.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getTableStatistics(String[])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get statistic information for the specified tables.</p>
<p class="tableblock">This method allows to limit the reported statistical information to a single or couple of the tables, not for the whole database.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="events"><a class="anchor" href="#events"></a>8. Working with Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Firebird supports events. Events are a feature that provides asynchronous notification to the
connected applications about events triggered by the database or other applications. Instead of
requiring applications to reread the database tables to check for the changes, events make it
possible to avoid that: triggers in the database can post an event in case of a change. And even
more, the event can be so specific that an application would need to reread only a limited set of
records, possibly only one.</p>
</div>
<div class="paragraph">
<p>This chapter describes the event mechanism in Firebird and the common usage scenarios.</p>
</div>
<div class="sect2">
<h3 id="_database_events"><a class="anchor" href="#_database_events"></a>8.1. Database events</h3>
<div class="paragraph">
<p>An <em>event</em> is a message generated in a trigger, stored procedure or execute block that
is delivered to subscribed applications. The event is characterized only
by a name which is used when the event is posted, therefore two different
events must have two different names. The applications that subscribe
for events are required to specify the event names of interest,
no wildcards are allowed; and applications either provide a
callback function that will be invoked in case of event or are required
to poll for the posted events periodically.</p>
</div>
<div class="paragraph">
<p>Events are delivered to the application only on (after) commit of the transaction that generated
the event. Firebird does not provide any guarantees about the time of event delivery – it depends on
the load of the Firebird engine, application load, network delays between application and
the database system. The database engine will continue operating even if no
application subscribes to events or when the subscribed application
crashed in the meantime.</p>
</div>
<div class="paragraph">
<p>It can also happen that multiple transactions will be committed before
the events are delivered to the client system. But even in such case the
callback function will be invoked only once, and only the event name and
the count of the events will be passed as parameters. The same applies to
periodical polling – the application will receive event names and counts of
the events since last polling.</p>
</div>
<div class="paragraph">
<p>Internally, Firebird can be thought to store the subscription information
in a table where columns contain event names, rows correspond to the
subscribed applications and the cells contain the count of the
particular event for a particular application. When an event is posted in
trigger or stored procedure, Firebird checks the subscription information
and increases the event count for the subscribed applications. Another
thread checks the table periodically and notifies the application about
all new events relevant to the particular application. Such mechanism
allows Firebird to keep the event notification table very
small<sup class="footnote">[<a id="_footnoteref_18" class="footnote" href="#_footnotedef_18" title="View footnote.">18</a>]</sup> and to
reduce the number of messages sent to the application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is not possible to pass parameters with the event, e.g. an
ID of the modified records. It is also not possible to encode such
information in the event names – wildcards are not supported. For
such cases, applications should maintain a change tracking table where
the IDs of the modified records are stored and the event mechanism is
used to tell the application that new records were added to the table.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_posting_events"><a class="anchor" href="#_posting_events"></a>8.2. Posting events</h3>
<div class="paragraph">
<p>Events are posted from PSQL procedural code (trigger, stored procedure, execute block, function)
using the <code>POST_EVENT</code> command. It is possible to create a stored
procedure with the sole purpose of posting events:</p>
</div>
<div class="listingblock">
<div class="title">Example of posting events from PSQL code</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">CREATE PROCEDURE sp_post_event(event_name VARCHAR(72))
AS BEGIN
  POST_EVENT :event_name;
END</code></pre>
</div>
</div>
<div class="paragraph">
<p>Firebird 2.0 introduced a new command <code>EXECUTE BLOCK</code> which allows to
execute PSQL statements within DSQL code:</p>
</div>
<div class="listingblock">
<div class="title">Using EXECUTE BLOCK to post events</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">Statement stmt = connection.createStatement();
try {
  stmt.execute(
      "EXECUTE BLOCK AS BEGIN POST_EVENT 'some_evt'; END");
} finally {
  stmt.close();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subscribing_to_events"><a class="anchor" href="#_subscribing_to_events"></a>8.3. Subscribing to events</h3>
<div class="paragraph">
<p>The design of the classes and interfaces in the <code>org.firebirdsql.event</code>
package is similar to the Services API support – there is a central
manager-class that establishes a database connection and provides
service methods to work with the events, a callback interface that
applications must implement to use the asynchronous event notification
and an interface representing a database event with two properties –
event name and occurrence count.</p>
</div>
<div class="paragraph">
<p>Applications have to configure the following properties before starting
use of the implementation <code>EventManager</code> interface:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name or the IP address of the host to which we subscribe for events. <em>Required</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port to which we connect to, 3050 by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to the database.
The path is specified for the remote host but must be absolute. <em>Required</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the user on behalf of which we connect to the database. <em>Required</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password corresponding to the specified user. <em>Required</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>After configuring these properties, the application has to invoke the
<code>connect()</code> method to establish a physical connection to the database.
At this point the <code>EventManager</code> is ready to receive the event
notifications.</p>
</div>
<div class="paragraph">
<p>Now the application developer has two choices: use asynchronous event
notification or use methods that will block until an event is delivered
or timeout occurs.</p>
</div>
<div class="sect3">
<h4 id="_asynchronous_event_notification"><a class="anchor" href="#_asynchronous_event_notification"></a>8.3.1. Asynchronous event notification</h4>
<div class="paragraph">
<p>The asynchronous event notification uses a separate daemon thread to
wait for the event notifications and to deliver the events to the
registered listeners. The listeners are added using the
<code>addEventListener(String, EventListener)</code> method, where the first
parameter contains the name of the event to register on
and the second parameter – an instance of <code>EventListener</code> interface
that will be notified about occurrences of this event. It is allowed to use the same
instance of <code>EventListener</code> interface to listen on different events. The
code below shows an example of using asynchronous event
notification.</p>
</div>
<div class="listingblock">
<div class="title">Example of registering an event listener for asynchronous event notification</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">EventManager eventManager = new FBEventManager();

eventManager.setHost("localhost");
eventManager.setUser("SYSDBA");
eventManager.setPassword("masterkey");
eventManager.setDatabase("c:/database/employee.fdb");

eventManager.connect();

eventManager.addEventListener("test_event",
    new EventListener() {
      public void eventOccurred(DatabaseEvent event){
        System.out.println("Event [" +
            event.getEventName() + "] occured " +
            event.getEventCount() + " time(s)");
      }
    }
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_blocking_methods"><a class="anchor" href="#_using_blocking_methods"></a>8.3.2. Using blocking methods</h4>
<div class="paragraph">
<p>Alternatively, an application can use the synchronous methods, one that
blocks until the named event is received – the <code>waitForEvent(String)</code>
method, or one that will block until the named event is received or
timeout specified in the second parameter occurs – the
<code>waitForEvent(String, int)</code> method. The following shows an example of
using the blocking methods.</p>
</div>
<div class="listingblock">
<div class="title">Example of blocking waiting for event with a specified timeout</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">EventManager eventManager = new FBEventManager();

eventManager.setHost("localhost");
eventManager.setUser("SYSDBA");
eventManager.setPassword("masterkey");
eventManager.setDatabase("c:/database/employee.fdb");

eventManager.connect();

int eventCount =
    eventManager.waitForEvent("test_event", 10 * 1000);

System.out.println(
    "Received " + eventCount + " event(s) during 10 sec.");</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="reference" class="sect0"><a class="anchor" href="#reference"></a>Reference Manual</h1>
<div class="sect1">
<h2 id="ref-connection"><a class="anchor" href="#ref-connection"></a>9. Connection reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ref-wirecrypt"><a class="anchor" href="#ref-wirecrypt"></a>9.1. Wire encryption support</h3>
<div class="paragraph">
<p><em class="since">Jaybird 3.0.4</em><br>
<em class="since">Firebird 3</em></p>
</div>
<div class="paragraph">
<p>Firebird 3 and higher have support for encrypting the data sent over the network.
This <em>wire encryption</em> is configured using the connection property <code>wireCrypt</code>, with the following (case-insensitive) values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>DEFAULT</code></dt>
<dd>
<p>default (value used when <code>wireCrypt</code> is not specified; you&#8217;d normally not specify <code>DEFAULT</code> explicitly)</p>
</dd>
<dt class="hdlist1"><code>ENABLED</code></dt>
<dd>
<p>enable, but not require, wire encryption</p>
</dd>
<dt class="hdlist1"><code>REQUIRED</code></dt>
<dd>
<p>require wire encryption (only if Firebird version is 3.0 or higher)</p>
</dd>
<dt class="hdlist1"><code>DISABLED</code></dt>
<dd>
<p>disable wire encryption</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The default value acts as <code>ENABLED</code> for pure Java connections, for JNA (native) connections this wil use the fbclient default (either <code>Enabled</code> or the configured value of <code>WireCrypt</code> from a <code>firebird.conf</code> read by the native library).</p>
</div>
<div class="paragraph">
<p>Connection property <code>wireCrypt=REQUIRED</code> will <strong>not</strong> reject unencrypted connections when connecting to Firebird 2.5 or lower.
This behavior matches the Firebird 3 client library behavior.
The value will also be ignored when using native connections with a Firebird 2.5 client library.</p>
</div>
<div class="paragraph">
<p>Using <code>wireCrypt=DISABLED</code> when Firebird 3 or higher uses setting <code>WireCrypt = Required</code> (or vice versa) will yield error <em>"Incompatible wire encryption levels requested on client and server"</em> (error: <em>isc_wirecrypt_incompatible / 335545064</em>).</p>
</div>
<div class="paragraph">
<p>The same error is raised when connecting to Firebird 3 and higher with a legacy authentication user with connection property <code>wireCrypt=REQUIRED</code>.</p>
</div>
<div class="paragraph">
<p>Alternative wire encryption plugins are currently not supported, although we made some preparations to support this.
If you want to develop such a plugin, contact us on the Firebird-Java mailing list so we can work out the details of adding plugin support.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The implementation comes with a number of caveats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>we cannot guarantee that the session key cannot be obtained by someone with access to your application or the machine hosting your application (although that in itself would already imply a severe security breach)</p>
</li>
<li>
<p>the ARC4 encryption - the default provided by Firebird - is considered to be a weak (maybe even broken) cipher these days</p>
</li>
<li>
<p>the encryption cipher uses ARCFOUR with a 160 bits key, this means that the unlimited Cryptographic Jurisdiction Policy needs to be used (or at minimum a custom policy that allows ARCFOUR with 160 bits keys). See also FAQ entry <a href="https://www.firebirdsql.org/file/documentation/drivers_documentation/java/faq.html#encryption-key-did-not-meet-algorithm-requirements-of-symmetricarc4-337248282" target="_blank" rel="noopener">Encryption key did not meet algorithm requirements of Symmetric/Arc4 (337248282)</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ref-dbcrypt"><a class="anchor" href="#ref-dbcrypt"></a>9.2. Database encryption support</h3>
<div class="paragraph">
<p><em class="since">Jaybird 3.0.4</em><br>
<em class="since">Firebird 3</em></p>
</div>
<div class="paragraph">
<p>Jaybird 3.0.4 added support for Firebird 3 database encryption callbacks in the pure Java implementation of the version 13 protocol.</p>
</div>
<div class="paragraph">
<p>The current implementation is simple and only supports replying with a static value from a connection property.
Be aware that a static value response for database encryption is not very secure as it can easily lead to replay attacks or unintended key exposure.</p>
</div>
<div class="paragraph">
<p>Future versions of Jaybird (likely 4, maybe 5) will introduce plugin support for database encryption plugins that require a more complex callback.</p>
</div>
<div class="paragraph">
<p>The static response value of the encryption callback can be set through the <code>dbCryptConfig</code> connection property.
Data sources and <code>ServiceManager</code> implementations have an equivalent property with the same name.
This property can be set as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Absent or empty value: empty response to callback (depending on the database encryption plugin this may just work or yield an error later)</p>
</li>
<li>
<p>Strings prefixed with <code>base64:</code>: rest of the string is decoded as base64 to bytes.
The <code>=</code> padding characters are optional, but when present they must be valid (that is: if you use padding, you must use the right number of padding characters for the length)</p>
</li>
<li>
<p>Plain string value: string is encoded to bytes using UTF-8, and these bytes are used as the response</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because of the limitation of connection URL parsing, we strongly suggest to avoid plain string values with <code>&amp;</code> or <code>;</code>.
Likewise, avoid <code>:</code> so that we can support other prefixes similar to <code>base64:</code> in the future.
If you need these characters, consider using a base64 encoded value instead.</p>
</div>
<div class="paragraph">
<p>For service operations, as implemented in the <code>org.firebirdsql.management</code> package, Firebird requires the <code>KeyHolderPlugin</code> configuration to be globally defined in <code>firebird.conf</code>.
Database-specific configuration in <code>databases.conf</code> will be ignored for service operations.
Be aware that some service operations on encrypted databases are not supported by Firebird 3 (eg <code>gstat</code> equivalents other than <code>gstat -h</code> or <code>gstat -e</code>).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Other warnings and limitations</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Database encryption callback support is only available in the pure Java implementation.
Support for native and embedded connections will be added in a future version.</p>
</li>
<li>
<p>The database encryption callback does not require an encrypted connection, so the key can be exchanged unencrypted if wire protocol encryption has been disabled client-side or server-side, or if legacy authentication is used.
Consider setting connection property <code>wireCrypt=REQUIRED</code> to force encryption (caveat: see the next point).</p>
</li>
<li>
<p>Firebird may ask for the database encryption key before the connection has been encrypted (for example if the encrypted database itself is used as the security database).
<em>This applies to v15 protocol support, which is not yet available.</em></p>
</li>
<li>
<p>The improvements of the versions 14 and 15 wire protocol are not implemented, and as a result encrypted security databases (external or security database hosted in the database itself) will not work unless the encryption plugin does not require a callback.
Support for the version 15 wire protocol will be added in a future version.</p>
</li>
<li>
<p>We cannot guarantee that the <code>dbCryptConfig</code> value cannot be obtained by someone with access to your application or the machine hosting your application (although that in itself would already imply a severe security breach).</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ref-defaultholdable"><a class="anchor" href="#ref-defaultholdable"></a>9.3. Default holdable result sets</h3>
<div class="paragraph">
<p>This connection property enables a connection to create holdable result sets by default.
This propery can be used as a workaround for applications that expect a result to remain open after commit, or have expectations regarding result sets in auto-commit mode that do not conform to the JDBC specification.</p>
</div>
<div class="paragraph">
<p>Specifically, such applications open a result set and, while traversing it, execute other statements using the same connection.
According to the JDBC specification the result set has to be closed if another statement is executed using the same connection in auto-commit mode.
With the default result set holdability, close on commit, doing this yields a <code>SQLException</code> with message <em>"The result set is closed"</em>.</p>
</div>
<div class="paragraph">
<p>The property is called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>defaultResultSetHoldable</code> as connection property with no value, empty value or <code>true</code> (aliases: <code>defaultHoldable</code> and <code>result_set_holdable</code>);</p>
</li>
<li>
<p><code>isc_dpb_result_set_holdable</code> as a DPB member;</p>
</li>
<li>
<p><code>FirebirdConnectionProperties</code> interface methods <code>isDefaultResultSetHoldable()</code> and <code>setDefaultResultSetHoldable(boolean)</code></p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The price for using this feature is that each holdable result set will be fully cached in memory.
The memory occupied by this result set will be released when the statement that produced the result set is either closed or re-executed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ref-firebirdautocommit"><a class="anchor" href="#ref-firebirdautocommit"></a>9.4. Firebird auto commit mode (experimental)</h3>
<div class="paragraph">
<p><em class="since">Jaybird 2.2.9</em></p>
</div>
<div class="paragraph">
<p>This option is enabled by specifying the connection property <code>useFirebirdAutocommit=true</code>.</p>
</div>
<div class="paragraph">
<p>With this option, Jaybird will configure the transaction to use <code>isc_tpb_autocommit</code> with <code>autoCommit=true</code>.
This means that Firebird server will internally commit the transaction after each statement completion.
Jaybird itself will not commit until connection close (or switching to <code>autoCommit=false</code>).
The exception is if the statement was of type <code>isc_info_sql_stmt_ddl</code>, in that case Jaybird will commit on statement success and rollback on statement failure (just like it does for all statements in normal auto commit mode).
The reason is that Firebird for some DDL commands only executes at a real commit boundary and relying on the Firebird auto-commit is insufficient.</p>
</div>
<div class="paragraph">
<p>On statement completion (as specified in JDBC), result sets will still close unless they are holdable over commit.
The result set is only closed client side, which means that the cursor remains open server side to prevent roundtrips.
This may lead to additional resource usage server side unless explicitly closed in the code.
Note that any open blobs will be closed client- and server-side (until this is improved with <a href="http://tracker.firebirdsql.org/browse/JDBC-401" target="_blank" rel="noopener">JDBC-401</a>).</p>
</div>
<div class="paragraph">
<p>A connection can be interrogated using <code>FirebirdConnection.isUseFirebirdAutocommit()</code> if it uses <code>isc_tpb_autocommit</code>.</p>
</div>
<div class="paragraph">
<p>If you manually add <code>isc_tpb_autocommit</code> to the transaction parameter buffer and you enable this option, the <code>isc_tpb_autocommit</code> will be removed from the TPB if <code>autoCommit=false</code>.</p>
</div>
<div class="paragraph">
<p>Artificial testing with repeated inserts (using a prepared statement) against a Firebird server on localhost shows that this leads to a reduction of execution time of +/- 7%.</p>
</div>
<div class="paragraph">
<p>Support for this option is experimental, and should only be enabled if you 1) know what you&#8217;re doing, and 2) really need this feature.
Internally <code>isc_tpb_autocommit</code> uses <code>commit_retaining</code>, which means that using this feature may increase the transaction gap with associated sweep and garbage collection impact.</p>
</div>
</div>
<div class="sect2">
<h3 id="ref-processinfo"><a class="anchor" href="#ref-processinfo"></a>9.5. Process information</h3>
<div class="paragraph">
<p><em class="since">Jaybird 2.1.6</em><br>
<em class="since">Firebird 2.1</em></p>
</div>
<div class="paragraph">
<p>Firebird 2.1 introduced the <code>MON$ATTACHMENTS</code> table.
This table includes the columns <code>MON$REMOTE_PID</code> and <code>MON$REMOTE_PROCESS</code> which report the process id and process name of the connected process.</p>
</div>
<div class="paragraph">
<p>By default, Jaybird does not provide this information.
This has two main reasons: until recently Java did not have a portable way of retrieving the process id, and in most cases the process name is just 'java' (or similar), which is not very useful.</p>
</div>
<div class="paragraph">
<p>Since Firebird 3, the <code>MON$ATTACHMENTS</code> table also includes the column <code>MON$CLIENT_VERSION</code>.
Jaybird (<em class="since">Jaybird 3.0</em>) will report its full version (eg <code>Jaybird 3.0.5-JDK_1.8</code>).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do not use this information for security decisions.
Treat it as informational only, as clients can report fake information.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to specify the process name and process id in two ways:</p>
</div>
<div class="sect3">
<h4 id="ref-processinfo-systemprop"><a class="anchor" href="#ref-processinfo-systemprop"></a>9.5.1. System properties for process information</h4>
<div class="paragraph">
<p>It is possible to specify the process information through Java system properties:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.pid</code></dt>
<dd>
<p>Process id</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.processName</code></dt>
<dd>
<p>Process name</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This is the preferred method because you only need to specify it once.</p>
</div>
</div>
<div class="sect3">
<h4 id="ref-processinfo-connprops"><a class="anchor" href="#ref-processinfo-connprops"></a>9.5.2. Connection properties for process information</h4>
<div class="paragraph">
<p>It is also possible to specify the process information through connection properties:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>process_id</code></dt>
<dd>
<p>Process id (alias: <code>processId</code> (<em class="since">Jaybird 3</em>))</p>
</dd>
<dt class="hdlist1"><code>process_name</code></dt>
<dd>
<p>Process name (alias: <code>processName</code> (<em class="since">Jaybird 3</em>))</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties are not exposed on the data sources.
To set on data sources, use <code>setNonStandardProperty</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ref-statement"><a class="anchor" href="#ref-statement"></a>10. Statement reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ref-generatedkeys"><a class="anchor" href="#ref-generatedkeys"></a>10.1. Generated keys retrieval</h3>
<div class="paragraph">
<p><em class="since">Jaybird 2.2</em><br>
<em class="since">Firebird 2.0</em></p>
</div>
<div class="paragraph">
<p>Jaybird 2.2 added support for the <code>getGeneratedKeys()</code> JDBC feature for <code>Statement</code> and <code>PreparedStatement</code>.
This feature can be used to retrieve the generated ids (and other columns) from DML statements.</p>
</div>
<div class="paragraph">
<p>This feature is available for <code>Connection.prepareStatement</code>, and <code>Statement.execute</code>, <code>Statement.executeUpdate</code> and <code>Statement.executeLargeUpdate</code> (<em class="since">Java 8/JDBC 4.2</em>)</p>
</div>
<div class="paragraph">
<p>There are four distinct use-cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Methods accepting an <code>int</code> parameter with values of <code>Statement.NO_GENERATED_KEYS</code> and <code>Statement.RETURN_GENERATED_KEYS</code>, see <a href="#ref-generatedkeys-RETURN-GENERATED-KEYS">Basic generated keys retrieval</a>,</p>
</li>
<li>
<p>Methods accepting an <code>int[]</code> parameter with column indexes, see <a href="#ref-generatedkeys-column-index">Generated keys by column index</a>.</p>
</li>
<li>
<p>Methods accepting a <code>String[]</code> parameter with column names, see <a href="#ref-generatedkeys-column-name">Generated keys by column name</a>.</p>
</li>
<li>
<p>Providing a query already containing a <code>RETURNING</code> clause to any of these methods.</p>
<div class="paragraph">
<p>In this case all of the previous cases are ignored and the query is executed as is.
It is possible to retrieve the result set using <code>getGeneratedKeys()</code>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The generated keys functionality will only be available if the ANTLR runtime classes are on the classpath.
Except for calling methods with <code>NO_GENERATED_KEYS</code>, absence of the ANTLR runtime will throw <code>FBDriverNotCapableException</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The required ANTLR runtime version depends on the Jaybird version, check the release notes of your version for details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This functionality is available for <code>INSERT</code> (<em class="since">Firebird 2.0</em>), for <code>UPDATE</code>, <code>UPDATE OR INSERT</code> and <code>DELETE</code> (<em class="since">Firebird 2.1</em>), and for <code>MERGE</code> (<em class="since">Firebird 3.0</em>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Generated keys retrieval modifies the statement to add a <code>RETURNING</code>-clause.
Currently Firebird only supports <code>RETURNING</code> for DML operations that affect a single row.
Attempting to use generated keys retrieval with a statement that affects multiple rows will yield an error.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The examples in this section use the following (Firebird 3) table:</p>
</div>
<div class="listingblock">
<div class="title">Example person table</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">create table PERSON (
  ID integer generated by default as identity constraint pk_employee primary key,
  FIRSTNAME varchar(20),
  LASTNAME varchar(20),
  BIRTHDATE date,
  "age" integer generated always as (datediff(year, birthdate, current_date))
)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="ref-generatedkeys-RETURN-GENERATED-KEYS"><a class="anchor" href="#ref-generatedkeys-RETURN-GENERATED-KEYS"></a>10.1.1. Basic generated keys retrieval</h4>
<div class="paragraph">
<p>This form of generated keys execution involves the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Connection.prepareStatement(String sql, int autoGeneratedKeys)</code></p>
</li>
<li>
<p><code>Statement.execute(String sql, int autoGeneratedKeys)</code></p>
</li>
<li>
<p><code>Statement.executeUpdate(String sql, int autoGeneratedKeys)</code></p>
</li>
<li>
<p><code>Statement.executeLargeUpdate(String sql, int autoGeneratedKeys)</code> (<em class="since">JDBC 4.2</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>NO_GENERATED_KEYS</code> is passed, the query will be executed as a normal query.</p>
</div>
<div class="paragraph">
<p>When <code>RETURN_GENERATED_KEYS</code> is passed, the driver will return <em>*all*</em> columns of the table as generated keys.
The columns are ordered by ordinal position (as reported in the JDBC metadata of the table).
It is advisable to retrieve the values from the <code>getGeneratedKeys()</code> result set by column name.</p>
</div>
<div class="paragraph">
<p>We opted to include all columns as it is next to impossible to decide which columns are populated by a trigger or otherwise.
Only returning the primary key will be too restrictive (consider computed columns, default values, etc).</p>
</div>
<div class="paragraph">
<p>Passing <code>NO_GENERATED_KEYS</code> hardcoded should normally not be done.
It would be better to use the equivalent <code>prepareStatement</code> or <code>executeXXX</code> method that only accepts a <code>String</code>.
Use of the value <code>NO_GENERATED_KEYS</code> only makes sense in code that dynamically decides between <code>NO_GENERATED_KEYS</code> and <code>RETURN_GENERATED_KEYS</code>.</p>
</div>
<div class="sect4">
<h5 id="ref-generatedkeys-examples-RETURN-GENERATED-KEYS"><a class="anchor" href="#ref-generatedkeys-examples-RETURN-GENERATED-KEYS"></a>Example using RETURN_GENERATED_KEYS</h5>
<div class="paragraph">
<p>The following will insert a person using a <code>Statement</code> and retrieve the generated id using <code>Statement.RETURN_GENERATED_KEYS</code>:</p>
</div>
<div class="listingblock">
<div class="title">Statement generated keys retrieval</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Connection connection = ...;
try (Statement statement = connection.createStatement()) {
  statement.executeUpdate(
      "insert into person(firstname, lastname, birthdate) "
          + "values ('Mark', 'Rotteveel', date'1979-01-12')",
      Statement.RETURN_GENERATED_KEYS);                 <i class="conum" data-value="1"></i><b>(1)</b>

  try (ResultSet keys = statement.getGeneratedKeys()) { <i class="conum" data-value="2"></i><b>(2)</b>
    if (keys.next()) {                                  <i class="conum" data-value="3"></i><b>(3)</b>
      int generatedId = keys.getInt("id");              <i class="conum" data-value="4"></i><b>(4)</b>
      int age = keys.getInt("age");                     <i class="conum" data-value="5"></i><b>(5)</b>
      String firstName = keys.getString("firstname");   <i class="conum" data-value="6"></i><b>(6)</b>

      System.out.printf("Inserted: %s, Id: %d, Age: %d%n",
          firstName, generatedId, age);
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use of <code>Statement.RETURN_GENERATED_KEYS</code> instructs Jaybird to parse the statement and add a <code>RETURNING</code> clause with all columns of the <code>PERSON</code> table</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Get the generated keys result set from the statement</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Just like a normal result set, it is positioned before the first row, so you need to call <code>next()</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The generated value of the <code>ID</code> column</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The calculated value of the <code>AGE</code> column</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The generated keys result set also contains the normal columns like <code>FIRSTNAME</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The equivalent using <code>PreparedStatement</code> is:</p>
</div>
<div class="listingblock">
<div class="title">Prepared statement generated keys retrieval</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (PreparedStatement statement = connection.prepareStatement(
         "insert into person(firstname, lastname, birthdate) values (?, ?, ?)",
         Statement.RETURN_GENERATED_KEYS)) {            <i class="conum" data-value="1"></i><b>(1)</b>
  statement.setString(1, "Mark");
  statement.setString(2, "Rotteveel");
  statement.setObject(3, LocalDate.of(1979, 1, 12));

  statement.executeUpdate();
  try (ResultSet keys = statement.getGeneratedKeys()) { <i class="conum" data-value="2"></i><b>(2)</b>
    if (keys.next()) {                                  <i class="conum" data-value="3"></i><b>(3)</b>
      int generatedId = keys.getInt("id");              <i class="conum" data-value="4"></i><b>(4)</b>
      int age = keys.getInt("age");                     <i class="conum" data-value="5"></i><b>(5)</b>
      String firstName = keys.getString("firstname");

      System.out.printf("Inserted: %s, Id: %d, Age: %d%n",
          firstName, generatedId, age);
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Besides use of parameters, the only real difference is that use of <code>Statement.RETURN_GENERATED_KEYS</code> moved from execution to prepare.
This makes sense if you consider that once prepared, the statement can be reused.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-generatedkeys-column-index"><a class="anchor" href="#ref-generatedkeys-column-index"></a>10.1.2. Generated keys by column index</h4>
<div class="paragraph">
<p>This form of generated keys execution involves the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Connection.prepareStatement(String sql, int[] columnIndexes)</code></p>
</li>
<li>
<p><code>Statement.execute(String sql, int[] columnIndexes)</code></p>
</li>
<li>
<p><code>Statement.executeUpdate(String sql, int[] columnIndexes)</code></p>
</li>
<li>
<p><code>Statement.executeLargeUpdate(String sql, int[] columnIndexes)</code> (<em class="since">JDBC 4.2</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The values in the <code>int[]</code> parameter are the ordinal positions of the columns as specified in the (JDBC) metadata of the table.
For a null or empty array the statement is processed as is.
Invalid ordinal positions are ignored and silently dropped (be aware: the JDBC specification is not entirely clear if this is valid behavior, so this might change in the future)</p>
</div>
<div class="sect4">
<h5 id="ref-generatedkeys-examples-column-index"><a class="anchor" href="#ref-generatedkeys-examples-column-index"></a>Example using column indexes</h5>
<div class="paragraph">
<p>Retrieval by column index uses the ordinal position as reported in <code>DatabaseMetaData.getColumns</code>, column <code>ORDINAL_POSITION</code>.
In practice this is the value of <code>RDB$RELATION_FIELDS.RDB$FIELD_POSITION + 1</code> of that column.</p>
</div>
<div class="paragraph">
<p>In our example, the columns are</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ID</code></p>
</li>
<li>
<p><code>FIRSTNAME</code></p>
</li>
<li>
<p><code>LASTNAME</code></p>
</li>
<li>
<p><code>BIRTHDATE</code></p>
</li>
<li>
<p><code>age</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Prepared statement generated keys retrieval by index</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (PreparedStatement statement = connection.prepareStatement(
         "insert into person(firstname, lastname, birthdate) values (?, ?, ?)",
         new int[] { 1, 5 })) {                         <i class="conum" data-value="1"></i><b>(1)</b>
  statement.setString(1, "Mark");
  statement.setString(2, "Rotteveel");
  statement.setObject(3, LocalDate.of(1979, 1, 12));

  statement.executeUpdate();
  try (ResultSet keys = statement.getGeneratedKeys()) {
    if (keys.next()) {
      int generatedId = keys.getInt("id");              <i class="conum" data-value="2"></i><b>(2)</b>
      int age = keys.getInt(2);                         <i class="conum" data-value="3"></i><b>(3)</b>

      System.out.printf("Id: %d, Age: %d%n",
          generatedId, age);
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of <code>Statement.RETURN_GENERATED_KEYS</code>, the column indices are passed in an array, in this case <code>1</code> for <code>ID</code> and <code>5</code> for <code>age</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Retrieval of the first column, <code>ID</code>, by name</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Retrieval of the second column, <code>age</code>, by id.
Notice that the index used for retrieval does not match the position (5) passed in the prepare.
As this is the second column, it is retrieved from the result set by <code>2</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Invalid ordinal positions are currently ignored and silently dropped: passing <code>new int[] { 1, 5, 6 }</code> will work, even though we don&#8217;t have sixth column.
This behavior may change in future Jaybird versions</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-generatedkeys-column-name"><a class="anchor" href="#ref-generatedkeys-column-name"></a>10.1.3. Generated keys by column name</h4>
<div class="paragraph">
<p>This form of generated keys execution involves the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Connection.prepareStatement(String sql, String[] columnNames)</code></p>
</li>
<li>
<p><code>Statement.execute(String sql, String[] columnNames)</code></p>
</li>
<li>
<p><code>Statement.executeUpdate(String sql, String[] columnNames)</code></p>
</li>
<li>
<p><code>Statement.executeLargeUpdate(String sql, String[] columnNames)</code> (<em class="since">JDBC 4.2</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The values in the <code>String[]</code> are the column names to be returned.
The column names provided are processed as is and are not checked for validity or the need of quoting.
Providing non-existent or incorrectly (un)quoted columns will result in an exception when the statement is processed by Firebird (be aware: the JDBC specification is not entirely clear if this is valid behavior, so this might change in the future).
This method is the fastest as it does not retrieve metadata from the server.</p>
</div>
<div class="sect4">
<h5 id="ref-generatedkeys-examples-column-name"><a class="anchor" href="#ref-generatedkeys-examples-column-name"></a>Example using column names</h5>
<div class="listingblock">
<div class="title">Prepared statement generated keys retrieval by name</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">try (PreparedStatement statement = connection.prepareStatement(
         "insert into person(firstname, lastname, birthdate) values (?, ?, ?)",
         new String[] { "id", "\"age\"" })) {           <i class="conum" data-value="1"></i><b>(1)</b>
  statement.setString(1, "Mark");
  statement.setString(2, "Rotteveel");
  statement.setObject(3, LocalDate.of(1979, 1, 12));

  statement.executeUpdate();
  try (ResultSet keys = statement.getGeneratedKeys()) {
    if (keys.next()) {
      int generatedId = keys.getInt("id");
      int age = keys.getInt("age");

      System.out.printf("Id: %d, Age: %d%n",
          generatedId, age);
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The column names are passed as is, this means that correct quoting is required for case sensitive columns (and other names that require quoting).</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The requirement to pass column names correctly quoted is not specified in the JDBC standard.
It may change in future Jaybird versions to conform with column names as returned from <code>DatabaseMetaData.getColumn</code>.
That is, unquoted exactly as stored in <code>RDB$RELATION_FIELDS.RDB$FIELD_NAME</code>.
Quoting the column names would then be done by Jaybird.</p>
</div>
<div class="paragraph">
<p>When this changes, a connection property for backwards compatibility will be provided.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-generatedkeys-limitations"><a class="anchor" href="#ref-generatedkeys-limitations"></a>10.1.4. Limitations</h4>
<div class="paragraph">
<p>Jaybird 2.2 does not support generated keys retrieval for batch execution of prepared statements.
Support for generated key retrieval with batch execution was introduced in Jaybird 3.0.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ref-general"><a class="anchor" href="#ref-general"></a>11. General</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ref-logging"><a class="anchor" href="#ref-logging"></a>11.1. Logging</h3>
<div class="paragraph">
<p>Jaybird logs a variety of information during its work.</p>
</div>
<div class="paragraph">
<p>For logging, jaybird uses the following log levels:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Jaybird log level</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>trace</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">low-level debug information</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>debug</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">debug information</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>info</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">informational messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>warn</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">warnings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>error</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">errors</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>fatal</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">severe/fatal errors (though in general, level <em>error</em> will be used instead of <em>fatal</em>)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="ref-logging-jul"><a class="anchor" href="#ref-logging-jul"></a>11.1.1. java.util.logging</h4>
<div class="paragraph">
<p><em class="since">Jaybird 3</em></p>
</div>
<div class="paragraph">
<p>Since Jaybird 3, logging will use <code>java.util.logging</code> by default.</p>
</div>
<div class="paragraph">
<p>Jaybird applies the following mapping for its log levels:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Jaybird log level</th>
<th class="tableblock halign-left valign-top"><em>jul</em> log level</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Logger.trace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Level.FINER</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Logger.debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Level.FINE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Logger.info</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Level.INFO</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Logger.warn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Level.WARNING</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Logger.error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Level.SEVERE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Logger.fatal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Level.SEVERE</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="ref-logging-disable"><a class="anchor" href="#ref-logging-disable"></a>11.1.2. Disable logging</h4>
<div class="paragraph">
<p><em class="since">Jaybird 3</em></p>
</div>
<div class="paragraph">
<p>To disable logging, specify system property <code>org.firebirdsql.jdbc.disableLogging</code> with value <code>true</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ref-logging-console"><a class="anchor" href="#ref-logging-console"></a>11.1.3. Console logging</h4>
<div class="paragraph">
<p><em class="since">Jaybird 2.2.8</em></p>
</div>
<div class="paragraph">
<p>Jaybird can write its logging to the <code>System.out</code> for <em>info</em> and lower and <code>System.err</code> for <em>warn</em> and above.
Levels <em>debug</em> and <em>trace</em> are disabled in the implementation.</p>
</div>
<div class="paragraph">
<p>To enable logging console, you can set system property <code>org.firebirdsql.jdbc.forceConsoleLogger</code> (<em class="since">Jaybird 3</em>) or <code>org.firebirdsql.jdbc.fallbackConsoleLogger</code> (<em class="since">Jaybird 2.2.8</em> <em class="until">Jaybird 3</em>) to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>The Jaybird 2.2.8 <code>org.firebirdsql.jdbc.fallbackConsoleLogger</code> only logs to console if Log4j logging is not enabled or Log4j is not on the classpath.</p>
</div>
</div>
<div class="sect3">
<h4 id="ref-logging-custom"><a class="anchor" href="#ref-logging-custom"></a>11.1.4. Custom logging implementation</h4>
<div class="paragraph">
<p><em class="since">Jaybird 3</em></p>
</div>
<div class="paragraph">
<p>Since Jaybird 3, you can provide your own logging implementation if you don&#8217;t want to use <code>java.util.logging</code> or console logging.</p>
</div>
<div class="paragraph">
<p>To provide a custom logging implementation, you need to implement interface <code>org.firebirdsql.logging.Logger</code>.
This implementation must be public and must have a public constructor with a single String argument for the logger name.
Set system property <code>org.firebirdsql.jdbc.loggerImplementation</code> with the fully-qualified name of your implementation.</p>
</div>
<div class="paragraph">
<p>The <code>org.firebirdsql.logging.Logger</code> interface should be considered volatile and might change in minor releases (but not point/bugfix releases).</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package org.example.jaybird.logging;

public class CustomLogger implements org.firebirdsql.logging.Logger {
    public CustomLogger(String name) {
        // create the logger
    }
    // implementation of org.firebirdsql.logging.Logger interface
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the Java command line, specify:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>-Dorg.firebirdsql.jdbc.loggerImplementation=org.example.jaybird.logging.CustomLogger</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-logging-log4j1"><a class="anchor" href="#ref-logging-log4j1"></a>11.1.5. Log4j 1.x</h4>
<div class="paragraph">
<p><em class="until">Jaybird 3</em></p>
</div>
<div class="paragraph">
<p>Jaybird 2.2 and earlier can log to Log4J 1.x.
This requires the log4j 1.x library on the classpath and system property <code>FBLog4j</code> (or <em class="since">Jaybird 2.2.8</em> <code>org.firebirdsql.jdbc.useLog4j</code>) set to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>If you want to use Log4j 1.x with Jaybird 3 or higher, you will need to create your own logger implementation (see <a href="#ref-logging-custom">Custom logging implementation</a>).</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="_appendices" class="sect0"><a class="anchor" href="#_appendices"></a>Appendices</h1>
<div class="sect1">
<h2 id="connectionproperties"><a class="anchor" href="#connectionproperties"></a>Appendix A: Extended connection properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jaybird has a number of connection properties that can be used to configure a connection.</p>
</div>
<div class="paragraph">
<p>This appendix provides a list of most connection properties and a short explanation to each of them.
The properties listed below are usable as JDBC connection properties.</p>
</div>
<div class="paragraph">
<p>The properties marked as <em>boolean property</em> can be included in the JDBC URL with values <code>true</code>, but also without a value, or with an empty value.
The default for these properties is always <code>false</code>.
For readability we suggest that you only specify these properties explicitly when you want to enable them, and if you do, to use explicit value <code>true</code>.</p>
</div>
<div class="paragraph">
<p>A subset of these properties is also exposed in the <code>javax.sql.DataSource</code> implementations in Jaybird.
When using data sources, unexposed properties can be set using <code>setNonStandardProperty</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Connection property (+ aliases)</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>user</code><br>
<code>userName</code>, <code>user_name</code>, <code>isc_dpb_user_name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the user for the connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>password</code><br>
<code>isc_dpb_password</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password corresponding to the specified user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>encoding</code><br>
<code>lc_ctype</code>, <code>isc_dpb_lc_ctype</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Character encoding for the connection using the Firebird character set name.
This property tells the database server the encoding in which it expects character content.
For a list of the available encodings see <a href="#_available_encodings">Available Encodings</a>.<br>
Default: <code>NONE</code> (unless <code>charSet</code> is specified).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>charSet</code><br>
<code>localEncoding</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Character set for the connection using Java character set name.
Similar to the previous property, however instead of Firebird-specific name allows using a Java character set name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>roleName</code><br>
<code>sqlRole</code>, <code>sql_role_name</code>, <code>isc_dpb_sql_role_name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the SQL role for the specified connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>sqlDialect</code><br>
<code>dialect</code> (<em class="since">Jaybird 3</em>), <code>sql_dialect</code>, <code>isc_dpb_sql_dialect</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>SQL dialect, can be 1, 2 and 3.<br>
Default: 3 (in Jaybird 2.2 and earlier the default is a combination of dialect 3 and the actual database dialect)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>authPlugins</code><br>
<code>auth_plugin_list</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property (<em class="since">Jaybird 4</em>).
Specifies the list of authentication plugins to try.
<strong>TODO</strong> Improve documentation (define reference section based on Jaybird 4 release notes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>wireCrypt</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Jaybird specific property (<em class="since">Jaybird 3.0.4</em>).
Allowed values: <code>DEFAULT</code>, <code>ENABLED</code>, <code>REQUIRED</code>, <code>DISABLED</code> (case insensitive).
Configures Firebird 3 wire encryption behaviour.
See <a href="#ref-wirecrypt">Wire encryption support</a> for more information.<br>
Default: <code>DEFAULT</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>dbCryptConfig</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property (<em class="since">Jaybird 3.0.4</em>).
Configures Firebird 3 database encryption support.
See <a href="#ref-dbcrypt">Database encryption support</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>process_id</code><br>
<code>processId</code> (<em class="since">Jaybird 3</em>), <code>isc_dpb_process_id</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the process id reported to Firebird.
See <a href="#ref-processinfo">Process information</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>process_name</code><br>
<code>processName</code> (<em class="since">Jaybird 3</em>), <code>isc_dpb_process_name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the process name reported to Firebird.
See <a href="#ref-processinfo">Process information</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>defaultHoldable</code><br>
<code>defaultResultSetHoldable</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Set result sets to be holdable by default.
A workaround for applications with incorrect assumptions on result sets in auto-commit mode.
See <a href="#ref-defaultholdable">Default holdable result sets</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>useFirebirdAutocommit</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property (<em class="since">Jaybird 2.2.9</em>).
Boolean property.
Enable experimental feature to use Firebird auto-commit for JDBC auto-commit mode.
See <a href="#ref-firebirdautocommit">Firebird auto commit mode (experimental)</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>generatedKeysEnabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property (<em class="since">Jaybird 4</em>).
Configure generated keys support behaviour.
<strong>TODO</strong> Improve documentation (define reference section based on Jaybird 4 release notes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>isolation</code><br>
<code>defaultIsolation</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Jaybird specific property.
Specify the default transaction isolation level.
Accepted values are: <code>TRANSACTION_NONE</code>, <code>TRANSACTION_READ_UNCOMMITTED</code>, <code>TRANSACTION_READ_COMMITTED</code>, <code>TRANSACTION_REPEATABLE_READ</code>, <code>TRANSACTION_SERIALIZABLE</code> (case sensitive).
Although <code>TRANSACTION_NONE</code> and <code>TRANSACTION_READ_UNCOMMITTED</code> are allowed values, these behave the same as <code>TRANSACTION_READ_COMMITTED</code>.<br>
Default: <code>TRANSACTION_READ_COMMITTED</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>socketBufferSize</code><br>
<code>socket_buffer_size</code>, <code>isc_dpb_socket_buffer_size</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Tells Jaybird Type 4 driver the size of the socket buffer.
Should be used on the systems where default socket buffer provided by JVM is not correct.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>blobBufferSize</code><br>
<code>blob_buffer_size</code>, <code>isc_dpb_blob_buffer_size</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Tells the driver the size of the buffer that is used to transfer BLOB content.
It is recommended to keep the value equal to <code>n * &lt;database page size&gt;</code> (and preferably also socket buffer size).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>soTimeout</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Socket blocking timeout in milliseconds.
Only has effect on Type 4 (pure Java) connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>connectTimeout</code><br>
<code>connect_timeout</code>, <code>isc_dpb_connect_timeout</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connect timeout in seconds (<em class="since">Jaybird 2.2.2</em>).
For the Java wire protocol the connect timeout will detect unreachable hosts.
In the JNI/JNA implementation (native protocol) the connect timeout works as the DPB item <code>isc_dpb_connect_timeout</code> which only works after connecting to the server for the <code>op_accept</code> phase of the protocol.
This means that – for the native protocol – the connect timeout will not detect unreachable hosts within the timeout.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>columnLabelForName</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property (<em class="since">Jaybird 2.2.1</em>).
Boolean property.
Set property to <code>true</code> for backwards compatible behaviour (<code>getColumnName()</code> returns the column label).
Don&#8217;t set the property or set it to <code>false</code> for JDBC-compliant behaviour (recommended).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>useStreamBlobs</code><br>
<code>use_stream_blobs</code>, <code>isc_dpb_use_stream_blobs</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Tells the driver to create stream BLOBs.
By default segmented BLOBs are created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ignoreProcedureType</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property (<em class="since">Jaybird 3.0.6</em>).
Boolean property.
Set property to <code>true</code> to disable usage of procedure type metadata to decide to use <code>SELECT</code> for selectable procedure instead of <code>EXECUTE PROCEDURE</code>.
<strong>TODO</strong> Improve documentation (define reference section based on Jaybird 3.0.6 release notes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>octetsAsBytes</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Unused since Jaybird 3, will be removed in Jaybird 4.
Makes <code>ResultSet.getObject</code> for <code>(VAR)CHAR CHARACTER SET OCTETS</code> return <code>byte[]</code> instead of <code>String</code>.
Since Jaybird 3, this is the default behaviour (with further enhancements to identify these columns as JDBC <code>(VAR)BINARY</code>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>useStandarUdf</code><br>
<code>use_standard_udf</code>, <code>isc_dpb_use_standard_udf</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Tells the JDBC driver to assume that standard UDF library is registered in the database when converting escaped function calls.
With recent versions of Firebird, it is advisable to not specify this property and rely on the built-in functions instead.
See <a href="#jdbcescape">Supported JDBC Scalar Functions</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>timestampUsesLocalTimezone</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Changes how <code>getTime</code>/<code>getTimestamp</code> methods accepting a <code>java.util.Calendar</code> apply the calendar offset in calculations.
<strong>TODO</strong>: Improve documentation on exact effect</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>num_buffers</code><br>
<code>isc_dpb_num_buffers</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of database pages that will be cached.
Overrides server or database default for this specific connection.
Use with care to avoid using an excessive amount of memory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>set_db_readonly</code><br>
<code>isc_dpb_set_db_readonly</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean property.
Set the database into read-only state.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>set_db_sql_dialect</code><br>
 <code>isc_dpb_set_db_sql_dialect</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the SQL dialect of the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>set_db_charset</code><br>
<code>isc_dpb_set_db_charset</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the default character set of the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>paranoia_mode</code><br>
<code>isc_dpb_paranoia_mode</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Unused since Jaybird 2.2.
Tells the driver to throw exception in situations not covered by the specification.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>noResultSetTracking</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Boolean property.
Unused since at least Jaybird 2.2, will be removed in Jaybird 4.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>useTranslation</code><br>
<code>mapping_path</code>, <code>isc_dpb_mapping_path</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird specific property.
Deprecated, will be removed in Jaybird 4.
This allows mapping of characters to be overridden (see <code>translation/hpux.properties</code> in Jaybird jar for example).
Value is the path to a mapping properties file.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition, Jaybird allows using arbitrary Database Parameters Block entries as connection properties (provided they are defined in Jaybird&#8217;s <code>org.firebirdsql.gds.ISCConstants</code>).
The current Firebird API has almost 90 DPB parameters, however only few of them are interesting for regular users.
If a DPB item called <code>isc_dpb_XXX</code> exists, then Jaybird allows these to be specified as <code>isc_dpb_XXX</code> and <code>XXX</code>.
By default properties are mapped as string DPB items.
If a DPB item requires another type, it will need to be explicitly defined in Jaybird.</p>
</div>
<div class="sect2">
<h3 id="connectionproperties-isolation-levels"><a class="anchor" href="#connectionproperties-isolation-levels"></a>A.1. Transaction isolation levels</h3>
<div class="paragraph">
<p>It is possible to redefine the transaction isolation levels through connection properties.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Connection property</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TRANSACTION_READ_COMMITTED</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specify the definition of transaction isolation level <code>READ_COMMITTED</code>.<br>
Default: <code>isc_tpb_read_committed,isc_tpb_rec_version,isc_tpb_write,isc_tpb_wait</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TRANSACTION_REPEATABLE_READ</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the definition of transaction isolation level <code>REPEATABLE_READ</code>.<br>
Default: <code>isc_tpb_concurrency,isc_tpb_write,isc_tpb_wait</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TRANSACTION_SERIALIZABLE</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the definition of transaction isolation level <code>TRANSACTION_SERIALIZABLE</code>.<br>
Default: <code>isc_tpb_consistency,isc_tpb_write,isc_tpb_wait</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For data sources, this feature is exposed using a definition properties file and the <code>setTpbMapping</code> property.
See <a href="#transactions-isolation-levels">Transaction Isolation Levels</a> for more information.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="systemproperties"><a class="anchor" href="#systemproperties"></a>Appendix B: System properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jaybird provides a number of system properties to control global behaviour of Jaybird.</p>
</div>
<div class="sect2">
<h3 id="systemproperties-logging"><a class="anchor" href="#systemproperties-logging"></a>B.1. Logging</h3>
<div class="paragraph">
<p>To configure logging, the following system properties are available.
See <a href="#ref-logging">Logging</a> for details.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.fallbackConsoleLogger</code></dt>
<dd>
<p><em class="since">Jaybird 2.2.8</em> <em class="until">Jaybird 3</em>
Set to true for fallback to log to console if log4j is not used or not available</p>
</dd>
<dt class="hdlist1"><code>FBLog4j</code></dt>
<dd>
<p><em class="until">Jaybird 3</em>
Set to true to attempt to use log4j (if on classpath) for logging</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.useLog4j</code></dt>
<dd>
<p><em class="since">Jaybird 2.2.8</em> <em class="until">Jaybird 3</em>
Alias for <code>FBLog4j</code></p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.forceConsoleLogger</code></dt>
<dd>
<p><em class="since">Jaybird 3</em>
Set to true to force logging to console (<code>System.out</code> for info, <code>System.err</code> for warn, error and fatal) instead of default <code>java.util.logging</code></p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.disableLogging</code></dt>
<dd>
<p><em class="since">Jaybird 3</em>
Set to true to disable logging</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.loggerImplementation</code></dt>
<dd>
<p><em class="since">Jaybird 3</em>
Fully-qualified name of <code>org.firebirdsql.logging.Logger</code> implementation to use for logging</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties need to be set before Jaybird is loaded and used.</p>
</div>
</div>
<div class="sect2">
<h3 id="systemproperties-processinfo"><a class="anchor" href="#systemproperties-processinfo"></a>B.2. Process information</h3>
<div class="paragraph">
<p>For Firebird 2.1 and higher, Jaybird can provide Firebird with process information.
This information can be specified in connection properties, or globally using the following system properties.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.processName</code></dt>
<dd>
<p><em class="since">Jaybird 2.2</em>
Process name to send to Firebird</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.pid</code></dt>
<dd>
<p><em class="since">Jaybird 2.2</em>
PID to send to Firebird (must be a valid integer)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The property values are read for each connect, so the value can be changed at any time.</p>
</div>
</div>
<div class="sect2">
<h3 id="systemproperties-charset"><a class="anchor" href="#systemproperties-charset"></a>B.3. Character set defaults</h3>
<div class="paragraph">
<p>The following system properties control character set behaviour for connections.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.defaultConnectionEncoding</code></dt>
<dd>
<p><em class="since">Jaybird 3</em>
Firebird character set name to use as connection character set when no explicit connection character set is configured (defaults to <code>NONE</code> when not set)</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.jdbc.requireConnectionEncoding</code></dt>
<dd>
<p><em class="since">Jaybird 3.0.2</em>
Set to true to disallow connections without an explicit connection character set.
This property will have no effect if <code>org.firebirdsql.jdbc.defaultConnectionEncoding</code> has been set.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The property values are read for each connect, so the value can be changed at any time.</p>
</div>
</div>
<div class="sect2">
<h3 id="systemproperties-other"><a class="anchor" href="#systemproperties-other"></a>B.4. Other properties</h3>
<div class="paragraph">
<p>The following system properties control other global behaviour of Jaybird.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.firebirdsql.jna.syncWrapNativeLibrary</code></dt>
<dd>
<p><em class="since">Jaybird 3</em>
Set to true to add a synchronization proxy around the native client library.</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.datatypeCoderCacheSize</code></dt>
<dd>
<p><em class="since">Jaybird 4</em>
Integer value for the number of encoding specific data type coders cached (default and minimum is 1).
Setting to a higher value may improve performance, most common use case is connection character set <code>NONE</code> with a database that uses more than one character set for its columns.
Jaybird will log a warning (<em>"Cleared encoding specific datatype coder cache [..]"</em>) when the cache size was exceeded.</p>
</dd>
<dt class="hdlist1"><code>org.firebirdsql.nativeResourceShutdownDisabled</code></dt>
<dd>
<p><em class="since">Jaybird 4</em>
Set to true to disable automatic shutdown and unload of native libraries and other native resources.
Normally you should only use this if the automatic shutdown misbehaves and causes application errors.
If you need to set this to true, we&#8217;d appreciate it if you post a message to the Firebird-Java list with details on why you needed to enable this, so we can improve or fix this feature.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties need to be set before Jaybird is loaded and used.
Technically, <code>org.firebirdsql.jna.syncWrapNativeLibrary</code> is dynamic, but a native library will usually be loaded once.</p>
</div>
</div>
<div class="sect2">
<h3 id="systemproperties-java"><a class="anchor" href="#systemproperties-java"></a>B.5. Useful Java system properties</h3>
<div class="paragraph">
<p>The following Java system properties are relevant for Jaybird.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jdk.net.useFastTcpLoopback</code></dt>
<dd>
<p><em class="since">Firebird 3.0.2</em> <em class="since">Jave 8 update 60</em> <em class="since">Windows 8 / Windows Server 2012</em>
Set to true on Windows to enable "TCP Loopback Fast Path" (<code>SIO_LOOPBACK_FAST_PATH</code> socket option).
"TCP Loopback Fast Path" can improve performance for localhost connections.<br>
Java only has an 'all-or-nothing' support for the "TCP Loopback Fast Path", so Jaybird cannot enable this for you: you must specify this property on JVM startup.
This has the benefit that this works for all Jaybird versions, as long as you use Java 8 update 60 or higher (and Firebird 3.0.2 or higher).</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="datatypeconversion"><a class="anchor" href="#datatypeconversion"></a>Appendix C: Data Type Conversion Table</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_mapping_between_jdbc_firebird_and_java_types"><a class="anchor" href="#_mapping_between_jdbc_firebird_and_java_types"></a>C.1. Mapping between JDBC, Firebird and Java Types</h3>
<div class="paragraph">
<p>The below table describes a mapping of the JDBC data types defined in
<code>java.sql.Types</code> class to the Firebird data types. Also, for each JDBC
data type a class instance of which is returned by <code>ResultSet.getObject</code>
method is provided.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC Type</th>
<th class="tableblock halign-left valign-top">Firebird Type</th>
<th class="tableblock halign-left valign-top">Java Object Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VARCHAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VARCHAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LONGVARCHAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BLOB SUB_TYPE 1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NUMERIC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NUMERIC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigDecimal</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigDecimal</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SMALLINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SMALLINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Short</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INTEGER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INTEGER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Integer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIGINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIGINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Long</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Double</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DOUBLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DOUBLE PRECISION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Double</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LONGVARBINARY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BLOB SUB_TYPE 0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.sql.Date</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.sql.Time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMESTAMP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMESTAMP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.sql.Timestamp</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BLOB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BLOB SUB_TYPE &lt; 0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.sql.Blob</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_data_type_conversions"><a class="anchor" href="#_data_type_conversions"></a>C.2. Data Type Conversions</h3>
<div class="paragraph">
<p>This table specifies the compatible conversions between the Firebird and
Java types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 23.8095%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.7619%;">
<col style="width: 4.762%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><code>SMALLINT</code></th>
<th class="tableblock halign-left valign-top"><code>INTEGER</code></th>
<th class="tableblock halign-left valign-top"><code>BIGINT</code></th>
<th class="tableblock halign-left valign-top"><code>REAL</code></th>
<th class="tableblock halign-left valign-top"><code>FLOAT</code></th>
<th class="tableblock halign-left valign-top"><code>DOUBLE</code></th>
<th class="tableblock halign-left valign-top"><code>DECIMAL</code></th>
<th class="tableblock halign-left valign-top"><code>NUMERIC</code></th>
<th class="tableblock halign-left valign-top"><code>CHAR</code></th>
<th class="tableblock halign-left valign-top"><code>VARCHAR</code></th>
<th class="tableblock halign-left valign-top"><code>BLOB SUB_TYPE 1</code></th>
<th class="tableblock halign-left valign-top"><code>BLOB SUB_TYPE 0</code></th>
<th class="tableblock halign-left valign-top"><code>BLOB SUB_TYPE &lt; 0</code></th>
<th class="tableblock halign-left valign-top"><code>DATE</code></th>
<th class="tableblock halign-left valign-top"><code>TIME</code></th>
<th class="tableblock halign-left valign-top"><code>TIMESTAMP</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigDecimal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Blob</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Date</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Time</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Timestamp</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="poolproperties"><a class="anchor" href="#poolproperties"></a>Appendix D: Connection Pool Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter contains the list of properties of the
<code>ConnectionPoolDataSource</code>, <code>DataSource</code> and <code>XADataSource</code> interface
implementations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The documentation in this section is only valid for Jaybird 2.2 and earlier.</p>
</div>
<div class="paragraph">
<p>Connection pooling was removed from Jaybird 3.0.
Either use the connection pool provided by your application server, or use a third-party connection pool like <a href="https://www.mchange.com/projects/c3p0/" target="_blank" rel="noopener">c3p0</a>, <a href="https://commons.apache.org/proper/commons-dbcp/" target="_blank" rel="noopener">Apache DBCP</a> or <a href="https://brettwooldridge.github.io/HikariCP/" target="_blank" rel="noopener">HikariCP</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_standard_jdbc_properties"><a class="anchor" href="#_standard_jdbc_properties"></a>D.1. Standard JDBC Properties</h3>
<div class="paragraph">
<p>This group contains properties defined in the JDBC specification and
should be standard to all connection pools.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxIdleTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum time in milliseconds after which an idle connection in the pool is closed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxPoolSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of open physical connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minPoolSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum number of open physical connections.
If value is greater than 0, corresponding number of connections will be opened when first connection is obtained.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxStatements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum size of the prepared statement pool.
If zero, statement pooling is switched off.
When the application requests more statements than can be kept in the pool, Jaybird will allow creating those statements, however closing them would not return them back to the pool, but rather immediately release the resources.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_pool_properties"><a class="anchor" href="#_pool_properties"></a>D.2. Pool Properties</h3>
<div class="paragraph">
<p>This group of properties are specific to the Jaybird implementation of
the connection pooling classes.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>blockingTimeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum time in milliseconds during which application can be blocked waiting for a connection from the pool.
If no free connection can be obtained, an exception is thrown.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>retryInterval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Period in which the pool will try to obtain a new connection while blocking the application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pooling</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to switch connection pooling off.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>statementPooling</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to switch statement pooling off.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pingStatement</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Statement that will be used to "ping" the JDBC connection, in other words, to check if it is still alive.
This statement must always succeed.
he default SQL statement for the Firebird database is <code>"SELECT CAST(1 AS INTEGER) FROM rdb$database"</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pingInterval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time during which connection is believed to be valid in any case.
The pool "pings" the connection before giving it to the application only if more than specified amount of time passed since last "ping".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isolation</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Default transaction isolation level.
All connections returned from the pool will have this isolation level.
One of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TRANSACTION_READ_COMMITTED</code></p>
</li>
<li>
<p><code>TRANSACTION_REPEATABLE_READ</code></p>
</li>
<li>
<p><code>TRANSACTION_SERIALIZABLE</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>transactionIsolationLevel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer value from <code>java.sql.Connection</code> interface corresponding to the transaction isolation level specified in isolation property.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_runtime_pool_properties"><a class="anchor" href="#_runtime_pool_properties"></a>D.3. Runtime Pool Properties</h3>
<div class="paragraph">
<p>This group contains read-only properties that provide information about the state of the pool.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>freeSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tells how many free connections are in the pool.
Value is between 0 and <code>totalSize</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workingSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tells how many connections were taken from the pool and are currently used in the application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>totalSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total size of open connection.
At the pool creation – 0, after obtaining first connection – between <code>minPoolSize</code> and <code>maxPoolSize</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_firebird_specific_properties"><a class="anchor" href="#_firebird_specific_properties"></a>D.4. Firebird-specific Properties</h3>
<div class="paragraph">
<p>This group contains properties that specify parameters of the
connections that are obtained from this data source. Commonly used
parameters have the corresponding getter and setter methods, rest of the
Database Parameters Block parameters can be set using
<code>setNonStandardProperty</code> setter method.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to the database in the format <code>[host/port:]/path/to/database.fdb</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Type of the driver to use. Possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PURE_JAVA</code> or <code>TYPE4</code> for type 4 JDBC driver</p>
</li>
<li>
<p><code>NATIVE</code> or <code>TYPE2</code> for type 2 JDBC driver</p>
</li>
<li>
<p><code>EMBEDDED</code> for using embedded version of the Firebird</p>
</li>
<li>
<p><code>ORACLE</code> for accessing Oracle-mode Firebird</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>blobBufferSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the buffer used to transfer BLOB content.
Maximum value is 64k-1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>socketBufferSize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the socket buffer.
Needed on some Linux machines to fix performance degradation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>charSet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character set for the connection.
Similar to <code>encoding</code> property, but accepts Java names instead of Firebird ones.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>encoding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character encoding for the connection.
See Firebird documentation for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the user that will be used by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponding password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>roleName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL role to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tpbMapping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TPB mapping for different transaction isolation modes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_non_standard_parameters"><a class="anchor" href="#_non_standard_parameters"></a>D.5. Non-standard parameters</h3>
<div class="paragraph">
<p>Many of the above mentioned Firebird parameters have have a
corresponding DPB entry. However, not every DPB entry has a
corresponding getter/setter. This was done intentionally, Firebird
provides almost 70 DPB parameters, but for most of the applications only
few are needed. The remaining parameters are used by specialized
applications (usually server or database management software) for
setting some default values of the database, controlling the cache
buffers on the server, etc. Creating a corresponding getter/setter for
each of them simply does not make sense.</p>
</div>
<div class="paragraph">
<p>For those Java applications that still need non-standard connectivity
parameters, <code>DataSource</code> and <code>ConnectionPoolDataSource</code> implementations
provides a getter and two setters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getNonStandardProperty(String name)</code> method returns a non-standard
property specified by <code>name</code> parameter. If this property was not
previously set, <code>null</code> is returned.</p>
</li>
<li>
<p><code>setNonStandardProperty(String name, String value)</code> method sets the
property specified by the first parameter to a value contained in the
second parameter.</p>
</li>
<li>
<p><code>setNonStandardProperty(String nameValuePair)</code> method provides a
possibility to set a DPB parameter using following syntax:</p>
<div class="literalblock">
<div class="content">
<pre>dataSource.setNonStandardProperty("isc_dpb_sql_dialect=3");</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The parameter syntax of the last method is not very common in Java code,
it would be much more natural to use two-parameter setter. However, it
has a specialized use, because there&#8217;s no possibility to use
two-parameter setter method in configuration files. Usually, when
setting a configuration parameter of a data source, web-containers use
the Java reflection API and consider only those setters that take one
parameter. For instance, in the Tomcat server the configuration
parameter would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;parameter&gt;
  &lt;name&gt;nonStandardProperty&lt;/name&gt;
  &lt;value&gt;sql_dialect=3&lt;/value&gt;
&lt;/parameter&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Syntax of the parameter is</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;name&gt;[&lt;whitespace&gt;][{=|:|&lt;whitespace&gt;}[&lt;whitespace&gt;]&lt;value&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>&lt;name&gt;</code> is the name of the DPB parameter, and <code>&lt;value&gt;</code> is its
value. The two are separated by any combination of whitespace and either
whitespace or "=" (equal sign) or ":" (colon) characters. Considering
the aliases described in <a href="#connectionproperties">Extended connection properties</a>. For example following values are equivalent:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>isc_dpb_sql_dialect   3
isc_dpb_sql_dialect : 3
sql_dialect         : 3
sql_dialect=3</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="characterencoding"><a class="anchor" href="#characterencoding"></a>Appendix E: Character Encodings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Character encodings and their correct use with Firebird RDBMS from Java
is an important topic, that initially seems to be complex, but in fact
can be formulated by just a few rules. This appendix provides
information on this topic.</p>
</div>
<div class="sect2">
<h3 id="_encodings_types"><a class="anchor" href="#_encodings_types"></a>E.1. Encodings Types</h3>
<div class="paragraph">
<p>Firebird uses character encodings in two different areas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The database encoding defines a character set in which all <code>CHAR</code>,
<code>VARCHAR</code> and <code>BLOB SUB_TYPE 1</code> fields are physically stored on the disk.
There is a default database encoding that is specified during database
creation. It is also possible to specify character sets on per column
basis.</p>
</li>
<li>
<p>The client connection encoding defines a character set in which client
will send and expects to receive character data. This encoding might or
might not match the database default encoding.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Firebird RDBMS performs translation between character sets of the
client connection and the character set of the content. The list of
allowed character sets as well as the allowed translations between them
are specified in the <code>fbintl</code> shared library<sup class="footnote">[<a id="_footnoteref_19" class="footnote" href="#_footnotedef_19" title="View footnote.">19</a>]</sup>
located in the <code>intl/</code> directory of the Firebird installation. There is
also a special character set NONE that tells RDBMS not to interpret the
contents of the character field.</p>
</div>
<div class="paragraph">
<p>Firebird uses the following algorithm when performing translations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If source and target character sets match, send the content unchanged.</p>
</li>
<li>
<p>If the target character set is "NONE", send source content unchanged.</p>
</li>
<li>
<p>If the source character set is "NONE", send source content unchanged.</p>
</li>
<li>
<p>If there is a direct translation rule between source and target
character sets, use that rule.</p>
</li>
<li>
<p>If there is no direct translation rule, check if there is rule to
translate the source character set into the UTF8 character set and a
rule to translate from UTF8 into the target character set. If yes, use
these two rules for translation.</p>
</li>
<li>
<p>If no suitable translation rule can be found, throw an exception.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_encodings_in_java"><a class="anchor" href="#_encodings_in_java"></a>E.2. Encodings in Java</h3>
<div class="paragraph">
<p>Java programming language is based on the Unicode character set and uses
the UTF-16 encoding, in which each character is represented by one or
two 16-bit units. The Firebird, on the other side, is not based on
Unicode and allows different character sets to be assigned to different
database objects. Additionally, Firebird requires a connection character
set to be specified in connection options, which forces Firebird to
convert data from the character set of the database object into the
character set of the client application.</p>
</div>
<div class="paragraph">
<p>There are two boundary cases that we will consider here, one when
Firebird database was created with default<sup class="footnote">[<a id="_footnoteref_20" class="footnote" href="#_footnotedef_20" title="View footnote.">20</a>]</sup> character set UTF8,
another when Firebird database was created without specifying the
character set (i.e. character set NONE).</p>
</div>
<div class="paragraph">
<p>The UTF8 in Firebird 2.0 is a Unicode character set that uses UTF-8
encoding and occupies from one to four 8-bit units. Firebird supported
Unicode character set for a long time, however its implementation was
deficient – it did not support proper uppercasing and correct sorting.
These issues were addressed in the Firebird 2.0 release and at the
moment nothing prevents developers from using Unicode in the database
and on the client side, which greatly simplifies the
internationalization and localization of the applications. Jaybird JDBC
driver properly supports Firebird 2.0 since version
2.1.0<sup class="footnote">[<a id="_footnoteref_21" class="footnote" href="#_footnotedef_21" title="View footnote.">21</a>]</sup>.</p>
</div>
<div class="sect3">
<h4 id="_the_utf8_character_set"><a class="anchor" href="#_the_utf8_character_set"></a>E.2.1. The UTF8 character set</h4>
<div class="paragraph">
<p>Software developer must ensure two things to enable use of Unicode
characters in the database and the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the database objects must be defined with the UTF8 character set; this
can be done by either creating database with default UTF8 character set
or by adding <code>CHARACTER SET UTF8</code> clause to the column or domain
definitions.</p>
</li>
<li>
<p>the <code>encoding</code> connection property in the JDBC driver has to be set to
UTF8; this can be done several ways: the easiest one is to add the
appropriate parameter to the JDBC URL (see the first example). Another
possibility is to use appropriate method of the <code>DriverManager</code> class
(see the second example). The applications that use <code>DataSource</code>
interface to obtain the database connections also have access to the
<code>encoding</code> property<sup class="footnote">[<a id="_footnoteref_22" class="footnote" href="#_footnotedef_22" title="View footnote.">22</a>]</sup>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Specifying the connection encoding in JDBC URL</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Class.forName("org.firebirdsql.jdbc.FBDriver");

Connection connection = DriverManager.getConnection(
    "jdbc:firebirdsql:localhost/3050:employee?encoding=UTF8",
    "SYSDBA", "masterkey");</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Specifying connection encoding in the connection properties</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Class.forName("org.firebirdsql.jdbc.FBDriver");

Properties props = new Properties();

props.setProperty("user", "SYSDBA");
props.setProperty("password", "masterkey");
props.setProperty("encoding", "UTF8");

Connection connection = DriverManager.getConnection(
    "jdbc:firebirdsql:localhost/3050:employee", props);</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are few limitations related to using the UTF8 character set:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it is not possible to create Unicode columns longer than 8191 Unicode
characters; this limitation is caused by the fact that the longest
possible <code>VARCHAR</code> column can occupy 32765 bytes (32767 for <code>CHAR</code> columns)
and a single UTF8 character can occupy up to four bytes.</p>
</li>
<li>
<p>it is not possible to index Unicode columns longer than 1023
characters; this limitation is caused by the fact that the longest index
key cannot be longer than a quarter of the database page, which in
Firebird 2.0 can be maximum 16k and the before mentioned fact that each
UTF8 character can occupy up to four bytes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also it should be mentioned, that using Unicode character set might
cause noticeable performance degradation when database is used over the
wide-area networks. This mainly applies to the cases when Cyrillic
characters are stored in the database, since each character would occupy
two bytes of the network packet, which in turn might cause additional
roudtrips to the server to fetch data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_none_character_set"><a class="anchor" href="#_the_none_character_set"></a>E.2.2. The NONE character set</h4>
<div class="paragraph">
<p><strong>TODO</strong> Document changes in behavior introduced in Jaybird 3</p>
</div>
<div class="paragraph">
<p>Java introduces additional complexity when the NONE character set is
used. The reason for this is that Java internally stores all strings in
Unicode format, and the application must define the character encoding
for the byte contents to the JVM. When the NONE character set is used,
the driver does not know how to interpret the received data. The only
choice that is left to the driver is to construct a string using the
default character set of the JVM, which usually matches the regional
settings of the operating system and can be accessed from within the JVM
through the <code>file.encoding</code> system property.</p>
</div>
<div class="paragraph">
<p>It is clear that the conversion using default character set that happens
inside the JVM can lead to errors when the same content is accessed from
two or more different Java Virtual Machines that have different
configuration. One application running on the computer with, for
example, Russian regional settings saves the Russian text (the default
character set of the JVM is Cp1251) and another application running on
computer with German regional settings (default character set is Cp1252)
will read in such case some special or accented characters. However,
when all client applications run same OS with the same regional settings
in most cases will not have any severe consequences (except probably
wrong sorting order or uppercasing on the server side).</p>
</div>
<div class="paragraph">
<p>On Linux and other Unix platforms it might have more severe consequences
as it is very common that regional settings are not configured and that
the default "C" locale is used and the non-ASCII characters will be
replaced with question marks ("?").</p>
</div>
<div class="paragraph">
<p>Therefore, application should use NONE character encoding as an encoding
for a database and a connection only when at least one of the following
is met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Database will contain only ASCII characters</p>
</li>
<li>
<p>It is guaranteed that all Java Virtual Machines accessing the database
will have the same default encoding that can correctly handle all
characters stored in the database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a partial workaround one can specify the encoding that should be used
to interpret bytes coming from the server in the <code>charSet</code> connection
property. The following rules are used when interpreting the <code>encoding</code>
and <code>charSet</code> properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When only <code>encoding</code> property specified, driver uses the default
mapping between server and Java encodings. When <code>encoding</code> property is
not set or set to NONE and <code>charSet</code> property is not set, the default
JVM encoding is used to interpret bytes coming from the server.</p>
</li>
<li>
<p>When only <code>charSet</code> property is specified, driver uses the reverse
mapping to specify the connection encoding for the server and interprets
byte stream according to the value of the property.</p>
</li>
<li>
<p>When both <code>encoding</code> and <code>charSet</code> property are specified, driver sets
the connection encoding according to the value of the <code>encoding</code>
property, but interprets the byte stream according to the <code>charSet</code>
property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last case is most powerful, but also is the most dangerous in use.
When used properly, it can solve the problems with the legacy databases;
when used incorrectly, one can easily trash the content of the database.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_available_encodings"><a class="anchor" href="#_available_encodings"></a>E.3. Available Encodings</h3>
<div class="paragraph">
<p>The below table lists the available character encodings in the default
Firebird distribution and their mapping to the Java ones:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 10%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Firebird encoding (<code>encoding</code> property)</th>
<th class="tableblock halign-left valign-top">Java encoding (<code>charSet</code> property)</th>
<th class="tableblock halign-left valign-top">Size in bytes</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw bytes, no interpretation of the content is possible.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIG_5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Big5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Traditional Chinese</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS437</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp437</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: United States, Australia, New Zeland, South
Africa</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS737</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp737</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Greek</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS775</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp775</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Baltic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS850</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp850</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Latin-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS852</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp852</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Latin-2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS857</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp857</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM: Turkish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS858</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp858</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM: Latin-1 + Euro</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS860</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp860</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Portuguese</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS861</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp861</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Icelandic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS862</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp862</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM: Hebrew</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS863</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp863</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Canadian French</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS864</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp864</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM: Arabic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS865</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp865</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS: Nordic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS866</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp866</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM: Cyrillic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOS869</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp869</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM: Modern Greek</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EUCJ_0208</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EUC_JP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JIS X 0201, 0208, 0212, EUC encoding, Japanese</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GB_2312</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EUC_CN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GB2312, EUC encoding, Simplified Chinese</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-1, Latin alphabet No. 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8859_13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO-8859-13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8859-13</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KSC_5601</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS949</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows Korean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNICODE_FSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit Unicode Transformation Format (deprecated
since FB 2.0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit Unicode Transformation Format (FB 2.0+)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1250</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1250</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows Eastern European</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1251</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1251</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows Cyrillic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1252</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1252</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows Latin-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1253</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1253</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows Greek</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1254</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1254</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows Turkish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1255</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1255</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIN1257</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cp1257</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jdbcescape"><a class="anchor" href="#jdbcescape"></a>Appendix F: Supported JDBC Scalar Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>TODO</strong> Needs updating with support improved in Jaybird 3 and 4</p>
</div>
<div class="paragraph">
<p>The JDBC API supports the escaped syntax for numeric, string, time,
date, system and conversion functions. Jaybird will try to provide an
equivalent of the JDBC function using the built-in capabilities of the
Firebird database. When no equivalent is available, Jaybird will pass
the function call "as is" to the database assuming that it contains all
necessary UDF declarations.</p>
</div>
<div class="paragraph">
<p>Not all functions described in the JDBC specification have corresponding
built-in functions in Firebird, but are available in the standard UDF
library <code>ib_udf</code>&#8288;<sup class="footnote">[<a id="_footnoteref_23" class="footnote" href="#_footnotedef_23" title="View footnote.">23</a>]</sup> shipped
with Firebird. Jaybird provides a connection parameter
<code>use_standard_udf</code> telling the driver to assume that functions from that
UDF are available in the database. In this case Jaybird will convert all
JDBC function calls into the corresponding calls of the UDF functions.</p>
</div>
<div class="paragraph">
<p>Below you will find the list of JDBC functions and whether they have a
corresponding equivalent in the "built-in" and in the "UDF" modes.</p>
</div>
<div class="sect2">
<h3 id="_numeric_functions"><a class="anchor" href="#_numeric_functions"></a>F.1. Numeric Functions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC</th>
<th class="tableblock halign-left valign-top">built-in</th>
<th class="tableblock halign-left valign-top">UDF mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ABS(number)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Absolute value of <code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACOS(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arccosine, in radians, of <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASIN(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arcsine, in radians, of <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ATAN(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arctangent, in radians, of <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ATAN2(float1, float2)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arctangent, in radians, of <code>float2</code> /
<code>float1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CEILING(number)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smallest integer &gt;= <code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COS(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cosine of <code>float</code> radians</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COT(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cotangent of <code>float</code> radians</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEGREES(number)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Degrees in <code>number</code> radians</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXP(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exponential function of <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOOR(number)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Largest integer &#8656; <code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base e logarithm of <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG10(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base 10 logarithm of <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MOD(integer1, integer2)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remainder for <code>integer1</code> / <code>integer2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PI()</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The constant pi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POWER(number, power)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code> raised to (integer) <code>power</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RADIANS(number)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Radians in <code>number</code> degrees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RAND(integer)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RAND()</code>&#8288;<sup class="footnote">[<a id="_footnoteref_24" class="footnote" href="#_footnotedef_24" title="View footnote.">24</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random floating point for seed <code>integer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ROUND(number, places)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code> rounded to <code>places</code> places</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SIGN(number)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1 to indicate <code>number</code> is &lt; 0; 0 to indicate
<code>number</code> is = 0; 1 to indicate <code>number</code> is &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SIN(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sine of <code>float</code> radians</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQRT(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Square root of float</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TAN(float)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tangent of <code>float</code> radians</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRUNCATE(number, places)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code> truncated to <code>places</code> places</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend: X – available in this mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_string_functions"><a class="anchor" href="#_string_functions"></a>F.2. String Functions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC</th>
<th class="tableblock halign-left valign-top">built-in</th>
<th class="tableblock halign-left valign-top">UDF mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASCII(string)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer representing the ASCII code value of the
leftmost character in <code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHAR(code)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character with ASCII code value <code>code</code>, where <code>code</code>
is between 0 and 255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONCAT(string1, string2)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character string formed by appending
<code>string2</code> to <code>string1</code>; if a string is null, the result is
DBMS-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DIFFERENCE(string1, string2)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer indicating the difference
between the values returned by the function <code>SOUNDEX</code> for <code>string1</code> and
<code>string2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INSERT(string1, start, length, string2)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string
formed by deleting <code>length</code> characters from <code>string1</code> beginning at
<code>start</code>, and inserting <code>string2</code> into <code>string1</code> at <code>start</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LCASE(string)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts all uppercase characters in <code>string</code> to
lowercase</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LEFT(string, count)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>count</code> leftmost characters from
<code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LENGTH(string)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X<sup class="footnote">[<a id="_footnoteref_25" class="footnote" href="#_footnotedef_25" title="View footnote.">25</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of characters in <code>string</code>, excluding trailing blanks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCATE(string1, string2[, start])</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Position in <code>string2</code> of the
first occurrence of <code>string1</code>, searching from the beginning of
<code>string2</code>; if <code>start</code> is specified, the search begins from position
<code>start</code>. 0 is returned if <code>string2</code> does not contain <code>string1</code>. Position
1 is the first character in <code>string2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LTRIM(string)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Characters of <code>string</code> with leading blank spaces
removed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPEAT(string, count)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string formed by repeating
<code>string</code> <code>count</code> times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLACE(string1, string2, string3)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaces all occurrences of
<code>string2</code> in <code>string1</code> with <code>string3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RIGHT(string, count)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>count</code> rightmost characters in
<code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RTRIM(string)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The characters of <code>string</code> with no trailing
blanks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SOUNDEX(string)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string, which is data
source-dependent, representing the sound of the words in <code>string</code>; this
could be a four-digit SOUNDEX code, a phonetic representation of each
word, etc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SPACE(count)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string consisting of <code>count</code> spaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUBSTRING(string, start, length)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string formed by
extracting <code>length</code> characters from <code>string</code> beginning at <code>start</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UCASE(string)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts all lowercase characters in <code>string</code> to
uppercase.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend: X – available in this mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_time_and_date_functions"><a class="anchor" href="#_time_and_date_functions"></a>F.3. Time and Date Functions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC</th>
<th class="tableblock halign-left valign-top">built-in</th>
<th class="tableblock halign-left valign-top">UDF mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CURDATE()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current date as a date value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CURTIME()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current local time as a time value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYNAME(date)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string representing the day component
of <code>date</code>; the name for the day is specific to the data source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYOFMONTH(date)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 1 to 31 representing the day
of the month in <code>date</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYOFWEEK(date)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 1 to 7 representing the day of
the week in <code>date</code>; 1 represents Sunday</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYOFYEAR(date)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 1 to 366 representing the day of
the year in <code>date</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HOUR(time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 0 to 23 representing the hour
component of <code>time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MINUTE(time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 0 to 59 representing the minute
component of <code>time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MONTH(date)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 1 to 12 representing the month
component of <code>date</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MONTHNAME(date)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character string representing the month
component of <code>date</code>; the name for the month is specific to the data
source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NOW()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A timestamp value representing the current date and time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARTER(date)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 1 to 4 representing the quarter in
<code>date</code>; 1 represents January 1 through March 31</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SECOND(time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 0 to 59 representing the second
component of <code>time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMESTAMPADD( interval, count, timestamp)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A timestamp calculated
by adding <code>count</code> number of <code>interval</code>(s) to <code>timestamp</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMESTAMPDIFF( interval, timestamp1, timestamp2)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer
representing the number of <code>interval</code> by which <code>timestamp2</code> is greater
than <code>timestamp1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WEEK(date)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer from 1 to 53 representing the week of
the year in <code>date</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>YEAR(date)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer representing the year component of
<code>date</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend: X – available in this mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_functions"><a class="anchor" href="#_system_functions"></a>F.4. System Functions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC</th>
<th class="tableblock halign-left valign-top">built-in</th>
<th class="tableblock halign-left valign-top">UDF mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATABASE()</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IFNULL(expression, value)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value</code> if <code>expression</code> is null;
<code>expression</code> if <code>expression</code> is not null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>USER()</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User name in the DBMS</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend: X – available in this mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conversion_functions"><a class="anchor" href="#_conversion_functions"></a>F.5. Conversion Functions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JDBC</th>
<th class="tableblock halign-left valign-top">built-in</th>
<th class="tableblock halign-left valign-top">UDF mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONVERT(value, SQL type)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>value</code> converted to <code>SQL type</code> where <code>SQL type</code> may be one of the
following SQL types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BIGINT</code></p>
</li>
<li>
<p><code>CHAR</code></p>
</li>
<li>
<p><code>DATE</code></p>
</li>
<li>
<p><code>DECIMAL</code></p>
</li>
<li>
<p><code>OUBLE PRECISION</code></p>
</li>
<li>
<p><code>FLOAT</code></p>
</li>
<li>
<p><code>INTEGER</code></p>
</li>
<li>
<p><code>REAL</code></p>
</li>
<li>
<p><code>SMALLINT</code></p>
</li>
<li>
<p><code>TIME</code></p>
</li>
<li>
<p><code>TIMESTAMP</code></p>
</li>
<li>
<p><code>VARCHAR</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend: X – available in this mode.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jaybirdversions"><a class="anchor" href="#jaybirdversions"></a>Appendix G: Jaybird versions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix lists the distribution files and supported specifications of recent Jaybird versions.</p>
</div>
<div class="sect2">
<h3 id="jb3"><a class="anchor" href="#jb3"></a>G.1. Jaybird 3</h3>
<div class="sect3">
<h4 id="jb3-java"><a class="anchor" href="#jb3-java"></a>G.1.1. Java support</h4>
<div class="paragraph">
<p>Jaybird 3 supports Java 7 (JDBC 4.1), Java 8 (JDBC 4.2), and Java 9 - 11 (JDBC 4.3).</p>
</div>
<div class="paragraph">
<p>There are no Java 9+ specific builds, the Java 8 builds have the same source and all JDBC 4.3 related functionality.</p>
</div>
<div class="paragraph">
<p>Given the limited support period for Java 9 and higher versions, we may limit support on those versions to the most recent LTS version and the latest release.</p>
</div>
<div class="paragraph">
<p>Jaybird 3.0 is not modularized, but since Jaybird 3.0.3, it declares the automatic module name <code>org.firebirdsql.jaybird</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="jb3-firebird"><a class="anchor" href="#jb3-firebird"></a>G.1.2. Firebird support</h4>
<div class="paragraph">
<p>Jaybird 2.2 supports Firebird 2.0 and higher, but is only tested with Firebird 2.5, 3.0 and 4.0.</p>
</div>
<div class="paragraph">
<p>Formal support for Firebird 1.x has been dropped (although in general we expect the driver to work).
The Type 2 and embedded server JDBC drivers use JNA to access the Firebird client or embedded library.</p>
</div>
<div class="sect4">
<h5 id="jb3-firebird3"><a class="anchor" href="#jb3-firebird3"></a>Notes on Firebird 3 support</h5>
<div class="paragraph">
<p>Jaybird 3.0.4 added support for wire protocol encryption and database encryption.</p>
</div>
<div class="paragraph">
<p>Jaybird 3.0 does not support the Firebird 3 zlib compression.</p>
</div>
</div>
<div class="sect4">
<h5 id="jb3-firebird4"><a class="anchor" href="#jb3-firebird4"></a>Notes on Firebird 4 support</h5>
<div class="paragraph">
<p>Jaybird 3.0 can connect and query Firebird 4.
Longer object names are supported.</p>
</div>
<div class="paragraph">
<p>The new data types introduced in Firebird 4 are not supported.
Support for data types like <code>DECFLOAT</code> and <code>NUMERIC</code>/<code>DECIMAL</code> with precision higher than 18 will be introduced in Jaybird 4.</p>
</div>
<div class="paragraph">
<p>The Srp256 authentication plugin is supported (<em class="since">Jaybird 3.0.5</em>), but the other SrpNNN plugins are not.</p>
</div>
<div class="paragraph">
<p>Jaybird 3 does not support the Firebird 4 zlib compression.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="jb3-spec"><a class="anchor" href="#jb3-spec"></a>G.1.3. Supported Specifications</h4>
<div class="paragraph">
<p>Jaybird supports the following specifications:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Specification</th>
<th class="tableblock halign-left valign-top">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC 4.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird supports most of JDBC 4.3, inasfar the features are required or supported by Firebird.
It is not officially JDBC compliant, because we currently don&#8217;t have access to the TCK.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JCA 1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird provides an implementation of <code>javax.resource.spi.ManagedConnectionFactory</code> and related
interfaces. CCI interfaces are not supported.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JTA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The driver provides an implementation of the <code>javax.transaction.xa.XAResource</code> interface via the JCA
framework and a <code>javax.sql.XADataSource</code> implementation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="jb3-distribution"><a class="anchor" href="#jb3-distribution"></a>G.1.4. Distribution</h4>
<div class="paragraph">
<p>The Jaybird driver has compile-time and run-time dependencies to JCA 1.5.
Additionally, if the antlr-runtime classes are found in the class path, it is possible to use generated key retrieval.</p>
</div>
<div class="sect4">
<h5 id="jb3-distribution-package"><a class="anchor" href="#jb3-distribution-package"></a>Distribution package</h5>
<div class="paragraph">
<p>The latest version of Jaybird can be downloaded from <a href="https://firebirdsql.org/en/jdbc-driver/" class="bare">https://firebirdsql.org/en/jdbc-driver/</a></p>
</div>
<div class="paragraph">
<p>The following files can be found in the distribution package:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">File name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaybird-3.0.5.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An archive containing the JDBC driver, the JCA connection manager, the Services API and event
management classes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaybird-full-3.0.5.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same as above, but including the JCA 1.5 dependency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/antlr-runtime-4.7.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional dependency, required if you want to use <code>getGeneratedKeys</code> support</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/connector-api-1.5.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required dependency; part of <code>jaybird-full</code>, not necessary when deploying to a Java EE application server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/jna-4.4.0.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional dependency, required if you want to use Type 2 native, local or embedded protocols</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="jb3-distribution-maven"><a class="anchor" href="#jb3-distribution-maven"></a>Maven</h5>
<div class="paragraph">
<p>Alternatively, you can use maven to automatically download Jaybird and its
dependencies.</p>
</div>
<div class="paragraph">
<p>Jaybird 3 is available from Maven central:</p>
</div>
<div class="paragraph">
<p>Groupid: <code>org.firebirdsql.jdbc</code>,<br>
Artifactid: <code>jaybird-jdkXX</code> (where <code>XX</code> is <code>17</code> or <code>18</code>).<br>
Version: <code>3.0.5</code></p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.firebirdsql.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;jaybird-jdk18&lt;/artifactId&gt;
  &lt;version&gt;3.0.5&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Maven definition of Jaybird depends on antlr-runtime by default.</p>
</div>
<div class="paragraph">
<p>If your application is deployed to a Java EE application server, you will need to
exclude the <code>javax.resource:connector-api</code> dependency, and add it as a provided
dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.firebirdsql.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;jaybird-jdk18&lt;/artifactId&gt;
  &lt;version&gt;3.0.5&lt;/version&gt;
  &lt;exclusions&gt;
    &lt;exclusion&gt;
      &lt;groupId&gt;javax.resource&lt;/groupId&gt;
      &lt;artifactId&gt;connector-api&lt;/artifactId&gt;
    &lt;/exclusion&gt;
  &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.resource&lt;/groupId&gt;
  &lt;artifactId&gt;connector-api&lt;/artifactId&gt;
  &lt;version&gt;1.5&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use Type 2 support (native, local or embedded), you need to
explicitly include JNA as a dependency, where the version (4.4.0) is already specified by
the Jaybird dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;net.java.dev.jna&lt;/groupId&gt;
  &lt;artifactId&gt;jna&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jb22"><a class="anchor" href="#jb22"></a>G.2. Jaybird 2.2</h3>
<div class="sect3">
<h4 id="jb22-java"><a class="anchor" href="#jb22-java"></a>G.2.1. Java support</h4>
<div class="paragraph">
<p>Jaybird 2.2 supports Java 6 (JDBC 4.0), Java 7 (JDBC 4.1) and Java 8 (JDBC 4.2).
Java 5 support was dropped in Jaybird 2.2.8.</p>
</div>
<div class="paragraph">
<p>For compatibility with Java 9 modules, version 2.2.14 introduced the automatic module name <code>org.firebirdsql.jaybird</code>.
This guarantees a stable module name for Jaybird, and allows for future modularization of Jaybird.</p>
</div>
</div>
<div class="sect3">
<h4 id="jb22-firebird"><a class="anchor" href="#jb22-firebird"></a>G.2.2. Firebird support</h4>
<div class="paragraph">
<p>Jaybird 2.2 supports Firebird 1.0 and higher, but is only tested with Firebird 2.5 and 3.0.</p>
</div>
<div class="paragraph">
<p>Connecting to Firebird 3 requires some additional configuration, see <a href="https://github.com/FirebirdSQL/jaybird/wiki/Jaybird-and-Firebird-3" target="_blank" rel="noopener">Jaybird and Firebird 3.0</a> for details.</p>
</div>
<div class="paragraph">
<p>Firebird 4 is not formally supported in Jaybird 2.2.x, although connecting and most functionality will work.
We suggest that you use Jaybird 3.x or higher for Firebird 4.
Support for newer data types like <code>DECFLOAT</code> and <code>NUMERIC</code>/<code>DECIMAL</code> with precision higher than 18 will be introduced in Jaybird 4.</p>
</div>
<div class="paragraph">
<p>The Type 2 and embedded server JDBC drivers require the appropriate JNI library.
Precompiled JNI binaries for Windows and Linux platforms are shipped in the default installation, other platforms require porting/building the JNI library for that platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="jb22-spec"><a class="anchor" href="#jb22-spec"></a>G.2.3. Supported Specifications</h4>
<div class="paragraph">
<p>Jaybird 2.2 supports the following specifications:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Specification</th>
<th class="tableblock halign-left valign-top">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC 4.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Driver does not fully support JDBC 4.2 features, but implements large update count methods by calling the normal update count methods, and methods with <code>SQLType</code> by calling methods accepting the <code>java.sql.Types</code> integer value. Supports new <code>java.time</code> classes with some caveats.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC 4.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Driver implements all JDBC 4.1 methods added to existing interfaces.
The driver explicitly supports <code>closeOnCompletion</code>, most other methods introduced with JDBC 4.1 throw <code>SQLFeatureNotSupportedException</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC 4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Driver implements all JDBC 4.0 interfaces and supports exception chaining.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JCA 1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jaybird provides an implementation of <code>javax.resource.spi.ManagedConnectionFactory</code> and related interfaces.
CCI interfaces are not supported.
Although Jaybird 2.2 depends on the JCA 1.5 classes, JCA 1.5 compatibility is currently not guaranteed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JTA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The driver provides an implementation of the <code>javax.transaction.xa.XAResource</code> interface via the JCA
framework and a <code>javax.sql.XADataSource</code> implementation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="jb22-distribution"><a class="anchor" href="#jb22-distribution"></a>G.2.4. Distribution</h4>
<div class="paragraph">
<p>The Jaybird driver has compile-time and run-time dependencies to JCA 1.5.
Additionally, if the antlr-runtime classes are found in the class path, it is possible to use generated key retrieval.</p>
</div>
<div class="sect4">
<h5 id="jb22-distribution-package"><a class="anchor" href="#jb22-distribution-package"></a>Distribution package</h5>
<div class="paragraph">
<p>The latest version of Jaybird can be downloaded from <a href="https://firebirdsql.org/en/jdbc-driver/" class="bare">https://firebirdsql.org/en/jdbc-driver/</a></p>
</div>
<div class="paragraph">
<p>The following files can be found in the distribution package:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">File name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaybird-2.2.15.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An archive containing the JDBC driver, the JCA connection manager, the Services API and event
management classes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaybird-full-2.2.15.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same as above, but including the JCA 1.5 dependency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/antlr-runtime-3.4.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional dependency, required if you want to use <code>getGeneratedKeys</code> support</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/connector-api-1.5.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required dependency; part of <code>jaybird-full</code>, not necessary when deploying to a Java EE application server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/log4j-core.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional dependency, core Log4J classes that provide logging.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Jaybird 2.2 has compile-time and run-time dependencies on the JCA 1.5 classes.
Additionally, if Log4J classes are found in the class path, it is possible to enable extensive logging inside the driver.
If the ANTLR runtime classes are absent, the generated keys functionality will not be available.</p>
</div>
<div class="paragraph">
<p>Native dependencies (required only for Type 2 and Embedded):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jaybird22.dll</code> – Windows 32-bit</p>
</li>
<li>
<p><code>jaybird22_x64.dll</code> – Windows 64-bit</p>
</li>
<li>
<p><code>libjaybird22.so</code> – Linux 32-bit (x86)</p>
</li>
<li>
<p><code>libjaybird22_x64.so</code> – Linux 64-bit (AMD/Intel 64)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Windows DLLs have been built with Microsoft Visual Studio 2010 SP1.
To use the native or embedded driver, you will need to install the Microsoft Visual C++ 2010 SP 1 redistributable available at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>x86: http://www.microsoft.com/download/en/details.aspx?id=8328
x64: http://www.microsoft.com/download/en/details.aspx?id=13523</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jb22-distribution-maven"><a class="anchor" href="#jb22-distribution-maven"></a>Maven</h5>
<div class="paragraph">
<p>Alternatively, you can use maven to automatically download Jaybird and its dependencies.</p>
</div>
<div class="paragraph">
<p>Jaybird 2.2 is available from Maven central:</p>
</div>
<div class="paragraph">
<p>Groupid: <code>org.firebirdsql.jdbc</code>,<br>
Artifactid: <code>jaybird-jdkXX</code> (where <code>XX</code> is <code>16</code>, <code>17</code> or <code>18</code>).<br>
Version: <code>2.2.15</code></p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.firebirdsql.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;jaybird-jdk18&lt;/artifactId&gt;
  &lt;version&gt;2.2.15&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Maven definition of Jaybird depends on antlr-runtime by default.</p>
</div>
<div class="paragraph">
<p>If your application is deployed to a Java EE application server, you will need to
exclude the <code>javax.resource:connector-api</code> dependency, and add it as a provided
dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.firebirdsql.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;jaybird-jdk18&lt;/artifactId&gt;
  &lt;version&gt;2.2.15&lt;/version&gt;
  &lt;exclusions&gt;
    &lt;exclusion&gt;
      &lt;groupId&gt;javax.resource&lt;/groupId&gt;
      &lt;artifactId&gt;connector-api&lt;/artifactId&gt;
    &lt;/exclusion&gt;
  &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.resource&lt;/groupId&gt;
  &lt;artifactId&gt;connector-api&lt;/artifactId&gt;
  &lt;version&gt;1.5&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license"><a class="anchor" href="#license"></a>Appendix H: License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The contents of this Documentation are subject to the Public
Documentation License Version 1.0 (the "License"); you may only use this
Documentation if you comply with the terms of this License. A copy of
the License is available at
<a href="http://www.firebirdsql.org/manual/licenses-pdl-text.html" class="bare">http://www.firebirdsql.org/manual/licenses-pdl-text.html</a>.</p>
</div>
<div class="paragraph">
<p>The Original Documentation is Jaybird 2.1 JDBC driver Java Programmer&#8217;s
Manual. The Initial Writer of the Original Documentation is Roman
Rokytskyy Copyright &#169; 2004-2008. All Rights Reserved. (Initial Writer
contact(s): <a href="mailto:roman@rokytskyy.de">roman@rokytskyy.de</a>).</p>
</div>
<div class="paragraph">
<p>Contributor(s): Mark Rotteveel.</p>
</div>
<div class="paragraph">
<p>Portions created by Mark Rotteveel are Copyright &#169; 2014-2019. All
Rights Reserved. (Contributor contact(s):
<a href="mailto:mrotteveel@users.sourceforge.net">mrotteveel@users.sourceforge.net</a>).</p>
</div>
<div class="paragraph">
<p>Portions created by &#8230;&#8203;.. are Copyright &#169;&#8230;&#8203;..[Insert year(s)].
All Rights Reserved. (Contributor contact(s):&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;[Insert
hyperlink/alias]).</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. For those interested in software archaeology, you can find the open sourced Interclient sources archived on <a href="https://github.com/FirebirdSQL/x-cvs-interclient" class="bare">https://github.com/FirebirdSQL/x-cvs-interclient</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. it is possible sometimes X/Open SQLstates are used
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. excluding those defined for <code>javax.sql.rowset</code>
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. DDL – Data Definition Language. This term is used to group all statements that are used to manipulate database schema, i.e. creation of tables, indices, views, etc.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. escape syntax in limited form also works for <code>Statement</code> and <code>PreparedStatement</code>
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. Support is expected in Firebird 4 for prepared statements, Jaybird will add support in a future version
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. Additionally, before the InterBase was open-sourced, this allowed application developers to create multi-threaded application without need to purchase additional user licenses.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. Other cases, e.g. closing the statement object or the connection object will still ensure that the result set object is closed. If you need result sets that can be "detached" from the statement object that created them, please check the <code>javax.sql.RowSet</code> implementations.
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. This approach follows the two-phase locking protocol, where all locks are acquired on the beginning of the transaction and are released only when transaction is finished.
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. The output of the service is always transferred over the network regardless whether the logger property is set or not. Additionally to providing a possibility to the user to track the service progress it acts also as a signal of operation completion – in this case the Java code will receive an EOF marker.
</div>
<div class="footnote" id="_footnotedef_11">
<a href="#_footnoteref_11">11</a>. Cooperative garbage collection can be switched off in Firebird 2.0 SuperServer architecture by corresponding configuration option. It can&#8217;t be switched off in ClassicServer architecture and in previous Firebird versions.
</div>
<div class="footnote" id="_footnotedef_12">
<a href="#_footnoteref_12">12</a>. All versions of Firebird upto 2.5 allow to define validity constraints despite the table(s) contain data that do not satisfy them. Only the new records will be validated, and it is responsibility of the database administrator to ensure the validity of existing ones.
</div>
<div class="footnote" id="_footnotedef_13">
<a href="#_footnoteref_13">13</a>. The class implementation is a simple bean publishing the properties via getters and setters. You can replace it with any other implementation of the <code>User</code> interface.
</div>
<div class="footnote" id="_footnotedef_14">
<a href="#_footnoteref_14">14</a>. Until Firebird 2.0 adding a foreign key constraint required exclusive access to the database.
</div>
<div class="footnote" id="_footnotedef_15">
<a href="#_footnoteref_15">15</a>. Currently possible only on Unix platforms by using NFS shares.
</div>
<div class="footnote" id="_footnotedef_16">
<a href="#_footnoteref_16">16</a>. Another reason for limbo transactions are multidatabase transactions which can be initiated via native Firebird API. However, since Jaybird does not provide methods to initiate them, we do not consider them in this manual.
</div>
<div class="footnote" id="_footnotedef_17">
<a href="#_footnoteref_17">17</a>. For more information please read article by Ann Harrison "Firebird for the Database Expert: Episode 4 - OAT, OIT, &amp; Sweep", available, for example, at <a href="http://www.ibphoenix.com/resources/documents/design/doc_21" class="bare">http://www.ibphoenix.com/resources/documents/design/doc_21</a>
</div>
<div class="footnote" id="_footnotedef_18">
<a href="#_footnoteref_18">18</a>. For example, the effective size for 100 applications subscribed for 100 different events is about 40k in memory.
</div>
<div class="footnote" id="_footnotedef_19">
<a href="#_footnoteref_19">19</a>. On Windows this library is represented by <code>fbintl.dll</code>, on Linux – <code>libfbintl.so</code>.
</div>
<div class="footnote" id="_footnotedef_20">
<a href="#_footnoteref_20">20</a>. The default character set simplifies the explanation, since we do not have to consider the cases when different columns with different character sets are used within the same connection. The statements made here, obviously, can be applied to those cases as well.
</div>
<div class="footnote" id="_footnotedef_21">
<a href="#_footnoteref_21">21</a>. Jaybird provided character set conversion from the very beginning, however Jaybird versions prior to 2.1.0 know nothing about improved Unicode support in Firebird 2.0 because Jaybird 2.0.0 was released almost a year before Firebird 2.0 was released.
</div>
<div class="footnote" id="_footnotedef_22">
<a href="#_footnoteref_22">22</a>. See <a href="https://github.com/FirebirdSQL/jaybird/wiki" class="bare">https://github.com/FirebirdSQL/jaybird/wiki</a> for configuration examples of the most popular application servers.
</div>
<div class="footnote" id="_footnotedef_23">
<a href="#_footnoteref_23">23</a>. On Windows platform it is represented by the <code>ib_udf.dll</code>, on Linux it is represented by the <code>libib_udf.so</code>.
</div>
<div class="footnote" id="_footnotedef_24">
<a href="#_footnoteref_24">24</a>. Standard UDF library provides <code>RAND()</code> function taking no parameters. The random number generator is seeded by the current time. There is no function where the seed can be specified.
</div>
<div class="footnote" id="_footnotedef_25">
<a href="#_footnoteref_25">25</a>. The trailing blanks are also counted.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-05-03 12:22:00 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>
plugins {
    id 'org.asciidoctor.jvm.convert' version '2.3.0'
    id 'org.asciidoctor.jvm.pdf' version '2.3.0'
}

defaultTasks 'clean', 'asciidoctor'

repositories {
    jcenter()
}

asciidoctorj {
    modules {
        pdf {
            version '1.5.0-beta.4'
        }
    }
}

asciidoctor {
    baseDirFollowsSourceDir()
    sources {
        include 'jaybird_manual.adoc'
    }
    attributes 'revnumber': null
}

pdfThemes {
    local 'jaybird', {
        styleDir = file('src/docs/theme/jaybird-pdf')
        styleName = 'jaybird'
    }
}

asciidoctorPdf {
    baseDirFollowsSourceDir()
    sources {
        include 'jaybird_manual.adoc'
    }
    attributes 'revnumber': null, 'source-highlighter': 'rouge', 'media': 'prepress'
    theme 'jaybird'
}

// Create the HTML and PDF output and copy them to the build/pages folder
// Primarily intended for the travis-ci build to deploy to GitHub pages
task makePages {
    dependsOn asciidoctor, asciidoctorPdf
    doLast {
        copy {
            from asciidoctor.outputs
            into "$buildDir/pages"
        }
        copy {
            from asciidoctorPdf.outputs
            into "$buildDir/pages"
        }
    }
}
